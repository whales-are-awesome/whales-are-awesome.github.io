import{i as C1,b as R1,a as N1,c as $1,d as L1,e as D1,f as F1,g as U1,h as j1,j as M1,t as Ti,k as q1,l as ue,m as z1,w as qf,r as jo,s as zf,n as kf,o as Bf,p as Hf,q as Vc,x as Vf,H as k1,u as Kf,v as B1,R as H1,_ as V1,y as Lc,U as K1}from"./index-cf062a2d.js";function Kc(n){return globalThis.Buffer!=null?new Uint8Array(n.buffer,n.byteOffset,n.byteLength):n}function Wf(n=0){return globalThis.Buffer!=null&&globalThis.Buffer.allocUnsafe!=null?Kc(globalThis.Buffer.allocUnsafe(n)):new Uint8Array(n)}function Dc(n,t){t||(t=n.reduce((a,u)=>a+u.length,0));const r=Wf(t);let s=0;for(const a of n)r.set(a,s),s+=a.length;return Kc(r)}const hl={...C1,...R1,...N1,...$1,...L1,...D1,...F1,...U1,...j1,...M1};function Gf(n,t,r,s){return{name:n,prefix:t,encoder:{name:n,prefix:t,encode:r},decoder:{decode:s}}}const ll=Gf("utf8","u",n=>"u"+new TextDecoder("utf8").decode(n),n=>new TextEncoder().encode(n.substring(1))),yc=Gf("ascii","a",n=>{let t="a";for(let r=0;r<n.length;r++)t+=String.fromCharCode(n[r]);return t},n=>{n=n.substring(1);const t=Wf(n.length);for(let r=0;r<n.length;r++)t[r]=n.charCodeAt(r);return t}),Jf={utf8:ll,"utf-8":ll,hex:hl.base16,latin1:yc,ascii:yc,binary:yc,...hl};function mr(n,t="utf8"){const r=Jf[t];if(!r)throw new Error(`Unsupported encoding "${t}"`);return(t==="utf8"||t==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?Kc(globalThis.Buffer.from(n,"utf-8")):r.decoder.decode(`${r.prefix}${n}`)}function cr(n,t="utf8"){const r=Jf[t];if(!r)throw new Error(`Unsupported encoding "${t}"`);return(t==="utf8"||t==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?globalThis.Buffer.from(n.buffer,n.byteOffset,n.byteLength).toString("utf8"):r.encoder.encode(n).substring(1)}const W1={waku:{publish:"waku_publish",batchPublish:"waku_batchPublish",subscribe:"waku_subscribe",batchSubscribe:"waku_batchSubscribe",subscription:"waku_subscription",unsubscribe:"waku_unsubscribe",batchUnsubscribe:"waku_batchUnsubscribe"},irn:{publish:"irn_publish",batchPublish:"irn_batchPublish",subscribe:"irn_subscribe",batchSubscribe:"irn_batchSubscribe",subscription:"irn_subscription",unsubscribe:"irn_unsubscribe",batchUnsubscribe:"irn_batchUnsubscribe"},iridium:{publish:"iridium_publish",batchPublish:"iridium_batchPublish",subscribe:"iridium_subscribe",batchSubscribe:"iridium_batchSubscribe",subscription:"iridium_subscription",unsubscribe:"iridium_unsubscribe",batchUnsubscribe:"iridium_batchUnsubscribe"}};var Vt={},G1={get exports(){return Vt},set exports(n){Vt=n}},In=typeof Reflect=="object"?Reflect:null,fl=In&&typeof In.apply=="function"?In.apply:function(t,r,s){return Function.prototype.apply.call(t,r,s)},Po;In&&typeof In.ownKeys=="function"?Po=In.ownKeys:Object.getOwnPropertySymbols?Po=function(t){return Object.getOwnPropertyNames(t).concat(Object.getOwnPropertySymbols(t))}:Po=function(t){return Object.getOwnPropertyNames(t)};function J1(n){console&&console.warn&&console.warn(n)}var Qf=Number.isNaN||function(t){return t!==t};function Be(){Be.init.call(this)}G1.exports=Be;Vt.once=Z1;Be.EventEmitter=Be;Be.prototype._events=void 0;Be.prototype._eventsCount=0;Be.prototype._maxListeners=void 0;var dl=10;function Mo(n){if(typeof n!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof n)}Object.defineProperty(Be,"defaultMaxListeners",{enumerable:!0,get:function(){return dl},set:function(n){if(typeof n!="number"||n<0||Qf(n))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+n+".");dl=n}});Be.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0};Be.prototype.setMaxListeners=function(t){if(typeof t!="number"||t<0||Qf(t))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+t+".");return this._maxListeners=t,this};function Yf(n){return n._maxListeners===void 0?Be.defaultMaxListeners:n._maxListeners}Be.prototype.getMaxListeners=function(){return Yf(this)};Be.prototype.emit=function(t){for(var r=[],s=1;s<arguments.length;s++)r.push(arguments[s]);var a=t==="error",u=this._events;if(u!==void 0)a=a&&u.error===void 0;else if(!a)return!1;if(a){var f;if(r.length>0&&(f=r[0]),f instanceof Error)throw f;var g=new Error("Unhandled error."+(f?" ("+f.message+")":""));throw g.context=f,g}var _=u[t];if(_===void 0)return!1;if(typeof _=="function")fl(_,this,r);else for(var T=_.length,C=rd(_,T),s=0;s<T;++s)fl(C[s],this,r);return!0};function Xf(n,t,r,s){var a,u,f;if(Mo(r),u=n._events,u===void 0?(u=n._events=Object.create(null),n._eventsCount=0):(u.newListener!==void 0&&(n.emit("newListener",t,r.listener?r.listener:r),u=n._events),f=u[t]),f===void 0)f=u[t]=r,++n._eventsCount;else if(typeof f=="function"?f=u[t]=s?[r,f]:[f,r]:s?f.unshift(r):f.push(r),a=Yf(n),a>0&&f.length>a&&!f.warned){f.warned=!0;var g=new Error("Possible EventEmitter memory leak detected. "+f.length+" "+String(t)+" listeners added. Use emitter.setMaxListeners() to increase limit");g.name="MaxListenersExceededWarning",g.emitter=n,g.type=t,g.count=f.length,J1(g)}return n}Be.prototype.addListener=function(t,r){return Xf(this,t,r,!1)};Be.prototype.on=Be.prototype.addListener;Be.prototype.prependListener=function(t,r){return Xf(this,t,r,!0)};function Q1(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function Zf(n,t,r){var s={fired:!1,wrapFn:void 0,target:n,type:t,listener:r},a=Q1.bind(s);return a.listener=r,s.wrapFn=a,a}Be.prototype.once=function(t,r){return Mo(r),this.on(t,Zf(this,t,r)),this};Be.prototype.prependOnceListener=function(t,r){return Mo(r),this.prependListener(t,Zf(this,t,r)),this};Be.prototype.removeListener=function(t,r){var s,a,u,f,g;if(Mo(r),a=this._events,a===void 0)return this;if(s=a[t],s===void 0)return this;if(s===r||s.listener===r)--this._eventsCount===0?this._events=Object.create(null):(delete a[t],a.removeListener&&this.emit("removeListener",t,s.listener||r));else if(typeof s!="function"){for(u=-1,f=s.length-1;f>=0;f--)if(s[f]===r||s[f].listener===r){g=s[f].listener,u=f;break}if(u<0)return this;u===0?s.shift():Y1(s,u),s.length===1&&(a[t]=s[0]),a.removeListener!==void 0&&this.emit("removeListener",t,g||r)}return this};Be.prototype.off=Be.prototype.removeListener;Be.prototype.removeAllListeners=function(t){var r,s,a;if(s=this._events,s===void 0)return this;if(s.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):s[t]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete s[t]),this;if(arguments.length===0){var u=Object.keys(s),f;for(a=0;a<u.length;++a)f=u[a],f!=="removeListener"&&this.removeAllListeners(f);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(r=s[t],typeof r=="function")this.removeListener(t,r);else if(r!==void 0)for(a=r.length-1;a>=0;a--)this.removeListener(t,r[a]);return this};function ed(n,t,r){var s=n._events;if(s===void 0)return[];var a=s[t];return a===void 0?[]:typeof a=="function"?r?[a.listener||a]:[a]:r?X1(a):rd(a,a.length)}Be.prototype.listeners=function(t){return ed(this,t,!0)};Be.prototype.rawListeners=function(t){return ed(this,t,!1)};Be.listenerCount=function(n,t){return typeof n.listenerCount=="function"?n.listenerCount(t):td.call(n,t)};Be.prototype.listenerCount=td;function td(n){var t=this._events;if(t!==void 0){var r=t[n];if(typeof r=="function")return 1;if(r!==void 0)return r.length}return 0}Be.prototype.eventNames=function(){return this._eventsCount>0?Po(this._events):[]};function rd(n,t){for(var r=new Array(t),s=0;s<t;++s)r[s]=n[s];return r}function Y1(n,t){for(;t+1<n.length;t++)n[t]=n[t+1];n.pop()}function X1(n){for(var t=new Array(n.length),r=0;r<t.length;++r)t[r]=n[r].listener||n[r];return t}function Z1(n,t){return new Promise(function(r,s){function a(f){n.removeListener(t,u),s(f)}function u(){typeof n.removeListener=="function"&&n.removeListener("error",a),r([].slice.call(arguments))}id(n,t,u,{once:!0}),t!=="error"&&eb(n,a,{once:!0})})}function eb(n,t,r){typeof n.on=="function"&&id(n,"error",t,r)}function id(n,t,r,s){if(typeof n.on=="function")s.once?n.once(t,r):n.on(t,r);else if(typeof n.addEventListener=="function")n.addEventListener(t,function a(u){s.once&&n.removeEventListener(t,a),r(u)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof n)}var qo={},fs={};Object.defineProperty(fs,"__esModule",{value:!0});function tb(n){if(typeof n!="string")throw new Error(`Cannot safe json parse value of type ${typeof n}`);try{return JSON.parse(n)}catch{return n}}fs.safeJsonParse=tb;function rb(n){return typeof n=="string"?n:JSON.stringify(n,(t,r)=>typeof r>"u"?null:r)}fs.safeJsonStringify=rb;var Ro={},mc={get exports(){return Ro},set exports(n){Ro=n}},pl;function ib(){return pl||(pl=1,function(){let n;function t(){}n=t,n.prototype.getItem=function(r){return this.hasOwnProperty(r)?String(this[r]):null},n.prototype.setItem=function(r,s){this[r]=String(s)},n.prototype.removeItem=function(r){delete this[r]},n.prototype.clear=function(){const r=this;Object.keys(r).forEach(function(s){r[s]=void 0,delete r[s]})},n.prototype.key=function(r){return r=r||0,Object.keys(this)[r]},n.prototype.__defineGetter__("length",function(){return Object.keys(this).length}),typeof globalThis<"u"&&globalThis.localStorage?mc.exports=globalThis.localStorage:typeof window<"u"&&window.localStorage?mc.exports=window.localStorage:mc.exports=new t}()),Ro}var vc={},Qn={},gl;function nb(){if(gl)return Qn;gl=1,Object.defineProperty(Qn,"__esModule",{value:!0}),Qn.IKeyValueStorage=void 0;class n{}return Qn.IKeyValueStorage=n,Qn}var Yn={},yl;function sb(){if(yl)return Yn;yl=1,Object.defineProperty(Yn,"__esModule",{value:!0}),Yn.parseEntry=void 0;const n=fs;function t(r){var s;return[r[0],n.safeJsonParse((s=r[1])!==null&&s!==void 0?s:"")]}return Yn.parseEntry=t,Yn}var ml;function ob(){return ml||(ml=1,function(n){Object.defineProperty(n,"__esModule",{value:!0});const t=Ti;t.__exportStar(nb(),n),t.__exportStar(sb(),n)}(vc)),vc}Object.defineProperty(qo,"__esModule",{value:!0});qo.KeyValueStorage=void 0;const _n=Ti,vl=fs,ab=_n.__importDefault(ib()),cb=ob();class nd{constructor(){this.localStorage=ab.default}getKeys(){return _n.__awaiter(this,void 0,void 0,function*(){return Object.keys(this.localStorage)})}getEntries(){return _n.__awaiter(this,void 0,void 0,function*(){return Object.entries(this.localStorage).map(cb.parseEntry)})}getItem(t){return _n.__awaiter(this,void 0,void 0,function*(){const r=this.localStorage.getItem(t);if(r!==null)return vl.safeJsonParse(r)})}setItem(t,r){return _n.__awaiter(this,void 0,void 0,function*(){this.localStorage.setItem(t,vl.safeJsonStringify(r))})}removeItem(t){return _n.__awaiter(this,void 0,void 0,function*(){this.localStorage.removeItem(t)})}}qo.KeyValueStorage=nd;var ub=qo.default=nd,On={},Xn={},bc={},Zn={};let Gi=class{};const hb=Object.freeze(Object.defineProperty({__proto__:null,IEvents:Gi},Symbol.toStringTag,{value:"Module"})),lb=q1(hb);var bl;function fb(){if(bl)return Zn;bl=1,Object.defineProperty(Zn,"__esModule",{value:!0}),Zn.IHeartBeat=void 0;const n=lb;class t extends n.IEvents{constructor(s){super()}}return Zn.IHeartBeat=t,Zn}var wl;function sd(){return wl||(wl=1,function(n){Object.defineProperty(n,"__esModule",{value:!0}),Ti.__exportStar(fb(),n)}(bc)),bc}var wc={},Vi={},_l;function db(){if(_l)return Vi;_l=1,Object.defineProperty(Vi,"__esModule",{value:!0}),Vi.HEARTBEAT_EVENTS=Vi.HEARTBEAT_INTERVAL=void 0;const n=ue;return Vi.HEARTBEAT_INTERVAL=n.FIVE_SECONDS,Vi.HEARTBEAT_EVENTS={pulse:"heartbeat_pulse"},Vi}var El;function od(){return El||(El=1,function(n){Object.defineProperty(n,"__esModule",{value:!0}),Ti.__exportStar(db(),n)}(wc)),wc}var Il;function pb(){if(Il)return Xn;Il=1,Object.defineProperty(Xn,"__esModule",{value:!0}),Xn.HeartBeat=void 0;const n=Ti,t=Vt,r=ue,s=sd(),a=od();class u extends s.IHeartBeat{constructor(g){super(g),this.events=new t.EventEmitter,this.interval=a.HEARTBEAT_INTERVAL,this.interval=(g==null?void 0:g.interval)||a.HEARTBEAT_INTERVAL}static init(g){return n.__awaiter(this,void 0,void 0,function*(){const _=new u(g);return yield _.init(),_})}init(){return n.__awaiter(this,void 0,void 0,function*(){yield this.initialize()})}stop(){clearInterval(this.intervalRef)}on(g,_){this.events.on(g,_)}once(g,_){this.events.once(g,_)}off(g,_){this.events.off(g,_)}removeListener(g,_){this.events.removeListener(g,_)}initialize(){return n.__awaiter(this,void 0,void 0,function*(){this.intervalRef=setInterval(()=>this.pulse(),r.toMiliseconds(this.interval))})}pulse(){this.events.emit(a.HEARTBEAT_EVENTS.pulse)}}return Xn.HeartBeat=u,Xn}(function(n){Object.defineProperty(n,"__esModule",{value:!0});const t=Ti;t.__exportStar(pb(),n),t.__exportStar(sd(),n),t.__exportStar(od(),n)})(On);var Ne={},_c,Sl;function gb(){if(Sl)return _c;Sl=1;function n(r){try{return JSON.stringify(r)}catch{return'"[Circular]"'}}_c=t;function t(r,s,a){var u=a&&a.stringify||n,f=1;if(typeof r=="object"&&r!==null){var g=s.length+f;if(g===1)return r;var _=new Array(g);_[0]=u(r);for(var T=1;T<g;T++)_[T]=u(s[T]);return _.join(" ")}if(typeof r!="string")return r;var C=s.length;if(C===0)return r;for(var F="",V=1-f,k=-1,W=r&&r.length||0,Y=0;Y<W;){if(r.charCodeAt(Y)===37&&Y+1<W){switch(k=k>-1?k:0,r.charCodeAt(Y+1)){case 100:case 102:if(V>=C||s[V]==null)break;k<Y&&(F+=r.slice(k,Y)),F+=Number(s[V]),k=Y+2,Y++;break;case 105:if(V>=C||s[V]==null)break;k<Y&&(F+=r.slice(k,Y)),F+=Math.floor(Number(s[V])),k=Y+2,Y++;break;case 79:case 111:case 106:if(V>=C||s[V]===void 0)break;k<Y&&(F+=r.slice(k,Y));var X=typeof s[V];if(X==="string"){F+="'"+s[V]+"'",k=Y+2,Y++;break}if(X==="function"){F+=s[V].name||"<anonymous>",k=Y+2,Y++;break}F+=u(s[V]),k=Y+2,Y++;break;case 115:if(V>=C)break;k<Y&&(F+=r.slice(k,Y)),F+=String(s[V]),k=Y+2,Y++;break;case 37:k<Y&&(F+=r.slice(k,Y)),F+="%",k=Y+2,Y++,V--;break}++V}++Y}return k===-1?r:(k<W&&(F+=r.slice(k)),F)}return _c}var Ec,xl;function yb(){if(xl)return Ec;xl=1;const n=gb();Ec=a;const t=I().console||{},r={mapHttpRequest:W,mapHttpResponse:W,wrapRequestSerializer:Y,wrapResponseSerializer:Y,wrapErrorSerializer:Y,req:W,res:W,err:V};function s(v,N){return Array.isArray(v)?v.filter(function(ie){return ie!=="!stdSerializers.err"}):v===!0?Object.keys(N):!1}function a(v){v=v||{},v.browser=v.browser||{};const N=v.browser.transmit;if(N&&typeof N.send!="function")throw Error("pino: transmit option must have a send function");const L=v.browser.write||t;v.browser.write&&(v.browser.asObject=!0);const ie=v.serializers||{},ne=s(v.browser.serialize,ie);let Ie=v.browser.serialize;Array.isArray(v.browser.serialize)&&v.browser.serialize.indexOf("!stdSerializers.err")>-1&&(Ie=!1);const Pe=["error","fatal","warn","info","debug","trace"];typeof L=="function"&&(L.error=L.fatal=L.warn=L.info=L.debug=L.trace=L),v.enabled===!1&&(v.level="silent");const D=v.level||"info",E=Object.create(L);E.log||(E.log=X),Object.defineProperty(E,"levelVal",{get:ye}),Object.defineProperty(E,"level",{get:fe,set:Q});const U={transmit:N,serialize:ne,asObject:v.browser.asObject,levels:Pe,timestamp:k(v)};E.levels=a.levels,E.level=D,E.setMaxListeners=E.getMaxListeners=E.emit=E.addListener=E.on=E.prependListener=E.once=E.prependOnceListener=E.removeListener=E.removeAllListeners=E.listeners=E.listenerCount=E.eventNames=E.write=E.flush=X,E.serializers=ie,E._serialize=ne,E._stdErrSerialize=Ie,E.child=Z,N&&(E._logEvent=F());function ye(){return this.level==="silent"?1/0:this.levels.values[this.level]}function fe(){return this._level}function Q(J){if(J!=="silent"&&!this.levels.values[J])throw Error("unknown level "+J);this._level=J,u(U,E,"error","log"),u(U,E,"fatal","error"),u(U,E,"warn","error"),u(U,E,"info","log"),u(U,E,"debug","log"),u(U,E,"trace","log")}function Z(J,ee){if(!J)throw new Error("missing bindings for child Pino");ee=ee||{},ne&&J.serializers&&(ee.serializers=J.serializers);const lt=ee.serializers;if(ne&&lt){var He=Object.assign({},ie,lt),Br=v.browser.serialize===!0?Object.keys(He):ne;delete J.serializers,_([J],Br,He,this._stdErrSerialize)}function Se(Ot){this._childLevel=(Ot._childLevel|0)+1,this.error=T(Ot,J,"error"),this.fatal=T(Ot,J,"fatal"),this.warn=T(Ot,J,"warn"),this.info=T(Ot,J,"info"),this.debug=T(Ot,J,"debug"),this.trace=T(Ot,J,"trace"),He&&(this.serializers=He,this._serialize=Br),N&&(this._logEvent=F([].concat(Ot._logEvent.bindings,J)))}return Se.prototype=this,new Se(this)}return E}a.levels={values:{fatal:60,error:50,warn:40,info:30,debug:20,trace:10},labels:{10:"trace",20:"debug",30:"info",40:"warn",50:"error",60:"fatal"}},a.stdSerializers=r,a.stdTimeFunctions=Object.assign({},{nullTime:he,epochTime:y,unixTime:w,isoTime:S});function u(v,N,L,ie){const ne=Object.getPrototypeOf(N);N[L]=N.levelVal>N.levels.values[L]?X:ne[L]?ne[L]:t[L]||t[ie]||X,f(v,N,L)}function f(v,N,L){!v.transmit&&N[L]===X||(N[L]=function(ie){return function(){const Ie=v.timestamp(),Pe=new Array(arguments.length),D=Object.getPrototypeOf&&Object.getPrototypeOf(this)===t?t:this;for(var E=0;E<Pe.length;E++)Pe[E]=arguments[E];if(v.serialize&&!v.asObject&&_(Pe,this._serialize,this.serializers,this._stdErrSerialize),v.asObject?ie.call(D,g(this,L,Pe,Ie)):ie.apply(D,Pe),v.transmit){const U=v.transmit.level||N.level,ye=a.levels.values[U],fe=a.levels.values[L];if(fe<ye)return;C(this,{ts:Ie,methodLevel:L,methodValue:fe,transmitLevel:U,transmitValue:a.levels.values[v.transmit.level||N.level],send:v.transmit.send,val:N.levelVal},Pe)}}}(N[L]))}function g(v,N,L,ie){v._serialize&&_(L,v._serialize,v.serializers,v._stdErrSerialize);const ne=L.slice();let Ie=ne[0];const Pe={};ie&&(Pe.time=ie),Pe.level=a.levels.values[N];let D=(v._childLevel|0)+1;if(D<1&&(D=1),Ie!==null&&typeof Ie=="object"){for(;D--&&typeof ne[0]=="object";)Object.assign(Pe,ne.shift());Ie=ne.length?n(ne.shift(),ne):void 0}else typeof Ie=="string"&&(Ie=n(ne.shift(),ne));return Ie!==void 0&&(Pe.msg=Ie),Pe}function _(v,N,L,ie){for(const ne in v)if(ie&&v[ne]instanceof Error)v[ne]=a.stdSerializers.err(v[ne]);else if(typeof v[ne]=="object"&&!Array.isArray(v[ne]))for(const Ie in v[ne])N&&N.indexOf(Ie)>-1&&Ie in L&&(v[ne][Ie]=L[Ie](v[ne][Ie]))}function T(v,N,L){return function(){const ie=new Array(1+arguments.length);ie[0]=N;for(var ne=1;ne<ie.length;ne++)ie[ne]=arguments[ne-1];return v[L].apply(this,ie)}}function C(v,N,L){const ie=N.send,ne=N.ts,Ie=N.methodLevel,Pe=N.methodValue,D=N.val,E=v._logEvent.bindings;_(L,v._serialize||Object.keys(v.serializers),v.serializers,v._stdErrSerialize===void 0?!0:v._stdErrSerialize),v._logEvent.ts=ne,v._logEvent.messages=L.filter(function(U){return E.indexOf(U)===-1}),v._logEvent.level.label=Ie,v._logEvent.level.value=Pe,ie(Ie,v._logEvent,D),v._logEvent=F(E)}function F(v){return{ts:0,messages:[],bindings:v||[],level:{label:"",value:0}}}function V(v){const N={type:v.constructor.name,msg:v.message,stack:v.stack};for(const L in v)N[L]===void 0&&(N[L]=v[L]);return N}function k(v){return typeof v.timestamp=="function"?v.timestamp:v.timestamp===!1?he:y}function W(){return{}}function Y(v){return v}function X(){}function he(){return!1}function y(){return Date.now()}function w(){return Math.round(Date.now()/1e3)}function S(){return new Date(Date.now()).toISOString()}function I(){function v(N){return typeof N<"u"&&N}try{return typeof globalThis<"u"||Object.defineProperty(Object.prototype,"globalThis",{get:function(){return delete Object.prototype.globalThis,this.globalThis=this},configurable:!0}),globalThis}catch{return v(self)||v(window)||v(this)||{}}}return Ec}var Ki={},Ol;function ad(){return Ol||(Ol=1,Object.defineProperty(Ki,"__esModule",{value:!0}),Ki.PINO_CUSTOM_CONTEXT_KEY=Ki.PINO_LOGGER_DEFAULTS=void 0,Ki.PINO_LOGGER_DEFAULTS={level:"info"},Ki.PINO_CUSTOM_CONTEXT_KEY="custom_context"),Ki}var sr={},Pl;function mb(){if(Pl)return sr;Pl=1,Object.defineProperty(sr,"__esModule",{value:!0}),sr.generateChildLogger=sr.formatChildLoggerContext=sr.getLoggerContext=sr.setBrowserLoggerContext=sr.getBrowserLoggerContext=sr.getDefaultLoggerOptions=void 0;const n=ad();function t(g){return Object.assign(Object.assign({},g),{level:(g==null?void 0:g.level)||n.PINO_LOGGER_DEFAULTS.level})}sr.getDefaultLoggerOptions=t;function r(g,_=n.PINO_CUSTOM_CONTEXT_KEY){return g[_]||""}sr.getBrowserLoggerContext=r;function s(g,_,T=n.PINO_CUSTOM_CONTEXT_KEY){return g[T]=_,g}sr.setBrowserLoggerContext=s;function a(g,_=n.PINO_CUSTOM_CONTEXT_KEY){let T="";return typeof g.bindings>"u"?T=r(g,_):T=g.bindings().context||"",T}sr.getLoggerContext=a;function u(g,_,T=n.PINO_CUSTOM_CONTEXT_KEY){const C=a(g,T);return C.trim()?`${C}/${_}`:_}sr.formatChildLoggerContext=u;function f(g,_,T=n.PINO_CUSTOM_CONTEXT_KEY){const C=u(g,_,T),F=g.child({context:C});return s(F,C,T)}return sr.generateChildLogger=f,sr}(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.pino=void 0;const t=Ti,r=t.__importDefault(yb());Object.defineProperty(n,"pino",{enumerable:!0,get:function(){return r.default}}),t.__exportStar(ad(),n),t.__exportStar(mb(),n)})(Ne);class vb extends Gi{constructor(t){super(),this.opts=t,this.protocol="wc",this.version=2}}let bb=class extends Gi{constructor(t,r){super(),this.core=t,this.logger=r,this.records=new Map}};class wb{constructor(t,r){this.logger=t,this.core=r}}let _b=class extends Gi{constructor(t,r){super(),this.relayer=t,this.logger=r}},Eb=class extends Gi{constructor(t){super()}},Ib=class{constructor(t,r,s,a){this.core=t,this.logger=r,this.name=s}};class Sb extends Gi{constructor(t,r){super(),this.relayer=t,this.logger=r}}let xb=class extends Gi{constructor(t,r){super(),this.core=t,this.logger=r}},Ob=class{constructor(t,r){this.projectId=t,this.logger=r}},Pb=class{constructor(t){this.opts=t,this.protocol="wc",this.version=2}},Tb=class{constructor(t){this.client=t}};const Ab=n=>JSON.stringify(n,(t,r)=>typeof r=="bigint"?r.toString()+"n":r),Cb=n=>{const t=/([\[:])?(\d{17,}|(?:[9](?:[1-9]07199254740991|0[1-9]7199254740991|00[8-9]199254740991|007[2-9]99254740991|007199[3-9]54740991|0071992[6-9]4740991|00719925[5-9]740991|007199254[8-9]40991|0071992547[5-9]0991|00719925474[1-9]991|00719925474099[2-9])))([,\}\]])/g,r=n.replace(t,'$1"$2n"$3');return JSON.parse(r,(s,a)=>typeof a=="string"&&a.match(/^\d+n$/)?BigInt(a.substring(0,a.length-1)):a)};function Rb(n){if(typeof n!="string")throw new Error(`Cannot safe json parse value of type ${typeof n}`);try{return Cb(n)}catch{return n}}function Nb(n){return typeof n=="string"?n:Ab(n)||""}var Wc={},cd={};(function(n){Object.defineProperty(n,"__esModule",{value:!0});var t=z1,r=qf;n.DIGEST_LENGTH=64,n.BLOCK_SIZE=128;var s=function(){function g(){this.digestLength=n.DIGEST_LENGTH,this.blockSize=n.BLOCK_SIZE,this._stateHi=new Int32Array(8),this._stateLo=new Int32Array(8),this._tempHi=new Int32Array(16),this._tempLo=new Int32Array(16),this._buffer=new Uint8Array(256),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this.reset()}return g.prototype._initState=function(){this._stateHi[0]=1779033703,this._stateHi[1]=3144134277,this._stateHi[2]=1013904242,this._stateHi[3]=2773480762,this._stateHi[4]=1359893119,this._stateHi[5]=2600822924,this._stateHi[6]=528734635,this._stateHi[7]=1541459225,this._stateLo[0]=4089235720,this._stateLo[1]=2227873595,this._stateLo[2]=4271175723,this._stateLo[3]=1595750129,this._stateLo[4]=2917565137,this._stateLo[5]=725511199,this._stateLo[6]=4215389547,this._stateLo[7]=327033209},g.prototype.reset=function(){return this._initState(),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this},g.prototype.clean=function(){r.wipe(this._buffer),r.wipe(this._tempHi),r.wipe(this._tempLo),this.reset()},g.prototype.update=function(_,T){if(T===void 0&&(T=_.length),this._finished)throw new Error("SHA512: can't update because hash was finished.");var C=0;if(this._bytesHashed+=T,this._bufferLength>0){for(;this._bufferLength<n.BLOCK_SIZE&&T>0;)this._buffer[this._bufferLength++]=_[C++],T--;this._bufferLength===this.blockSize&&(u(this._tempHi,this._tempLo,this._stateHi,this._stateLo,this._buffer,0,this.blockSize),this._bufferLength=0)}for(T>=this.blockSize&&(C=u(this._tempHi,this._tempLo,this._stateHi,this._stateLo,_,C,T),T%=this.blockSize);T>0;)this._buffer[this._bufferLength++]=_[C++],T--;return this},g.prototype.finish=function(_){if(!this._finished){var T=this._bytesHashed,C=this._bufferLength,F=T/536870912|0,V=T<<3,k=T%128<112?128:256;this._buffer[C]=128;for(var W=C+1;W<k-8;W++)this._buffer[W]=0;t.writeUint32BE(F,this._buffer,k-8),t.writeUint32BE(V,this._buffer,k-4),u(this._tempHi,this._tempLo,this._stateHi,this._stateLo,this._buffer,0,k),this._finished=!0}for(var W=0;W<this.digestLength/8;W++)t.writeUint32BE(this._stateHi[W],_,W*8),t.writeUint32BE(this._stateLo[W],_,W*8+4);return this},g.prototype.digest=function(){var _=new Uint8Array(this.digestLength);return this.finish(_),_},g.prototype.saveState=function(){if(this._finished)throw new Error("SHA256: cannot save finished state");return{stateHi:new Int32Array(this._stateHi),stateLo:new Int32Array(this._stateLo),buffer:this._bufferLength>0?new Uint8Array(this._buffer):void 0,bufferLength:this._bufferLength,bytesHashed:this._bytesHashed}},g.prototype.restoreState=function(_){return this._stateHi.set(_.stateHi),this._stateLo.set(_.stateLo),this._bufferLength=_.bufferLength,_.buffer&&this._buffer.set(_.buffer),this._bytesHashed=_.bytesHashed,this._finished=!1,this},g.prototype.cleanSavedState=function(_){r.wipe(_.stateHi),r.wipe(_.stateLo),_.buffer&&r.wipe(_.buffer),_.bufferLength=0,_.bytesHashed=0},g}();n.SHA512=s;var a=new Int32Array([1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591]);function u(g,_,T,C,F,V,k){for(var W=T[0],Y=T[1],X=T[2],he=T[3],y=T[4],w=T[5],S=T[6],I=T[7],v=C[0],N=C[1],L=C[2],ie=C[3],ne=C[4],Ie=C[5],Pe=C[6],D=C[7],E,U,ye,fe,Q,Z,J,ee;k>=128;){for(var lt=0;lt<16;lt++){var He=8*lt+V;g[lt]=t.readUint32BE(F,He),_[lt]=t.readUint32BE(F,He+4)}for(var lt=0;lt<80;lt++){var Br=W,Se=Y,Ot=X,q=he,M=y,$=w,h=S,O=I,ae=v,ge=N,_e=L,$e=ie,De=ne,Te=Ie,Pt=Pe,wt=D;if(E=I,U=D,Q=U&65535,Z=U>>>16,J=E&65535,ee=E>>>16,E=(y>>>14|ne<<32-14)^(y>>>18|ne<<32-18)^(ne>>>41-32|y<<32-(41-32)),U=(ne>>>14|y<<32-14)^(ne>>>18|y<<32-18)^(y>>>41-32|ne<<32-(41-32)),Q+=U&65535,Z+=U>>>16,J+=E&65535,ee+=E>>>16,E=y&w^~y&S,U=ne&Ie^~ne&Pe,Q+=U&65535,Z+=U>>>16,J+=E&65535,ee+=E>>>16,E=a[lt*2],U=a[lt*2+1],Q+=U&65535,Z+=U>>>16,J+=E&65535,ee+=E>>>16,E=g[lt%16],U=_[lt%16],Q+=U&65535,Z+=U>>>16,J+=E&65535,ee+=E>>>16,Z+=Q>>>16,J+=Z>>>16,ee+=J>>>16,ye=J&65535|ee<<16,fe=Q&65535|Z<<16,E=ye,U=fe,Q=U&65535,Z=U>>>16,J=E&65535,ee=E>>>16,E=(W>>>28|v<<32-28)^(v>>>34-32|W<<32-(34-32))^(v>>>39-32|W<<32-(39-32)),U=(v>>>28|W<<32-28)^(W>>>34-32|v<<32-(34-32))^(W>>>39-32|v<<32-(39-32)),Q+=U&65535,Z+=U>>>16,J+=E&65535,ee+=E>>>16,E=W&Y^W&X^Y&X,U=v&N^v&L^N&L,Q+=U&65535,Z+=U>>>16,J+=E&65535,ee+=E>>>16,Z+=Q>>>16,J+=Z>>>16,ee+=J>>>16,O=J&65535|ee<<16,wt=Q&65535|Z<<16,E=q,U=$e,Q=U&65535,Z=U>>>16,J=E&65535,ee=E>>>16,E=ye,U=fe,Q+=U&65535,Z+=U>>>16,J+=E&65535,ee+=E>>>16,Z+=Q>>>16,J+=Z>>>16,ee+=J>>>16,q=J&65535|ee<<16,$e=Q&65535|Z<<16,Y=Br,X=Se,he=Ot,y=q,w=M,S=$,I=h,W=O,N=ae,L=ge,ie=_e,ne=$e,Ie=De,Pe=Te,D=Pt,v=wt,lt%16===15)for(var He=0;He<16;He++)E=g[He],U=_[He],Q=U&65535,Z=U>>>16,J=E&65535,ee=E>>>16,E=g[(He+9)%16],U=_[(He+9)%16],Q+=U&65535,Z+=U>>>16,J+=E&65535,ee+=E>>>16,ye=g[(He+1)%16],fe=_[(He+1)%16],E=(ye>>>1|fe<<32-1)^(ye>>>8|fe<<32-8)^ye>>>7,U=(fe>>>1|ye<<32-1)^(fe>>>8|ye<<32-8)^(fe>>>7|ye<<32-7),Q+=U&65535,Z+=U>>>16,J+=E&65535,ee+=E>>>16,ye=g[(He+14)%16],fe=_[(He+14)%16],E=(ye>>>19|fe<<32-19)^(fe>>>61-32|ye<<32-(61-32))^ye>>>6,U=(fe>>>19|ye<<32-19)^(ye>>>61-32|fe<<32-(61-32))^(fe>>>6|ye<<32-6),Q+=U&65535,Z+=U>>>16,J+=E&65535,ee+=E>>>16,Z+=Q>>>16,J+=Z>>>16,ee+=J>>>16,g[He]=J&65535|ee<<16,_[He]=Q&65535|Z<<16}E=W,U=v,Q=U&65535,Z=U>>>16,J=E&65535,ee=E>>>16,E=T[0],U=C[0],Q+=U&65535,Z+=U>>>16,J+=E&65535,ee+=E>>>16,Z+=Q>>>16,J+=Z>>>16,ee+=J>>>16,T[0]=W=J&65535|ee<<16,C[0]=v=Q&65535|Z<<16,E=Y,U=N,Q=U&65535,Z=U>>>16,J=E&65535,ee=E>>>16,E=T[1],U=C[1],Q+=U&65535,Z+=U>>>16,J+=E&65535,ee+=E>>>16,Z+=Q>>>16,J+=Z>>>16,ee+=J>>>16,T[1]=Y=J&65535|ee<<16,C[1]=N=Q&65535|Z<<16,E=X,U=L,Q=U&65535,Z=U>>>16,J=E&65535,ee=E>>>16,E=T[2],U=C[2],Q+=U&65535,Z+=U>>>16,J+=E&65535,ee+=E>>>16,Z+=Q>>>16,J+=Z>>>16,ee+=J>>>16,T[2]=X=J&65535|ee<<16,C[2]=L=Q&65535|Z<<16,E=he,U=ie,Q=U&65535,Z=U>>>16,J=E&65535,ee=E>>>16,E=T[3],U=C[3],Q+=U&65535,Z+=U>>>16,J+=E&65535,ee+=E>>>16,Z+=Q>>>16,J+=Z>>>16,ee+=J>>>16,T[3]=he=J&65535|ee<<16,C[3]=ie=Q&65535|Z<<16,E=y,U=ne,Q=U&65535,Z=U>>>16,J=E&65535,ee=E>>>16,E=T[4],U=C[4],Q+=U&65535,Z+=U>>>16,J+=E&65535,ee+=E>>>16,Z+=Q>>>16,J+=Z>>>16,ee+=J>>>16,T[4]=y=J&65535|ee<<16,C[4]=ne=Q&65535|Z<<16,E=w,U=Ie,Q=U&65535,Z=U>>>16,J=E&65535,ee=E>>>16,E=T[5],U=C[5],Q+=U&65535,Z+=U>>>16,J+=E&65535,ee+=E>>>16,Z+=Q>>>16,J+=Z>>>16,ee+=J>>>16,T[5]=w=J&65535|ee<<16,C[5]=Ie=Q&65535|Z<<16,E=S,U=Pe,Q=U&65535,Z=U>>>16,J=E&65535,ee=E>>>16,E=T[6],U=C[6],Q+=U&65535,Z+=U>>>16,J+=E&65535,ee+=E>>>16,Z+=Q>>>16,J+=Z>>>16,ee+=J>>>16,T[6]=S=J&65535|ee<<16,C[6]=Pe=Q&65535|Z<<16,E=I,U=D,Q=U&65535,Z=U>>>16,J=E&65535,ee=E>>>16,E=T[7],U=C[7],Q+=U&65535,Z+=U>>>16,J+=E&65535,ee+=E>>>16,Z+=Q>>>16,J+=Z>>>16,ee+=J>>>16,T[7]=I=J&65535|ee<<16,C[7]=D=Q&65535|Z<<16,V+=128,k-=128}return V}function f(g){var _=new s;_.update(g);var T=_.digest();return _.clean(),T}n.hash=f})(cd);(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.convertSecretKeyToX25519=n.convertPublicKeyToX25519=n.verify=n.sign=n.extractPublicKeyFromSecretKey=n.generateKeyPair=n.generateKeyPairFromSeed=n.SEED_LENGTH=n.SECRET_KEY_LENGTH=n.PUBLIC_KEY_LENGTH=n.SIGNATURE_LENGTH=void 0;const t=jo,r=cd,s=qf;n.SIGNATURE_LENGTH=64,n.PUBLIC_KEY_LENGTH=32,n.SECRET_KEY_LENGTH=64,n.SEED_LENGTH=32;function a(q){const M=new Float64Array(16);if(q)for(let $=0;$<q.length;$++)M[$]=q[$];return M}const u=new Uint8Array(32);u[0]=9;const f=a(),g=a([1]),_=a([30883,4953,19914,30187,55467,16705,2637,112,59544,30585,16505,36039,65139,11119,27886,20995]),T=a([61785,9906,39828,60374,45398,33411,5274,224,53552,61171,33010,6542,64743,22239,55772,9222]),C=a([54554,36645,11616,51542,42930,38181,51040,26924,56412,64982,57905,49316,21502,52590,14035,8553]),F=a([26200,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214]),V=a([41136,18958,6951,50414,58488,44335,6150,12099,55207,15867,153,11085,57099,20417,9344,11139]);function k(q,M){for(let $=0;$<16;$++)q[$]=M[$]|0}function W(q){let M=1;for(let $=0;$<16;$++){let h=q[$]+M+65535;M=Math.floor(h/65536),q[$]=h-M*65536}q[0]+=M-1+37*(M-1)}function Y(q,M,$){const h=~($-1);for(let O=0;O<16;O++){const ae=h&(q[O]^M[O]);q[O]^=ae,M[O]^=ae}}function X(q,M){const $=a(),h=a();for(let O=0;O<16;O++)h[O]=M[O];W(h),W(h),W(h);for(let O=0;O<2;O++){$[0]=h[0]-65517;for(let ge=1;ge<15;ge++)$[ge]=h[ge]-65535-($[ge-1]>>16&1),$[ge-1]&=65535;$[15]=h[15]-32767-($[14]>>16&1);const ae=$[15]>>16&1;$[14]&=65535,Y(h,$,1-ae)}for(let O=0;O<16;O++)q[2*O]=h[O]&255,q[2*O+1]=h[O]>>8}function he(q,M){let $=0;for(let h=0;h<32;h++)$|=q[h]^M[h];return(1&$-1>>>8)-1}function y(q,M){const $=new Uint8Array(32),h=new Uint8Array(32);return X($,q),X(h,M),he($,h)}function w(q){const M=new Uint8Array(32);return X(M,q),M[0]&1}function S(q,M){for(let $=0;$<16;$++)q[$]=M[2*$]+(M[2*$+1]<<8);q[15]&=32767}function I(q,M,$){for(let h=0;h<16;h++)q[h]=M[h]+$[h]}function v(q,M,$){for(let h=0;h<16;h++)q[h]=M[h]-$[h]}function N(q,M,$){let h,O,ae=0,ge=0,_e=0,$e=0,De=0,Te=0,Pt=0,wt=0,at=0,Ue=0,Ze=0,et=0,ct=0,ze=0,tt=0,Le=0,Ve=0,ft=0,Me=0,Tt=0,Ut=0,Kt=0,Wt=0,qt=0,Zt=0,ur=0,Hr=0,er=0,Xr=0,gi=0,Ri=0,dt=$[0],nt=$[1],pt=$[2],gt=$[3],ut=$[4],st=$[5],At=$[6],Ct=$[7],yt=$[8],Rt=$[9],mt=$[10],_t=$[11],vt=$[12],Qe=$[13],Nt=$[14],$t=$[15];h=M[0],ae+=h*dt,ge+=h*nt,_e+=h*pt,$e+=h*gt,De+=h*ut,Te+=h*st,Pt+=h*At,wt+=h*Ct,at+=h*yt,Ue+=h*Rt,Ze+=h*mt,et+=h*_t,ct+=h*vt,ze+=h*Qe,tt+=h*Nt,Le+=h*$t,h=M[1],ge+=h*dt,_e+=h*nt,$e+=h*pt,De+=h*gt,Te+=h*ut,Pt+=h*st,wt+=h*At,at+=h*Ct,Ue+=h*yt,Ze+=h*Rt,et+=h*mt,ct+=h*_t,ze+=h*vt,tt+=h*Qe,Le+=h*Nt,Ve+=h*$t,h=M[2],_e+=h*dt,$e+=h*nt,De+=h*pt,Te+=h*gt,Pt+=h*ut,wt+=h*st,at+=h*At,Ue+=h*Ct,Ze+=h*yt,et+=h*Rt,ct+=h*mt,ze+=h*_t,tt+=h*vt,Le+=h*Qe,Ve+=h*Nt,ft+=h*$t,h=M[3],$e+=h*dt,De+=h*nt,Te+=h*pt,Pt+=h*gt,wt+=h*ut,at+=h*st,Ue+=h*At,Ze+=h*Ct,et+=h*yt,ct+=h*Rt,ze+=h*mt,tt+=h*_t,Le+=h*vt,Ve+=h*Qe,ft+=h*Nt,Me+=h*$t,h=M[4],De+=h*dt,Te+=h*nt,Pt+=h*pt,wt+=h*gt,at+=h*ut,Ue+=h*st,Ze+=h*At,et+=h*Ct,ct+=h*yt,ze+=h*Rt,tt+=h*mt,Le+=h*_t,Ve+=h*vt,ft+=h*Qe,Me+=h*Nt,Tt+=h*$t,h=M[5],Te+=h*dt,Pt+=h*nt,wt+=h*pt,at+=h*gt,Ue+=h*ut,Ze+=h*st,et+=h*At,ct+=h*Ct,ze+=h*yt,tt+=h*Rt,Le+=h*mt,Ve+=h*_t,ft+=h*vt,Me+=h*Qe,Tt+=h*Nt,Ut+=h*$t,h=M[6],Pt+=h*dt,wt+=h*nt,at+=h*pt,Ue+=h*gt,Ze+=h*ut,et+=h*st,ct+=h*At,ze+=h*Ct,tt+=h*yt,Le+=h*Rt,Ve+=h*mt,ft+=h*_t,Me+=h*vt,Tt+=h*Qe,Ut+=h*Nt,Kt+=h*$t,h=M[7],wt+=h*dt,at+=h*nt,Ue+=h*pt,Ze+=h*gt,et+=h*ut,ct+=h*st,ze+=h*At,tt+=h*Ct,Le+=h*yt,Ve+=h*Rt,ft+=h*mt,Me+=h*_t,Tt+=h*vt,Ut+=h*Qe,Kt+=h*Nt,Wt+=h*$t,h=M[8],at+=h*dt,Ue+=h*nt,Ze+=h*pt,et+=h*gt,ct+=h*ut,ze+=h*st,tt+=h*At,Le+=h*Ct,Ve+=h*yt,ft+=h*Rt,Me+=h*mt,Tt+=h*_t,Ut+=h*vt,Kt+=h*Qe,Wt+=h*Nt,qt+=h*$t,h=M[9],Ue+=h*dt,Ze+=h*nt,et+=h*pt,ct+=h*gt,ze+=h*ut,tt+=h*st,Le+=h*At,Ve+=h*Ct,ft+=h*yt,Me+=h*Rt,Tt+=h*mt,Ut+=h*_t,Kt+=h*vt,Wt+=h*Qe,qt+=h*Nt,Zt+=h*$t,h=M[10],Ze+=h*dt,et+=h*nt,ct+=h*pt,ze+=h*gt,tt+=h*ut,Le+=h*st,Ve+=h*At,ft+=h*Ct,Me+=h*yt,Tt+=h*Rt,Ut+=h*mt,Kt+=h*_t,Wt+=h*vt,qt+=h*Qe,Zt+=h*Nt,ur+=h*$t,h=M[11],et+=h*dt,ct+=h*nt,ze+=h*pt,tt+=h*gt,Le+=h*ut,Ve+=h*st,ft+=h*At,Me+=h*Ct,Tt+=h*yt,Ut+=h*Rt,Kt+=h*mt,Wt+=h*_t,qt+=h*vt,Zt+=h*Qe,ur+=h*Nt,Hr+=h*$t,h=M[12],ct+=h*dt,ze+=h*nt,tt+=h*pt,Le+=h*gt,Ve+=h*ut,ft+=h*st,Me+=h*At,Tt+=h*Ct,Ut+=h*yt,Kt+=h*Rt,Wt+=h*mt,qt+=h*_t,Zt+=h*vt,ur+=h*Qe,Hr+=h*Nt,er+=h*$t,h=M[13],ze+=h*dt,tt+=h*nt,Le+=h*pt,Ve+=h*gt,ft+=h*ut,Me+=h*st,Tt+=h*At,Ut+=h*Ct,Kt+=h*yt,Wt+=h*Rt,qt+=h*mt,Zt+=h*_t,ur+=h*vt,Hr+=h*Qe,er+=h*Nt,Xr+=h*$t,h=M[14],tt+=h*dt,Le+=h*nt,Ve+=h*pt,ft+=h*gt,Me+=h*ut,Tt+=h*st,Ut+=h*At,Kt+=h*Ct,Wt+=h*yt,qt+=h*Rt,Zt+=h*mt,ur+=h*_t,Hr+=h*vt,er+=h*Qe,Xr+=h*Nt,gi+=h*$t,h=M[15],Le+=h*dt,Ve+=h*nt,ft+=h*pt,Me+=h*gt,Tt+=h*ut,Ut+=h*st,Kt+=h*At,Wt+=h*Ct,qt+=h*yt,Zt+=h*Rt,ur+=h*mt,Hr+=h*_t,er+=h*vt,Xr+=h*Qe,gi+=h*Nt,Ri+=h*$t,ae+=38*Ve,ge+=38*ft,_e+=38*Me,$e+=38*Tt,De+=38*Ut,Te+=38*Kt,Pt+=38*Wt,wt+=38*qt,at+=38*Zt,Ue+=38*ur,Ze+=38*Hr,et+=38*er,ct+=38*Xr,ze+=38*gi,tt+=38*Ri,O=1,h=ae+O+65535,O=Math.floor(h/65536),ae=h-O*65536,h=ge+O+65535,O=Math.floor(h/65536),ge=h-O*65536,h=_e+O+65535,O=Math.floor(h/65536),_e=h-O*65536,h=$e+O+65535,O=Math.floor(h/65536),$e=h-O*65536,h=De+O+65535,O=Math.floor(h/65536),De=h-O*65536,h=Te+O+65535,O=Math.floor(h/65536),Te=h-O*65536,h=Pt+O+65535,O=Math.floor(h/65536),Pt=h-O*65536,h=wt+O+65535,O=Math.floor(h/65536),wt=h-O*65536,h=at+O+65535,O=Math.floor(h/65536),at=h-O*65536,h=Ue+O+65535,O=Math.floor(h/65536),Ue=h-O*65536,h=Ze+O+65535,O=Math.floor(h/65536),Ze=h-O*65536,h=et+O+65535,O=Math.floor(h/65536),et=h-O*65536,h=ct+O+65535,O=Math.floor(h/65536),ct=h-O*65536,h=ze+O+65535,O=Math.floor(h/65536),ze=h-O*65536,h=tt+O+65535,O=Math.floor(h/65536),tt=h-O*65536,h=Le+O+65535,O=Math.floor(h/65536),Le=h-O*65536,ae+=O-1+37*(O-1),O=1,h=ae+O+65535,O=Math.floor(h/65536),ae=h-O*65536,h=ge+O+65535,O=Math.floor(h/65536),ge=h-O*65536,h=_e+O+65535,O=Math.floor(h/65536),_e=h-O*65536,h=$e+O+65535,O=Math.floor(h/65536),$e=h-O*65536,h=De+O+65535,O=Math.floor(h/65536),De=h-O*65536,h=Te+O+65535,O=Math.floor(h/65536),Te=h-O*65536,h=Pt+O+65535,O=Math.floor(h/65536),Pt=h-O*65536,h=wt+O+65535,O=Math.floor(h/65536),wt=h-O*65536,h=at+O+65535,O=Math.floor(h/65536),at=h-O*65536,h=Ue+O+65535,O=Math.floor(h/65536),Ue=h-O*65536,h=Ze+O+65535,O=Math.floor(h/65536),Ze=h-O*65536,h=et+O+65535,O=Math.floor(h/65536),et=h-O*65536,h=ct+O+65535,O=Math.floor(h/65536),ct=h-O*65536,h=ze+O+65535,O=Math.floor(h/65536),ze=h-O*65536,h=tt+O+65535,O=Math.floor(h/65536),tt=h-O*65536,h=Le+O+65535,O=Math.floor(h/65536),Le=h-O*65536,ae+=O-1+37*(O-1),q[0]=ae,q[1]=ge,q[2]=_e,q[3]=$e,q[4]=De,q[5]=Te,q[6]=Pt,q[7]=wt,q[8]=at,q[9]=Ue,q[10]=Ze,q[11]=et,q[12]=ct,q[13]=ze,q[14]=tt,q[15]=Le}function L(q,M){N(q,M,M)}function ie(q,M){const $=a();let h;for(h=0;h<16;h++)$[h]=M[h];for(h=253;h>=0;h--)L($,$),h!==2&&h!==4&&N($,$,M);for(h=0;h<16;h++)q[h]=$[h]}function ne(q,M){const $=a();let h;for(h=0;h<16;h++)$[h]=M[h];for(h=250;h>=0;h--)L($,$),h!==1&&N($,$,M);for(h=0;h<16;h++)q[h]=$[h]}function Ie(q,M){const $=a(),h=a(),O=a(),ae=a(),ge=a(),_e=a(),$e=a(),De=a(),Te=a();v($,q[1],q[0]),v(Te,M[1],M[0]),N($,$,Te),I(h,q[0],q[1]),I(Te,M[0],M[1]),N(h,h,Te),N(O,q[3],M[3]),N(O,O,T),N(ae,q[2],M[2]),I(ae,ae,ae),v(ge,h,$),v(_e,ae,O),I($e,ae,O),I(De,h,$),N(q[0],ge,_e),N(q[1],De,$e),N(q[2],$e,_e),N(q[3],ge,De)}function Pe(q,M,$){for(let h=0;h<4;h++)Y(q[h],M[h],$)}function D(q,M){const $=a(),h=a(),O=a();ie(O,M[2]),N($,M[0],O),N(h,M[1],O),X(q,h),q[31]^=w($)<<7}function E(q,M,$){k(q[0],f),k(q[1],g),k(q[2],g),k(q[3],f);for(let h=255;h>=0;--h){const O=$[h/8|0]>>(h&7)&1;Pe(q,M,O),Ie(M,q),Ie(q,q),Pe(q,M,O)}}function U(q,M){const $=[a(),a(),a(),a()];k($[0],C),k($[1],F),k($[2],g),N($[3],C,F),E(q,$,M)}function ye(q){if(q.length!==n.SEED_LENGTH)throw new Error(`ed25519: seed must be ${n.SEED_LENGTH} bytes`);const M=(0,r.hash)(q);M[0]&=248,M[31]&=127,M[31]|=64;const $=new Uint8Array(32),h=[a(),a(),a(),a()];U(h,M),D($,h);const O=new Uint8Array(64);return O.set(q),O.set($,32),{publicKey:$,secretKey:O}}n.generateKeyPairFromSeed=ye;function fe(q){const M=(0,t.randomBytes)(32,q),$=ye(M);return(0,s.wipe)(M),$}n.generateKeyPair=fe;function Q(q){if(q.length!==n.SECRET_KEY_LENGTH)throw new Error(`ed25519: secret key must be ${n.SECRET_KEY_LENGTH} bytes`);return new Uint8Array(q.subarray(32))}n.extractPublicKeyFromSecretKey=Q;const Z=new Float64Array([237,211,245,92,26,99,18,88,214,156,247,162,222,249,222,20,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,16]);function J(q,M){let $,h,O,ae;for(h=63;h>=32;--h){for($=0,O=h-32,ae=h-12;O<ae;++O)M[O]+=$-16*M[h]*Z[O-(h-32)],$=Math.floor((M[O]+128)/256),M[O]-=$*256;M[O]+=$,M[h]=0}for($=0,O=0;O<32;O++)M[O]+=$-(M[31]>>4)*Z[O],$=M[O]>>8,M[O]&=255;for(O=0;O<32;O++)M[O]-=$*Z[O];for(h=0;h<32;h++)M[h+1]+=M[h]>>8,q[h]=M[h]&255}function ee(q){const M=new Float64Array(64);for(let $=0;$<64;$++)M[$]=q[$];for(let $=0;$<64;$++)q[$]=0;J(q,M)}function lt(q,M){const $=new Float64Array(64),h=[a(),a(),a(),a()],O=(0,r.hash)(q.subarray(0,32));O[0]&=248,O[31]&=127,O[31]|=64;const ae=new Uint8Array(64);ae.set(O.subarray(32),32);const ge=new r.SHA512;ge.update(ae.subarray(32)),ge.update(M);const _e=ge.digest();ge.clean(),ee(_e),U(h,_e),D(ae,h),ge.reset(),ge.update(ae.subarray(0,32)),ge.update(q.subarray(32)),ge.update(M);const $e=ge.digest();ee($e);for(let De=0;De<32;De++)$[De]=_e[De];for(let De=0;De<32;De++)for(let Te=0;Te<32;Te++)$[De+Te]+=$e[De]*O[Te];return J(ae.subarray(32),$),ae}n.sign=lt;function He(q,M){const $=a(),h=a(),O=a(),ae=a(),ge=a(),_e=a(),$e=a();return k(q[2],g),S(q[1],M),L(O,q[1]),N(ae,O,_),v(O,O,q[2]),I(ae,q[2],ae),L(ge,ae),L(_e,ge),N($e,_e,ge),N($,$e,O),N($,$,ae),ne($,$),N($,$,O),N($,$,ae),N($,$,ae),N(q[0],$,ae),L(h,q[0]),N(h,h,ae),y(h,O)&&N(q[0],q[0],V),L(h,q[0]),N(h,h,ae),y(h,O)?-1:(w(q[0])===M[31]>>7&&v(q[0],f,q[0]),N(q[3],q[0],q[1]),0)}function Br(q,M,$){const h=new Uint8Array(32),O=[a(),a(),a(),a()],ae=[a(),a(),a(),a()];if($.length!==n.SIGNATURE_LENGTH)throw new Error(`ed25519: signature must be ${n.SIGNATURE_LENGTH} bytes`);if(He(ae,q))return!1;const ge=new r.SHA512;ge.update($.subarray(0,32)),ge.update(q),ge.update(M);const _e=ge.digest();return ee(_e),E(O,ae,_e),U(ae,$.subarray(32)),Ie(O,ae),D(h,O),!he($,h)}n.verify=Br;function Se(q){let M=[a(),a(),a(),a()];if(He(M,q))throw new Error("Ed25519: invalid public key");let $=a(),h=a(),O=M[1];I($,g,O),v(h,g,O),ie(h,h),N($,$,h);let ae=new Uint8Array(32);return X(ae,$),ae}n.convertPublicKeyToX25519=Se;function Ot(q){const M=(0,r.hash)(q.subarray(0,32));M[0]&=248,M[31]&=127,M[31]|=64;const $=new Uint8Array(M.subarray(0,32));return(0,s.wipe)(M),$}n.convertSecretKeyToX25519=Ot})(Wc);const $b="EdDSA",Lb="JWT",ud=".",hd="base64url",Db="utf8",Fb="utf8",Ub=":",jb="did",Mb="key",Tl="base58btc",qb="z",zb="K36",kb=32,Bb=n=>JSON.stringify(n,(t,r)=>typeof r=="bigint"?r.toString()+"n":r);function Hb(n){return typeof n=="string"?n:Bb(n)||""}function No(n){return cr(mr(Hb(n),Db),hd)}function ld(n){const t=mr(zb,Tl),r=qb+cr(Dc([t,n]),Tl);return[jb,Mb,r].join(Ub)}function Vb(n){return cr(n,hd)}function Kb(n){return mr([No(n.header),No(n.payload)].join(ud),Fb)}function Wb(n){return[No(n.header),No(n.payload),Vb(n.signature)].join(ud)}function Al(n=jo.randomBytes(kb)){return Wc.generateKeyPairFromSeed(n)}async function Gb(n,t,r,s,a=ue.fromMiliseconds(Date.now())){const u={alg:$b,typ:Lb},f=ld(s.publicKey),g=a+r,_={iss:f,sub:n,aud:t,iat:a,exp:g},T=Kb({header:u,payload:_}),C=Wc.sign(s.secretKey,T);return Wb({header:u,payload:_,signature:C})}var Cl=globalThis&&globalThis.__spreadArray||function(n,t,r){if(r||arguments.length===2)for(var s=0,a=t.length,u;s<a;s++)(u||!(s in t))&&(u||(u=Array.prototype.slice.call(t,0,s)),u[s]=t[s]);return n.concat(u||Array.prototype.slice.call(t))},Jb=function(){function n(t,r,s){this.name=t,this.version=r,this.os=s,this.type="browser"}return n}(),Qb=function(){function n(t){this.version=t,this.type="node",this.name="node",this.os=process.platform}return n}(),Yb=function(){function n(t,r,s,a){this.name=t,this.version=r,this.os=s,this.bot=a,this.type="bot-device"}return n}(),Xb=function(){function n(){this.type="bot",this.bot=!0,this.name="bot",this.version=null,this.os=null}return n}(),Zb=function(){function n(){this.type="react-native",this.name="react-native",this.version=null,this.os=null}return n}(),ew=/alexa|bot|crawl(er|ing)|facebookexternalhit|feedburner|google web preview|nagios|postrank|pingdom|slurp|spider|yahoo!|yandex/,tw=/(nuhk|curl|Googlebot|Yammybot|Openbot|Slurp|MSNBot|Ask\ Jeeves\/Teoma|ia_archiver)/,Rl=3,rw=[["aol",/AOLShield\/([0-9\._]+)/],["edge",/Edge\/([0-9\._]+)/],["edge-ios",/EdgiOS\/([0-9\._]+)/],["yandexbrowser",/YaBrowser\/([0-9\._]+)/],["kakaotalk",/KAKAOTALK\s([0-9\.]+)/],["samsung",/SamsungBrowser\/([0-9\.]+)/],["silk",/\bSilk\/([0-9._-]+)\b/],["miui",/MiuiBrowser\/([0-9\.]+)$/],["beaker",/BeakerBrowser\/([0-9\.]+)/],["edge-chromium",/EdgA?\/([0-9\.]+)/],["chromium-webview",/(?!Chrom.*OPR)wv\).*Chrom(?:e|ium)\/([0-9\.]+)(:?\s|$)/],["chrome",/(?!Chrom.*OPR)Chrom(?:e|ium)\/([0-9\.]+)(:?\s|$)/],["phantomjs",/PhantomJS\/([0-9\.]+)(:?\s|$)/],["crios",/CriOS\/([0-9\.]+)(:?\s|$)/],["firefox",/Firefox\/([0-9\.]+)(?:\s|$)/],["fxios",/FxiOS\/([0-9\.]+)/],["opera-mini",/Opera Mini.*Version\/([0-9\.]+)/],["opera",/Opera\/([0-9\.]+)(?:\s|$)/],["opera",/OPR\/([0-9\.]+)(:?\s|$)/],["pie",/^Microsoft Pocket Internet Explorer\/(\d+\.\d+)$/],["pie",/^Mozilla\/\d\.\d+\s\(compatible;\s(?:MSP?IE|MSInternet Explorer) (\d+\.\d+);.*Windows CE.*\)$/],["netfront",/^Mozilla\/\d\.\d+.*NetFront\/(\d.\d)/],["ie",/Trident\/7\.0.*rv\:([0-9\.]+).*\).*Gecko$/],["ie",/MSIE\s([0-9\.]+);.*Trident\/[4-7].0/],["ie",/MSIE\s(7\.0)/],["bb10",/BB10;\sTouch.*Version\/([0-9\.]+)/],["android",/Android\s([0-9\.]+)/],["ios",/Version\/([0-9\._]+).*Mobile.*Safari.*/],["safari",/Version\/([0-9\._]+).*Safari/],["facebook",/FB[AS]V\/([0-9\.]+)/],["instagram",/Instagram\s([0-9\.]+)/],["ios-webview",/AppleWebKit\/([0-9\.]+).*Mobile/],["ios-webview",/AppleWebKit\/([0-9\.]+).*Gecko\)$/],["curl",/^curl\/([0-9\.]+)$/],["searchbot",ew]],Nl=[["iOS",/iP(hone|od|ad)/],["Android OS",/Android/],["BlackBerry OS",/BlackBerry|BB10/],["Windows Mobile",/IEMobile/],["Amazon OS",/Kindle/],["Windows 3.11",/Win16/],["Windows 95",/(Windows 95)|(Win95)|(Windows_95)/],["Windows 98",/(Windows 98)|(Win98)/],["Windows 2000",/(Windows NT 5.0)|(Windows 2000)/],["Windows XP",/(Windows NT 5.1)|(Windows XP)/],["Windows Server 2003",/(Windows NT 5.2)/],["Windows Vista",/(Windows NT 6.0)/],["Windows 7",/(Windows NT 6.1)/],["Windows 8",/(Windows NT 6.2)/],["Windows 8.1",/(Windows NT 6.3)/],["Windows 10",/(Windows NT 10.0)/],["Windows ME",/Windows ME/],["Windows CE",/Windows CE|WinCE|Microsoft Pocket Internet Explorer/],["Open BSD",/OpenBSD/],["Sun OS",/SunOS/],["Chrome OS",/CrOS/],["Linux",/(Linux)|(X11)/],["Mac OS",/(Mac_PowerPC)|(Macintosh)/],["QNX",/QNX/],["BeOS",/BeOS/],["OS/2",/OS\/2/]];function iw(n){return n?$l(n):typeof document>"u"&&typeof navigator<"u"&&navigator.product==="ReactNative"?new Zb:typeof navigator<"u"?$l(navigator.userAgent):ow()}function nw(n){return n!==""&&rw.reduce(function(t,r){var s=r[0],a=r[1];if(t)return t;var u=a.exec(n);return!!u&&[s,u]},!1)}function $l(n){var t=nw(n);if(!t)return null;var r=t[0],s=t[1];if(r==="searchbot")return new Xb;var a=s[1]&&s[1].split(".").join("_").split("_").slice(0,3);a?a.length<Rl&&(a=Cl(Cl([],a,!0),aw(Rl-a.length),!0)):a=[];var u=a.join("."),f=sw(n),g=tw.exec(n);return g&&g[1]?new Yb(r,u,f,g[1]):new Jb(r,u,f)}function sw(n){for(var t=0,r=Nl.length;t<r;t++){var s=Nl[t],a=s[0],u=s[1],f=u.exec(n);if(f)return a}return null}function ow(){var n=typeof process<"u"&&process.version;return n?new Qb(process.version.slice(1)):null}function aw(n){for(var t=[],r=0;r<n;r++)t.push("0");return t}var Ye={};Object.defineProperty(Ye,"__esModule",{value:!0});Ye.getLocalStorage=Ye.getLocalStorageOrThrow=Ye.getCrypto=Ye.getCryptoOrThrow=dd=Ye.getLocation=Ye.getLocationOrThrow=Gc=Ye.getNavigator=Ye.getNavigatorOrThrow=fd=Ye.getDocument=Ye.getDocumentOrThrow=Ye.getFromWindowOrThrow=Ye.getFromWindow=void 0;function Ji(n){let t;return typeof window<"u"&&typeof window[n]<"u"&&(t=window[n]),t}Ye.getFromWindow=Ji;function Pn(n){const t=Ji(n);if(!t)throw new Error(`${n} is not defined in Window`);return t}Ye.getFromWindowOrThrow=Pn;function cw(){return Pn("document")}Ye.getDocumentOrThrow=cw;function uw(){return Ji("document")}var fd=Ye.getDocument=uw;function hw(){return Pn("navigator")}Ye.getNavigatorOrThrow=hw;function lw(){return Ji("navigator")}var Gc=Ye.getNavigator=lw;function fw(){return Pn("location")}Ye.getLocationOrThrow=fw;function dw(){return Ji("location")}var dd=Ye.getLocation=dw;function pw(){return Pn("crypto")}Ye.getCryptoOrThrow=pw;function gw(){return Ji("crypto")}Ye.getCrypto=gw;function yw(){return Pn("localStorage")}Ye.getLocalStorageOrThrow=yw;function mw(){return Ji("localStorage")}Ye.getLocalStorage=mw;var Jc={};Object.defineProperty(Jc,"__esModule",{value:!0});var pd=Jc.getWindowMetadata=void 0;const Ll=Ye;function vw(){let n,t;try{n=Ll.getDocumentOrThrow(),t=Ll.getLocationOrThrow()}catch{return null}function r(){const F=n.getElementsByTagName("link"),V=[];for(let k=0;k<F.length;k++){const W=F[k],Y=W.getAttribute("rel");if(Y&&Y.toLowerCase().indexOf("icon")>-1){const X=W.getAttribute("href");if(X)if(X.toLowerCase().indexOf("https:")===-1&&X.toLowerCase().indexOf("http:")===-1&&X.indexOf("//")!==0){let he=t.protocol+"//"+t.host;if(X.indexOf("/")===0)he+=X;else{const y=t.pathname.split("/");y.pop();const w=y.join("/");he+=w+"/"+X}V.push(he)}else if(X.indexOf("//")===0){const he=t.protocol+X;V.push(he)}else V.push(X)}}return V}function s(...F){const V=n.getElementsByTagName("meta");for(let k=0;k<V.length;k++){const W=V[k],Y=["itemprop","property","name"].map(X=>W.getAttribute(X)).filter(X=>X?F.includes(X):!1);if(Y.length&&Y){const X=W.getAttribute("content");if(X)return X}}return""}function a(){let F=s("name","og:site_name","og:title","twitter:title");return F||(F=n.title),F}function u(){return s("description","og:description","twitter:description","keywords")}const f=a(),g=u(),_=t.origin,T=r();return{description:g,url:_,icons:T,name:f}}pd=Jc.getWindowMetadata=vw;var hs={};(function(n){const t=Bf,r=Hf,s=zf,a=kf,u=y=>y==null,f=Symbol("encodeFragmentIdentifier");function g(y){switch(y.arrayFormat){case"index":return w=>(S,I)=>{const v=S.length;return I===void 0||y.skipNull&&I===null||y.skipEmptyString&&I===""?S:I===null?[...S,[C(w,y),"[",v,"]"].join("")]:[...S,[C(w,y),"[",C(v,y),"]=",C(I,y)].join("")]};case"bracket":return w=>(S,I)=>I===void 0||y.skipNull&&I===null||y.skipEmptyString&&I===""?S:I===null?[...S,[C(w,y),"[]"].join("")]:[...S,[C(w,y),"[]=",C(I,y)].join("")];case"colon-list-separator":return w=>(S,I)=>I===void 0||y.skipNull&&I===null||y.skipEmptyString&&I===""?S:I===null?[...S,[C(w,y),":list="].join("")]:[...S,[C(w,y),":list=",C(I,y)].join("")];case"comma":case"separator":case"bracket-separator":{const w=y.arrayFormat==="bracket-separator"?"[]=":"=";return S=>(I,v)=>v===void 0||y.skipNull&&v===null||y.skipEmptyString&&v===""?I:(v=v===null?"":v,I.length===0?[[C(S,y),w,C(v,y)].join("")]:[[I,C(v,y)].join(y.arrayFormatSeparator)])}default:return w=>(S,I)=>I===void 0||y.skipNull&&I===null||y.skipEmptyString&&I===""?S:I===null?[...S,C(w,y)]:[...S,[C(w,y),"=",C(I,y)].join("")]}}function _(y){let w;switch(y.arrayFormat){case"index":return(S,I,v)=>{if(w=/\[(\d*)\]$/.exec(S),S=S.replace(/\[\d*\]$/,""),!w){v[S]=I;return}v[S]===void 0&&(v[S]={}),v[S][w[1]]=I};case"bracket":return(S,I,v)=>{if(w=/(\[\])$/.exec(S),S=S.replace(/\[\]$/,""),!w){v[S]=I;return}if(v[S]===void 0){v[S]=[I];return}v[S]=[].concat(v[S],I)};case"colon-list-separator":return(S,I,v)=>{if(w=/(:list)$/.exec(S),S=S.replace(/:list$/,""),!w){v[S]=I;return}if(v[S]===void 0){v[S]=[I];return}v[S]=[].concat(v[S],I)};case"comma":case"separator":return(S,I,v)=>{const N=typeof I=="string"&&I.includes(y.arrayFormatSeparator),L=typeof I=="string"&&!N&&F(I,y).includes(y.arrayFormatSeparator);I=L?F(I,y):I;const ie=N||L?I.split(y.arrayFormatSeparator).map(ne=>F(ne,y)):I===null?I:F(I,y);v[S]=ie};case"bracket-separator":return(S,I,v)=>{const N=/(\[\])$/.test(S);if(S=S.replace(/\[\]$/,""),!N){v[S]=I&&F(I,y);return}const L=I===null?[]:I.split(y.arrayFormatSeparator).map(ie=>F(ie,y));if(v[S]===void 0){v[S]=L;return}v[S]=[].concat(v[S],L)};default:return(S,I,v)=>{if(v[S]===void 0){v[S]=I;return}v[S]=[].concat(v[S],I)}}}function T(y){if(typeof y!="string"||y.length!==1)throw new TypeError("arrayFormatSeparator must be single character string")}function C(y,w){return w.encode?w.strict?t(y):encodeURIComponent(y):y}function F(y,w){return w.decode?r(y):y}function V(y){return Array.isArray(y)?y.sort():typeof y=="object"?V(Object.keys(y)).sort((w,S)=>Number(w)-Number(S)).map(w=>y[w]):y}function k(y){const w=y.indexOf("#");return w!==-1&&(y=y.slice(0,w)),y}function W(y){let w="";const S=y.indexOf("#");return S!==-1&&(w=y.slice(S)),w}function Y(y){y=k(y);const w=y.indexOf("?");return w===-1?"":y.slice(w+1)}function X(y,w){return w.parseNumbers&&!Number.isNaN(Number(y))&&typeof y=="string"&&y.trim()!==""?y=Number(y):w.parseBooleans&&y!==null&&(y.toLowerCase()==="true"||y.toLowerCase()==="false")&&(y=y.toLowerCase()==="true"),y}function he(y,w){w=Object.assign({decode:!0,sort:!0,arrayFormat:"none",arrayFormatSeparator:",",parseNumbers:!1,parseBooleans:!1},w),T(w.arrayFormatSeparator);const S=_(w),I=Object.create(null);if(typeof y!="string"||(y=y.trim().replace(/^[?#&]/,""),!y))return I;for(const v of y.split("&")){if(v==="")continue;let[N,L]=s(w.decode?v.replace(/\+/g," "):v,"=");L=L===void 0?null:["comma","separator","bracket-separator"].includes(w.arrayFormat)?L:F(L,w),S(F(N,w),L,I)}for(const v of Object.keys(I)){const N=I[v];if(typeof N=="object"&&N!==null)for(const L of Object.keys(N))N[L]=X(N[L],w);else I[v]=X(N,w)}return w.sort===!1?I:(w.sort===!0?Object.keys(I).sort():Object.keys(I).sort(w.sort)).reduce((v,N)=>{const L=I[N];return L&&typeof L=="object"&&!Array.isArray(L)?v[N]=V(L):v[N]=L,v},Object.create(null))}n.extract=Y,n.parse=he,n.stringify=(y,w)=>{if(!y)return"";w=Object.assign({encode:!0,strict:!0,arrayFormat:"none",arrayFormatSeparator:","},w),T(w.arrayFormatSeparator);const S=L=>w.skipNull&&u(y[L])||w.skipEmptyString&&y[L]==="",I=g(w),v={};for(const L of Object.keys(y))S(L)||(v[L]=y[L]);const N=Object.keys(v);return w.sort!==!1&&N.sort(w.sort),N.map(L=>{const ie=y[L];return ie===void 0?"":ie===null?C(L,w):Array.isArray(ie)?ie.length===0&&w.arrayFormat==="bracket-separator"?C(L,w)+"[]":ie.reduce(I(L),[]).join("&"):C(L,w)+"="+C(ie,w)}).filter(L=>L.length>0).join("&")},n.parseUrl=(y,w)=>{w=Object.assign({decode:!0},w);const[S,I]=s(y,"#");return Object.assign({url:S.split("?")[0]||"",query:he(Y(y),w)},w&&w.parseFragmentIdentifier&&I?{fragmentIdentifier:F(I,w)}:{})},n.stringifyUrl=(y,w)=>{w=Object.assign({encode:!0,strict:!0,[f]:!0},w);const S=k(y.url).split("?")[0]||"",I=n.extract(y.url),v=n.parse(I,{sort:!1}),N=Object.assign(v,y.query);let L=n.stringify(N,w);L&&(L=`?${L}`);let ie=W(y.url);return y.fragmentIdentifier&&(ie=`#${w[f]?C(y.fragmentIdentifier,w):y.fragmentIdentifier}`),`${S}${L}${ie}`},n.pick=(y,w,S)=>{S=Object.assign({parseFragmentIdentifier:!0,[f]:!1},S);const{url:I,query:v,fragmentIdentifier:N}=n.parseUrl(y,S);return n.stringifyUrl({url:I,query:a(v,w),fragmentIdentifier:N},S)},n.exclude=(y,w,S)=>{const I=Array.isArray(w)?v=>!w.includes(v):(v,N)=>!w(v,N);return n.pick(y,I,S)}})(hs);function gd(n,t){return n.includes(":")?[n]:t.chains||[]}const yd="base10",ar="base16",Fc="base64pad",Qc="utf8",md=0,Qi=1,bw=0,Dl=1,Uc=12,Yc=32;function ww(){const n=Vf.generateKeyPair();return{privateKey:cr(n.secretKey,ar),publicKey:cr(n.publicKey,ar)}}function jc(){const n=jo.randomBytes(Yc);return cr(n,ar)}function _w(n,t){const r=Vf.sharedKey(mr(n,ar),mr(t,ar),!0),s=new k1(Vc.SHA256,r).expand(Yc);return cr(s,ar)}function Ew(n){const t=Vc.hash(mr(n,ar));return cr(t,ar)}function Sn(n){const t=Vc.hash(mr(n,Qc));return cr(t,ar)}function Iw(n){return mr(`${n}`,yd)}function ds(n){return Number(cr(n,yd))}function Sw(n){const t=Iw(typeof n.type<"u"?n.type:md);if(ds(t)===Qi&&typeof n.senderPublicKey>"u")throw new Error("Missing sender public key for type 1 envelope");const r=typeof n.senderPublicKey<"u"?mr(n.senderPublicKey,ar):void 0,s=typeof n.iv<"u"?mr(n.iv,ar):jo.randomBytes(Uc),a=new Kf.ChaCha20Poly1305(mr(n.symKey,ar)).seal(s,mr(n.message,Qc));return Ow({type:t,sealed:a,iv:s,senderPublicKey:r})}function xw(n){const t=new Kf.ChaCha20Poly1305(mr(n.symKey,ar)),{sealed:r,iv:s}=$o(n.encoded),a=t.open(s,r);if(a===null)throw new Error("Failed to decrypt");return cr(a,Qc)}function Ow(n){if(ds(n.type)===Qi){if(typeof n.senderPublicKey>"u")throw new Error("Missing sender public key for type 1 envelope");return cr(Dc([n.type,n.senderPublicKey,n.iv,n.sealed]),Fc)}return cr(Dc([n.type,n.iv,n.sealed]),Fc)}function $o(n){const t=mr(n,Fc),r=t.slice(bw,Dl),s=Dl;if(ds(r)===Qi){const g=s+Yc,_=g+Uc,T=t.slice(s,g),C=t.slice(g,_),F=t.slice(_);return{type:r,sealed:F,iv:C,senderPublicKey:T}}const a=s+Uc,u=t.slice(s,a),f=t.slice(a);return{type:r,sealed:f,iv:u}}function Pw(n,t){const r=$o(n);return vd({type:ds(r.type),senderPublicKey:typeof r.senderPublicKey<"u"?cr(r.senderPublicKey,ar):void 0,receiverPublicKey:t==null?void 0:t.receiverPublicKey})}function vd(n){const t=(n==null?void 0:n.type)||md;if(t===Qi){if(typeof(n==null?void 0:n.senderPublicKey)>"u")throw new Error("missing sender public key");if(typeof(n==null?void 0:n.receiverPublicKey)>"u")throw new Error("missing receiver public key")}return{type:t,senderPublicKey:n==null?void 0:n.senderPublicKey,receiverPublicKey:n==null?void 0:n.receiverPublicKey}}function Fl(n){return n.type===Qi&&typeof n.senderPublicKey=="string"&&typeof n.receiverPublicKey=="string"}var Tw=Object.defineProperty,Ul=Object.getOwnPropertySymbols,Aw=Object.prototype.hasOwnProperty,Cw=Object.prototype.propertyIsEnumerable,jl=(n,t,r)=>t in n?Tw(n,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):n[t]=r,Ml=(n,t)=>{for(var r in t||(t={}))Aw.call(t,r)&&jl(n,r,t[r]);if(Ul)for(var r of Ul(t))Cw.call(t,r)&&jl(n,r,t[r]);return n};const Rw="ReactNative",Sr={reactNative:"react-native",node:"node",browser:"browser",unknown:"unknown"},Nw="js";function Xc(){return typeof process<"u"&&typeof process.versions<"u"&&typeof process.versions.node<"u"}function zo(){return!fd()&&!!Gc()&&navigator.product===Rw}function ps(){return!Xc()&&!!Gc()}function gs(){return zo()?Sr.reactNative:Xc()?Sr.node:ps()?Sr.browser:Sr.unknown}function $w(n,t){let r=hs.parse(n);return r=Ml(Ml({},r),t),n=hs.stringify(r),n}function Lw(){return pd()||{name:"",description:"",url:"",icons:[""]}}function Dw(){if(gs()===Sr.reactNative&&typeof globalThis<"u"&&typeof(globalThis==null?void 0:globalThis.Platform)<"u"){const{OS:r,Version:s}=globalThis.Platform;return[r,s].join("-")}const n=iw();if(n===null)return"unknown";const t=n.os?n.os.replace(" ","").toLowerCase():"unknown";return n.type==="browser"?[t,n.name,n.version].join("-"):[t,n.version].join("-")}function Fw(){var n;const t=gs();return t===Sr.browser?[t,((n=dd())==null?void 0:n.host)||"unknown"].join(":"):t}function Uw(n,t,r){const s=Dw(),a=Fw();return[[n,t].join("-"),[Nw,r].join("-"),s,a].join("/")}function jw({protocol:n,version:t,relayUrl:r,sdkVersion:s,auth:a,projectId:u,useOnCloseEvent:f}){const g=r.split("?"),_=Uw(n,t,s),T={auth:a,ua:_,projectId:u,useOnCloseEvent:f||void 0},C=$w(g[1]||"",T);return g[0]+"?"+C}function Wi(n,t){return n.filter(r=>t.includes(r)).length===n.length}function bd(n){return Object.fromEntries(n.entries())}function wd(n){return new Map(Object.entries(n))}function En(n=ue.FIVE_MINUTES,t){const r=ue.toMiliseconds(n||ue.FIVE_MINUTES);let s,a,u;return{resolve:f=>{u&&s&&(clearTimeout(u),s(f))},reject:f=>{u&&a&&(clearTimeout(u),a(f))},done:()=>new Promise((f,g)=>{u=setTimeout(()=>{g(new Error(t))},r),s=f,a=g})}}function ls(n,t,r){return new Promise(async(s,a)=>{const u=setTimeout(()=>a(new Error(r)),t);try{const f=await n;s(f)}catch(f){a(f)}clearTimeout(u)})}function _d(n,t){if(typeof t=="string"&&t.startsWith(`${n}:`))return t;if(n.toLowerCase()==="topic"){if(typeof t!="string")throw new Error('Value must be "string" for expirer target type: topic');return`topic:${t}`}else if(n.toLowerCase()==="id"){if(typeof t!="number")throw new Error('Value must be "number" for expirer target type: id');return`id:${t}`}throw new Error(`Unknown expirer target type: ${n}`)}function Mw(n){return _d("topic",n)}function qw(n){return _d("id",n)}function Ed(n){const[t,r]=n.split(":"),s={id:void 0,topic:void 0};if(t==="topic"&&typeof r=="string")s.topic=r;else if(t==="id"&&Number.isInteger(Number(r)))s.id=Number(r);else throw new Error(`Invalid target, expected id:number or topic:string, got ${t}:${r}`);return s}function zr(n,t){return ue.fromMiliseconds((t||Date.now())+ue.toMiliseconds(n))}function Oi(n){return Date.now()>=ue.toMiliseconds(n)}function Ft(n,t){return`${n}${t?`:${t}`:""}`}async function zw({id:n,topic:t,wcDeepLink:r}){try{if(!r)return;const s=typeof r=="string"?JSON.parse(r):r;let a=s==null?void 0:s.href;if(typeof a!="string")return;a.endsWith("/")&&(a=a.slice(0,-1));const u=`${a}/wc?requestId=${n}&sessionTopic=${t}`,f=gs();f===Sr.browser?u.startsWith("https://")?window.open(u,"_blank","noreferrer noopener"):window.open(u,"_self","noreferrer noopener"):f===Sr.reactNative&&typeof(globalThis==null?void 0:globalThis.Linking)<"u"&&await globalThis.Linking.openURL(u)}catch(s){console.error(s)}}const kw="irn";function Mc(n){return(n==null?void 0:n.relay)||{protocol:kw}}function To(n){const t=W1[n];if(typeof t>"u")throw new Error(`Relay Protocol not supported: ${n}`);return t}var Bw=Object.defineProperty,ql=Object.getOwnPropertySymbols,Hw=Object.prototype.hasOwnProperty,Vw=Object.prototype.propertyIsEnumerable,zl=(n,t,r)=>t in n?Bw(n,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):n[t]=r,Kw=(n,t)=>{for(var r in t||(t={}))Hw.call(t,r)&&zl(n,r,t[r]);if(ql)for(var r of ql(t))Vw.call(t,r)&&zl(n,r,t[r]);return n};function Ww(n,t="-"){const r={},s="relay"+t;return Object.keys(n).forEach(a=>{if(a.startsWith(s)){const u=a.replace(s,""),f=n[a];r[u]=f}}),r}function Gw(n){const t=n.indexOf(":"),r=n.indexOf("?")!==-1?n.indexOf("?"):void 0,s=n.substring(0,t),a=n.substring(t+1,r).split("@"),u=typeof r<"u"?n.substring(r):"",f=hs.parse(u);return{protocol:s,topic:Jw(a[0]),version:parseInt(a[1],10),symKey:f.symKey,relay:Ww(f)}}function Jw(n){return n.startsWith("//")?n.substring(2):n}function Qw(n,t="-"){const r="relay",s={};return Object.keys(n).forEach(a=>{const u=r+t+a;n[a]&&(s[u]=n[a])}),s}function Yw(n){return`${n.protocol}:${n.topic}@${n.version}?`+hs.stringify(Kw({symKey:n.symKey},Qw(n.relay)))}function Tn(n){const t=[];return n.forEach(r=>{const[s,a]=r.split(":");t.push(`${s}:${a}`)}),t}function Xw(n){const t=[];return Object.values(n).forEach(r=>{t.push(...Tn(r.accounts))}),t}function Zw(n,t){const r=[];return Object.values(n).forEach(s=>{Tn(s.accounts).includes(t)&&r.push(...s.methods)}),r}function e_(n,t){const r=[];return Object.values(n).forEach(s=>{Tn(s.accounts).includes(t)&&r.push(...s.events)}),r}function t_(n,t){const r=Ao(n,t);if(r)throw new Error(r.message);const s={};for(const[a,u]of Object.entries(n))s[a]={methods:u.methods,events:u.events,chains:u.accounts.map(f=>`${f.split(":")[0]}:${f.split(":")[1]}`)};return s}const r_={INVALID_METHOD:{message:"Invalid method.",code:1001},INVALID_EVENT:{message:"Invalid event.",code:1002},INVALID_UPDATE_REQUEST:{message:"Invalid update request.",code:1003},INVALID_EXTEND_REQUEST:{message:"Invalid extend request.",code:1004},INVALID_SESSION_SETTLE_REQUEST:{message:"Invalid session settle request.",code:1005},UNAUTHORIZED_METHOD:{message:"Unauthorized method.",code:3001},UNAUTHORIZED_EVENT:{message:"Unauthorized event.",code:3002},UNAUTHORIZED_UPDATE_REQUEST:{message:"Unauthorized update request.",code:3003},UNAUTHORIZED_EXTEND_REQUEST:{message:"Unauthorized extend request.",code:3004},USER_REJECTED:{message:"User rejected.",code:5e3},USER_REJECTED_CHAINS:{message:"User rejected chains.",code:5001},USER_REJECTED_METHODS:{message:"User rejected methods.",code:5002},USER_REJECTED_EVENTS:{message:"User rejected events.",code:5003},UNSUPPORTED_CHAINS:{message:"Unsupported chains.",code:5100},UNSUPPORTED_METHODS:{message:"Unsupported methods.",code:5101},UNSUPPORTED_EVENTS:{message:"Unsupported events.",code:5102},UNSUPPORTED_ACCOUNTS:{message:"Unsupported accounts.",code:5103},UNSUPPORTED_NAMESPACE_KEY:{message:"Unsupported namespace key.",code:5104},USER_DISCONNECTED:{message:"User disconnected.",code:6e3},SESSION_SETTLEMENT_FAILED:{message:"Session settlement failed.",code:7e3},WC_METHOD_UNSUPPORTED:{message:"Unsupported wc_ method.",code:10001}},i_={NOT_INITIALIZED:{message:"Not initialized.",code:1},NO_MATCHING_KEY:{message:"No matching key.",code:2},RESTORE_WILL_OVERRIDE:{message:"Restore will override.",code:3},RESUBSCRIBED:{message:"Resubscribed.",code:4},MISSING_OR_INVALID:{message:"Missing or invalid.",code:5},EXPIRED:{message:"Expired.",code:6},UNKNOWN_TYPE:{message:"Unknown type.",code:7},MISMATCHED_TOPIC:{message:"Mismatched topic.",code:8},NON_CONFORMING_NAMESPACES:{message:"Non conforming namespaces.",code:9}};function re(n,t){const{message:r,code:s}=i_[n];return{message:t?`${r} ${t}`:r,code:s}}function Bt(n,t){const{message:r,code:s}=r_[n];return{message:t?`${r} ${t}`:r,code:s}}function ys(n,t){return Array.isArray(n)?typeof t<"u"&&n.length?n.every(t):!0:!1}function cs(n){return Object.getPrototypeOf(n)===Object.prototype&&Object.keys(n).length}function or(n){return typeof n>"u"}function Ht(n,t){return t&&or(n)?!0:typeof n=="string"&&!!n.trim().length}function Zc(n,t){return t&&or(n)?!0:typeof n=="number"&&!isNaN(n)}function n_(n,t){const{requiredNamespaces:r}=t,s=Object.keys(n.namespaces),a=Object.keys(r);let u=!0;return Wi(a,s)?(s.forEach(f=>{const{accounts:g,methods:_,events:T}=n.namespaces[f],C=Tn(g),F=r[f];(!Wi(gd(f,F),C)||!Wi(F.methods,_)||!Wi(F.events,T))&&(u=!1)}),u):!1}function Lo(n){return Ht(n,!1)&&n.includes(":")?n.split(":").length===2:!1}function s_(n){if(Ht(n,!1)&&n.includes(":")){const t=n.split(":");if(t.length===3){const r=t[0]+":"+t[1];return!!t[2]&&Lo(r)}}return!1}function o_(n){if(Ht(n,!1))try{return typeof new URL(n)<"u"}catch{return!1}return!1}function a_(n){var t;return(t=n==null?void 0:n.proposer)==null?void 0:t.publicKey}function c_(n){return n==null?void 0:n.topic}function u_(n,t){let r=null;return Ht(n==null?void 0:n.publicKey,!1)||(r=re("MISSING_OR_INVALID",`${t} controller public key should be a string`)),r}function kl(n){let t=!0;return ys(n)?n.length&&(t=n.every(r=>Ht(r,!1))):t=!1,t}function h_(n,t,r){let s=null;return ys(t)&&t.length?t.forEach(a=>{s||Lo(a)||(s=Bt("UNSUPPORTED_CHAINS",`${r}, chain ${a} should be a string and conform to "namespace:chainId" format`))}):Lo(n)||(s=Bt("UNSUPPORTED_CHAINS",`${r}, chains must be defined as "namespace:chainId" e.g. "eip155:1": {...} in the namespace key OR as an array of CAIP-2 chainIds e.g. eip155: { chains: ["eip155:1", "eip155:5"] }`)),s}function l_(n,t,r){let s=null;return Object.entries(n).forEach(([a,u])=>{if(s)return;const f=h_(a,gd(a,u),`${t} ${r}`);f&&(s=f)}),s}function f_(n,t){let r=null;return ys(n)?n.forEach(s=>{r||s_(s)||(r=Bt("UNSUPPORTED_ACCOUNTS",`${t}, account ${s} should be a string and conform to "namespace:chainId:address" format`))}):r=Bt("UNSUPPORTED_ACCOUNTS",`${t}, accounts should be an array of strings conforming to "namespace:chainId:address" format`),r}function d_(n,t){let r=null;return Object.values(n).forEach(s=>{if(r)return;const a=f_(s==null?void 0:s.accounts,`${t} namespace`);a&&(r=a)}),r}function p_(n,t){let r=null;return kl(n==null?void 0:n.methods)?kl(n==null?void 0:n.events)||(r=Bt("UNSUPPORTED_EVENTS",`${t}, events should be an array of strings or empty array for no events`)):r=Bt("UNSUPPORTED_METHODS",`${t}, methods should be an array of strings or empty array for no methods`),r}function Id(n,t){let r=null;return Object.values(n).forEach(s=>{if(r)return;const a=p_(s,`${t}, namespace`);a&&(r=a)}),r}function g_(n,t,r){let s=null;if(n&&cs(n)){const a=Id(n,t);a&&(s=a);const u=l_(n,t,r);u&&(s=u)}else s=re("MISSING_OR_INVALID",`${t}, ${r} should be an object with data`);return s}function Ao(n,t){let r=null;if(n&&cs(n)){const s=Id(n,t);s&&(r=s);const a=d_(n,t);a&&(r=a)}else r=re("MISSING_OR_INVALID",`${t}, namespaces should be an object with data`);return r}function Sd(n){return Ht(n.protocol,!0)}function y_(n,t){let r=!1;return t&&!n?r=!0:n&&ys(n)&&n.length&&n.forEach(s=>{r=Sd(s)}),r}function m_(n){return typeof n=="number"}function yr(n){return typeof n<"u"&&typeof n!==null}function v_(n){return!(!n||typeof n!="object"||!n.code||!Zc(n.code,!1)||!n.message||!Ht(n.message,!1))}function b_(n){return!(or(n)||!Ht(n.method,!1))}function w_(n){return!(or(n)||or(n.result)&&or(n.error)||!Zc(n.id,!1)||!Ht(n.jsonrpc,!1))}function __(n){return!(or(n)||!Ht(n.name,!1))}function Bl(n,t){return!(!Lo(t)||!Xw(n).includes(t))}function E_(n,t,r){return Ht(r,!1)?Zw(n,t).includes(r):!1}function I_(n,t,r){return Ht(r,!1)?e_(n,t).includes(r):!1}function Hl(n,t,r){let s=null;const a=S_(n),u=x_(t),f=Object.keys(a),g=Object.keys(u),_=Vl(Object.keys(n)),T=Vl(Object.keys(t)),C=_.filter(F=>!T.includes(F));return C.length&&(s=re("NON_CONFORMING_NAMESPACES",`${r} namespaces keys don't satisfy requiredNamespaces.
      Required: ${C.toString()}
      Received: ${Object.keys(t).toString()}`)),Wi(f,g)||(s=re("NON_CONFORMING_NAMESPACES",`${r} namespaces chains don't satisfy required namespaces.
      Required: ${f.toString()}
      Approved: ${g.toString()}`)),Object.keys(t).forEach(F=>{if(!F.includes(":")||s)return;const V=Tn(t[F].accounts);V.includes(F)||(s=re("NON_CONFORMING_NAMESPACES",`${r} namespaces accounts don't satisfy namespace accounts for ${F}
        Required: ${F}
        Approved: ${V.toString()}`))}),f.forEach(F=>{s||(Wi(a[F].methods,u[F].methods)?Wi(a[F].events,u[F].events)||(s=re("NON_CONFORMING_NAMESPACES",`${r} namespaces events don't satisfy namespace events for ${F}`)):s=re("NON_CONFORMING_NAMESPACES",`${r} namespaces methods don't satisfy namespace methods for ${F}`))}),s}function S_(n){const t={};return Object.keys(n).forEach(r=>{var s;r.includes(":")?t[r]=n[r]:(s=n[r].chains)==null||s.forEach(a=>{t[a]={methods:n[r].methods,events:n[r].events}})}),t}function Vl(n){return[...new Set(n.map(t=>t.includes(":")?t.split(":")[0]:t))]}function x_(n){const t={};return Object.keys(n).forEach(r=>{if(r.includes(":"))t[r]=n[r];else{const s=Tn(n[r].accounts);s==null||s.forEach(a=>{t[a]={accounts:n[r].accounts.filter(u=>u.includes(`${a}:`)),methods:n[r].methods,events:n[r].events}})}}),t}function O_(n,t){return Zc(n,!1)&&n<=t.max&&n>=t.min}function Kl(){const n=gs();return new Promise(t=>{switch(n){case Sr.browser:t(P_());break;case Sr.reactNative:t(T_());break;case Sr.node:t(A_());break;default:t(!0)}})}function P_(){return ps()&&(navigator==null?void 0:navigator.onLine)}async function T_(){if(zo()&&typeof globalThis<"u"&&globalThis!=null&&globalThis.NetInfo){const n=await(globalThis==null?void 0:globalThis.NetInfo.fetch());return n==null?void 0:n.isConnected}return!0}function A_(){return!0}function C_(n){switch(gs()){case Sr.browser:R_(n);break;case Sr.reactNative:N_(n);break}}function R_(n){ps()&&(window.addEventListener("online",()=>n(!0)),window.addEventListener("offline",()=>n(!1)))}function N_(n){zo()&&typeof globalThis<"u"&&globalThis!=null&&globalThis.NetInfo&&(globalThis==null||globalThis.NetInfo.addEventListener(t=>n(t==null?void 0:t.isConnected)))}const Ic={};let Io=class{static get(t){return Ic[t]}static set(t,r){Ic[t]=r}static delete(t){delete Ic[t]}};const $_="PARSE_ERROR",L_="INVALID_REQUEST",D_="METHOD_NOT_FOUND",F_="INVALID_PARAMS",xd="INTERNAL_ERROR",eu="SERVER_ERROR",U_=[-32700,-32600,-32601,-32602,-32603],us={[$_]:{code:-32700,message:"Parse error"},[L_]:{code:-32600,message:"Invalid Request"},[D_]:{code:-32601,message:"Method not found"},[F_]:{code:-32602,message:"Invalid params"},[xd]:{code:-32603,message:"Internal error"},[eu]:{code:-32e3,message:"Server error"}},Od=eu;function j_(n){return U_.includes(n)}function Wl(n){return Object.keys(us).includes(n)?us[n]:us[Od]}function M_(n){const t=Object.values(us).find(r=>r.code===n);return t||us[Od]}function Pd(n,t,r){return n.message.includes("getaddrinfo ENOTFOUND")||n.message.includes("connect ECONNREFUSED")?new Error(`Unavailable ${r} RPC url at ${t}`):n}var Td={},hi={},Gl;function q_(){if(Gl)return hi;Gl=1,Object.defineProperty(hi,"__esModule",{value:!0}),hi.isBrowserCryptoAvailable=hi.getSubtleCrypto=hi.getBrowerCrypto=void 0;function n(){return(globalThis==null?void 0:globalThis.crypto)||(globalThis==null?void 0:globalThis.msCrypto)||{}}hi.getBrowerCrypto=n;function t(){const s=n();return s.subtle||s.webkitSubtle}hi.getSubtleCrypto=t;function r(){return!!n()&&!!t()}return hi.isBrowserCryptoAvailable=r,hi}var li={},Jl;function z_(){if(Jl)return li;Jl=1,Object.defineProperty(li,"__esModule",{value:!0}),li.isBrowser=li.isNode=li.isReactNative=void 0;function n(){return typeof document>"u"&&typeof navigator<"u"&&navigator.product==="ReactNative"}li.isReactNative=n;function t(){return typeof process<"u"&&typeof process.versions<"u"&&typeof process.versions.node<"u"}li.isNode=t;function r(){return!n()&&!t()}return li.isBrowser=r,li}(function(n){Object.defineProperty(n,"__esModule",{value:!0});const t=Ti;t.__exportStar(q_(),n),t.__exportStar(z_(),n)})(Td);function tu(n=3){const t=Date.now()*Math.pow(10,n),r=Math.floor(Math.random()*Math.pow(10,n));return t+r}function Ad(n=6){return BigInt(tu(n))}function xn(n,t,r){return{id:r||tu(),jsonrpc:"2.0",method:n,params:t}}function ru(n,t){return{id:n,jsonrpc:"2.0",result:t}}function ko(n,t,r){return{id:n,jsonrpc:"2.0",error:k_(t,r)}}function k_(n,t){return typeof n>"u"?Wl(xd):(typeof n=="string"&&(n=Object.assign(Object.assign({},Wl(eu)),{message:n})),typeof t<"u"&&(n.data=t),j_(n.code)&&(n=M_(n.code)),n)}class B_{}class H_ extends B_{constructor(){super()}}class V_ extends H_{constructor(t){super()}}const K_="^https?:",W_="^wss?:";function G_(n){const t=n.match(new RegExp(/^\w+:/,"gi"));if(!(!t||!t.length))return t[0]}function Cd(n,t){const r=G_(n);return typeof r>"u"?!1:new RegExp(t).test(r)}function Ql(n){return Cd(n,K_)}function Yl(n){return Cd(n,W_)}function J_(n){return new RegExp("wss?://localhost(:d{2,5})?").test(n)}function Rd(n){return typeof n=="object"&&"id"in n&&"jsonrpc"in n&&n.jsonrpc==="2.0"}function iu(n){return Rd(n)&&"method"in n}function Bo(n){return Rd(n)&&(pi(n)||kr(n))}function pi(n){return"result"in n}function kr(n){return"error"in n}class Ai extends V_{constructor(t){super(t),this.events=new Vt.EventEmitter,this.hasRegisteredEventListeners=!1,this.connection=this.setConnection(t),this.connection.connected&&this.registerEventListeners()}async connect(t=this.connection){await this.open(t)}async disconnect(){await this.close()}on(t,r){this.events.on(t,r)}once(t,r){this.events.once(t,r)}off(t,r){this.events.off(t,r)}removeListener(t,r){this.events.removeListener(t,r)}async request(t,r){return this.requestStrict(xn(t.method,t.params||[],t.id||Ad().toString()),r)}async requestStrict(t,r){return new Promise(async(s,a)=>{if(!this.connection.connected)try{await this.open()}catch(u){a(u)}this.events.on(`${t.id}`,u=>{kr(u)?a(u.error):s(u.result)});try{await this.connection.send(t,r)}catch(u){a(u)}})}setConnection(t=this.connection){return t}onPayload(t){this.events.emit("payload",t),Bo(t)?this.events.emit(`${t.id}`,t):this.events.emit("message",{type:t.method,data:t.params})}onClose(t){t&&t.code===3e3&&this.events.emit("error",new Error(`WebSocket connection closed abnormally with code: ${t.code} ${t.reason?`(${t.reason})`:""}`)),this.events.emit("disconnect")}async open(t=this.connection){this.connection===t&&this.connection.connected||(this.connection.connected&&this.close(),typeof t=="string"&&(await this.connection.open(t),t=this.connection),this.connection=this.setConnection(t),await this.connection.open(),this.registerEventListeners(),this.events.emit("connect"))}async close(){await this.connection.close()}registerEventListeners(){this.hasRegisteredEventListeners||(this.connection.on("payload",t=>this.onPayload(t)),this.connection.on("close",t=>this.onClose(t)),this.connection.on("error",t=>this.events.emit("error",t)),this.connection.on("register_error",t=>this.onClose()),this.hasRegisteredEventListeners=!0)}}const Q_=n=>JSON.stringify(n,(t,r)=>typeof r=="bigint"?r.toString()+"n":r),Y_=n=>{const t=/([\[:])?(\d{17,}|(?:[9](?:[1-9]07199254740991|0[1-9]7199254740991|00[8-9]199254740991|007[2-9]99254740991|007199[3-9]54740991|0071992[6-9]4740991|00719925[5-9]740991|007199254[8-9]40991|0071992547[5-9]0991|00719925474[1-9]991|00719925474099[2-9])))([,\}\]])/g,r=n.replace(t,'$1"$2n"$3');return JSON.parse(r,(s,a)=>typeof a=="string"&&a.match(/^\d+n$/)?BigInt(a.substring(0,a.length-1)):a)};function X_(n){if(typeof n!="string")throw new Error(`Cannot safe json parse value of type ${typeof n}`);try{return Y_(n)}catch{return n}}function Z_(n){return typeof n=="string"?n:Q_(n)||""}const eE=()=>typeof WebSocket<"u"?WebSocket:typeof globalThis<"u"&&typeof globalThis.WebSocket<"u"?globalThis.WebSocket:typeof window<"u"&&typeof window.WebSocket<"u"?window.WebSocket:typeof self<"u"&&typeof self.WebSocket<"u"?self.WebSocket:require("ws"),tE=()=>typeof WebSocket<"u"||typeof globalThis<"u"&&typeof globalThis.WebSocket<"u"||typeof window<"u"&&typeof window.WebSocket<"u"||typeof self<"u"&&typeof self.WebSocket<"u",Xl=n=>n.split("?")[0],Zl=10,rE=eE();class iE{constructor(t){if(this.url=t,this.events=new Vt.EventEmitter,this.registering=!1,!Yl(t))throw new Error(`Provided URL is not compatible with WebSocket connection: ${t}`);this.url=t}get connected(){return typeof this.socket<"u"}get connecting(){return this.registering}on(t,r){this.events.on(t,r)}once(t,r){this.events.once(t,r)}off(t,r){this.events.off(t,r)}removeListener(t,r){this.events.removeListener(t,r)}async open(t=this.url){await this.register(t)}async close(){return new Promise((t,r)=>{if(typeof this.socket>"u"){r(new Error("Connection already closed"));return}this.socket.onclose=s=>{this.onClose(s),t()},this.socket.close()})}async send(t,r){typeof this.socket>"u"&&(this.socket=await this.register());try{this.socket.send(Z_(t))}catch(s){this.onError(t.id,s)}}register(t=this.url){if(!Yl(t))throw new Error(`Provided URL is not compatible with WebSocket connection: ${t}`);if(this.registering){const r=this.events.getMaxListeners();return(this.events.listenerCount("register_error")>=r||this.events.listenerCount("open")>=r)&&this.events.setMaxListeners(r+1),new Promise((s,a)=>{this.events.once("register_error",u=>{this.resetMaxListeners(),a(u)}),this.events.once("open",()=>{if(this.resetMaxListeners(),typeof this.socket>"u")return a(new Error("WebSocket connection is missing or invalid"));s(this.socket)})})}return this.url=t,this.registering=!0,new Promise((r,s)=>{const a=Td.isReactNative()?void 0:{rejectUnauthorized:!J_(t)},u=new rE(t,[],a);tE()?u.onerror=f=>{const g=f;s(this.emitError(g.error))}:u.on("error",f=>{s(this.emitError(f))}),u.onopen=()=>{this.onOpen(u),r(u)}})}onOpen(t){t.onmessage=r=>this.onPayload(r),t.onclose=r=>this.onClose(r),this.socket=t,this.registering=!1,this.events.emit("open")}onClose(t){this.socket=void 0,this.registering=!1,this.events.emit("close",t)}onPayload(t){if(typeof t.data>"u")return;const r=typeof t.data=="string"?X_(t.data):t.data;this.events.emit("payload",r)}onError(t,r){const s=this.parseError(r),a=s.message||s.toString(),u=ko(t,a);this.events.emit("payload",u)}parseError(t,r=this.url){return Pd(t,Xl(r),"WS")}resetMaxListeners(){this.events.getMaxListeners()>Zl&&this.events.setMaxListeners(Zl)}emitError(t){const r=this.parseError(new Error((t==null?void 0:t.message)||`WebSocket connection failed for host: ${Xl(this.url)}`));return this.events.emit("register_error",r),r}}var Do={},nE={get exports(){return Do},set exports(n){Do=n}};(function(n,t){var r=200,s="__lodash_hash_undefined__",a=1,u=2,f=9007199254740991,g="[object Arguments]",_="[object Array]",T="[object AsyncFunction]",C="[object Boolean]",F="[object Date]",V="[object Error]",k="[object Function]",W="[object GeneratorFunction]",Y="[object Map]",X="[object Number]",he="[object Null]",y="[object Object]",w="[object Promise]",S="[object Proxy]",I="[object RegExp]",v="[object Set]",N="[object String]",L="[object Symbol]",ie="[object Undefined]",ne="[object WeakMap]",Ie="[object ArrayBuffer]",Pe="[object DataView]",D="[object Float32Array]",E="[object Float64Array]",U="[object Int8Array]",ye="[object Int16Array]",fe="[object Int32Array]",Q="[object Uint8Array]",Z="[object Uint8ClampedArray]",J="[object Uint16Array]",ee="[object Uint32Array]",lt=/[\\^$.*+?()[\]{}|]/g,He=/^\[object .+?Constructor\]$/,Br=/^(?:0|[1-9]\d*)$/,Se={};Se[D]=Se[E]=Se[U]=Se[ye]=Se[fe]=Se[Q]=Se[Z]=Se[J]=Se[ee]=!0,Se[g]=Se[_]=Se[Ie]=Se[C]=Se[Pe]=Se[F]=Se[V]=Se[k]=Se[Y]=Se[X]=Se[y]=Se[I]=Se[v]=Se[N]=Se[ne]=!1;var Ot=typeof globalThis=="object"&&globalThis&&globalThis.Object===Object&&globalThis,q=typeof self=="object"&&self&&self.Object===Object&&self,M=Ot||q||Function("return this")(),$=t&&!t.nodeType&&t,h=$&&!0&&n&&!n.nodeType&&n,O=h&&h.exports===$,ae=O&&Ot.process,ge=function(){try{return ae&&ae.binding&&ae.binding("util")}catch{}}(),_e=ge&&ge.isTypedArray;function $e(m,P){for(var K=-1,se=m==null?0:m.length,We=0,ve=[];++K<se;){var rt=m[K];P(rt,K,m)&&(ve[We++]=rt)}return ve}function De(m,P){for(var K=-1,se=P.length,We=m.length;++K<se;)m[We+K]=P[K];return m}function Te(m,P){for(var K=-1,se=m==null?0:m.length;++K<se;)if(P(m[K],K,m))return!0;return!1}function Pt(m,P){for(var K=-1,se=Array(m);++K<m;)se[K]=P(K);return se}function wt(m){return function(P){return m(P)}}function at(m,P){return m.has(P)}function Ue(m,P){return m==null?void 0:m[P]}function Ze(m){var P=-1,K=Array(m.size);return m.forEach(function(se,We){K[++P]=[We,se]}),K}function et(m,P){return function(K){return m(P(K))}}function ct(m){var P=-1,K=Array(m.size);return m.forEach(function(se){K[++P]=se}),K}var ze=Array.prototype,tt=Function.prototype,Le=Object.prototype,Ve=M["__core-js_shared__"],ft=tt.toString,Me=Le.hasOwnProperty,Tt=function(){var m=/[^.]+$/.exec(Ve&&Ve.keys&&Ve.keys.IE_PROTO||"");return m?"Symbol(src)_1."+m:""}(),Ut=Le.toString,Kt=RegExp("^"+ft.call(Me).replace(lt,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),Wt=O?M.Buffer:void 0,qt=M.Symbol,Zt=M.Uint8Array,ur=Le.propertyIsEnumerable,Hr=ze.splice,er=qt?qt.toStringTag:void 0,Xr=Object.getOwnPropertySymbols,gi=Wt?Wt.isBuffer:void 0,Ri=et(Object.keys,Object),dt=vr(M,"DataView"),nt=vr(M,"Map"),pt=vr(M,"Promise"),gt=vr(M,"Set"),ut=vr(M,"WeakMap"),st=vr(Object,"create"),At=ei(dt),Ct=ei(nt),yt=ei(pt),Rt=ei(gt),mt=ei(ut),_t=qt?qt.prototype:void 0,vt=_t?_t.valueOf:void 0;function Qe(m){var P=-1,K=m==null?0:m.length;for(this.clear();++P<K;){var se=m[P];this.set(se[0],se[1])}}function Nt(){this.__data__=st?st(null):{},this.size=0}function $t(m){var P=this.has(m)&&delete this.__data__[m];return this.size-=P?1:0,P}function Ko(m){var P=this.__data__;if(st){var K=P[m];return K===s?void 0:K}return Me.call(P,m)?P[m]:void 0}function Wo(m){var P=this.__data__;return st?P[m]!==void 0:Me.call(P,m)}function Go(m,P){var K=this.__data__;return this.size+=this.has(m)?0:1,K[m]=st&&P===void 0?s:P,this}Qe.prototype.clear=Nt,Qe.prototype.delete=$t,Qe.prototype.get=Ko,Qe.prototype.has=Wo,Qe.prototype.set=Go;function xr(m){var P=-1,K=m==null?0:m.length;for(this.clear();++P<K;){var se=m[P];this.set(se[0],se[1])}}function Jo(){this.__data__=[],this.size=0}function Qo(m){var P=this.__data__,K=Ni(P,m);if(K<0)return!1;var se=P.length-1;return K==se?P.pop():Hr.call(P,K,1),--this.size,!0}function Yo(m){var P=this.__data__,K=Ni(P,m);return K<0?void 0:P[K][1]}function Xo(m){return Ni(this.__data__,m)>-1}function Zo(m,P){var K=this.__data__,se=Ni(K,m);return se<0?(++this.size,K.push([m,P])):K[se][1]=P,this}xr.prototype.clear=Jo,xr.prototype.delete=Qo,xr.prototype.get=Yo,xr.prototype.has=Xo,xr.prototype.set=Zo;function Zr(m){var P=-1,K=m==null?0:m.length;for(this.clear();++P<K;){var se=m[P];this.set(se[0],se[1])}}function en(){this.size=0,this.__data__={hash:new Qe,map:new(nt||xr),string:new Qe}}function ea(m){var P=yi(this,m).delete(m);return this.size-=P?1:0,P}function tn(m){return yi(this,m).get(m)}function ta(m){return yi(this,m).has(m)}function ra(m,P){var K=yi(this,m),se=K.size;return K.set(m,P),this.size+=K.size==se?0:1,this}Zr.prototype.clear=en,Zr.prototype.delete=ea,Zr.prototype.get=tn,Zr.prototype.has=ta,Zr.prototype.set=ra;function rn(m){var P=-1,K=m==null?0:m.length;for(this.__data__=new Zr;++P<K;)this.add(m[P])}function vs(m){return this.__data__.set(m,s),this}function bs(m){return this.__data__.has(m)}rn.prototype.add=rn.prototype.push=vs,rn.prototype.has=bs;function Dr(m){var P=this.__data__=new xr(m);this.size=P.size}function ia(){this.__data__=new xr,this.size=0}function na(m){var P=this.__data__,K=P.delete(m);return this.size=P.size,K}function sa(m){return this.__data__.get(m)}function oa(m){return this.__data__.has(m)}function ws(m,P){var K=this.__data__;if(K instanceof xr){var se=K.__data__;if(!nt||se.length<r-1)return se.push([m,P]),this.size=++K.size,this;K=this.__data__=new Zr(se)}return K.set(m,P),this.size=K.size,this}Dr.prototype.clear=ia,Dr.prototype.delete=na,Dr.prototype.get=sa,Dr.prototype.has=oa,Dr.prototype.set=ws;function _s(m,P){var K=on(m),se=!K&&$s(m),We=!K&&!se&&$n(m),ve=!K&&!se&&!We&&Fs(m),rt=K||se||We||ve,Lt=rt?Pt(m.length,String):[],Ce=Lt.length;for(var Ge in m)(P||Me.call(m,Ge))&&!(rt&&(Ge=="length"||We&&(Ge=="offset"||Ge=="parent")||ve&&(Ge=="buffer"||Ge=="byteLength"||Ge=="byteOffset")||Ts(Ge,Ce)))&&Lt.push(Ge);return Lt}function Ni(m,P){for(var K=m.length;K--;)if(Ns(m[K][0],P))return K;return-1}function Rn(m,P,K){var se=P(m);return on(m)?se:De(se,K(m))}function $i(m){return m==null?m===void 0?ie:he:er&&er in Object(m)?Os(m):ua(m)}function Nn(m){return Di(m)&&$i(m)==g}function Li(m,P,K,se,We){return m===P?!0:m==null||P==null||!Di(m)&&!Di(P)?m!==m&&P!==P:Es(m,P,K,se,Li,We)}function Es(m,P,K,se,We,ve){var rt=on(m),Lt=on(P),Ce=rt?_:Vr(m),Ge=Lt?_:Vr(P);Ce=Ce==g?y:Ce,Ge=Ge==g?y:Ge;var Et=Ce==y,hr=Ge==y,Dt=Ce==Ge;if(Dt&&$n(m)){if(!$n(P))return!1;rt=!0,Et=!1}if(Dt&&!Et)return ve||(ve=new Dr),rt||Fs(m)?nn(m,P,K,se,We,ve):ca(m,P,Ce,K,se,We,ve);if(!(K&a)){var it=Et&&Me.call(m,"__wrapped__"),tr=hr&&Me.call(P,"__wrapped__");if(it||tr){var Fr=it?m.value():m,Or=tr?P.value():P;return ve||(ve=new Dr),We(Fr,Or,K,se,ve)}}return Dt?(ve||(ve=new Dr),xs(m,P,K,se,We,ve)):!1}function aa(m){if(!Ds(m)||Cs(m))return!1;var P=an(m)?Kt:He;return P.test(ei(m))}function Is(m){return Di(m)&&Ls(m.length)&&!!Se[$i(m)]}function Ss(m){if(!Rs(m))return Ri(m);var P=[];for(var K in Object(m))Me.call(m,K)&&K!="constructor"&&P.push(K);return P}function nn(m,P,K,se,We,ve){var rt=K&a,Lt=m.length,Ce=P.length;if(Lt!=Ce&&!(rt&&Ce>Lt))return!1;var Ge=ve.get(m);if(Ge&&ve.get(P))return Ge==P;var Et=-1,hr=!0,Dt=K&u?new rn:void 0;for(ve.set(m,P),ve.set(P,m);++Et<Lt;){var it=m[Et],tr=P[Et];if(se)var Fr=rt?se(tr,it,Et,P,m,ve):se(it,tr,Et,m,P,ve);if(Fr!==void 0){if(Fr)continue;hr=!1;break}if(Dt){if(!Te(P,function(Or,Kr){if(!at(Dt,Kr)&&(it===Or||We(it,Or,K,se,ve)))return Dt.push(Kr)})){hr=!1;break}}else if(!(it===tr||We(it,tr,K,se,ve))){hr=!1;break}}return ve.delete(m),ve.delete(P),hr}function ca(m,P,K,se,We,ve,rt){switch(K){case Pe:if(m.byteLength!=P.byteLength||m.byteOffset!=P.byteOffset)return!1;m=m.buffer,P=P.buffer;case Ie:return!(m.byteLength!=P.byteLength||!ve(new Zt(m),new Zt(P)));case C:case F:case X:return Ns(+m,+P);case V:return m.name==P.name&&m.message==P.message;case I:case N:return m==P+"";case Y:var Lt=Ze;case v:var Ce=se&a;if(Lt||(Lt=ct),m.size!=P.size&&!Ce)return!1;var Ge=rt.get(m);if(Ge)return Ge==P;se|=u,rt.set(m,P);var Et=nn(Lt(m),Lt(P),se,We,ve,rt);return rt.delete(m),Et;case L:if(vt)return vt.call(m)==vt.call(P)}return!1}function xs(m,P,K,se,We,ve){var rt=K&a,Lt=sn(m),Ce=Lt.length,Ge=sn(P),Et=Ge.length;if(Ce!=Et&&!rt)return!1;for(var hr=Ce;hr--;){var Dt=Lt[hr];if(!(rt?Dt in P:Me.call(P,Dt)))return!1}var it=ve.get(m);if(it&&ve.get(P))return it==P;var tr=!0;ve.set(m,P),ve.set(P,m);for(var Fr=rt;++hr<Ce;){Dt=Lt[hr];var Or=m[Dt],Kr=P[Dt];if(se)var Ln=rt?se(Kr,Or,Dt,P,m,ve):se(Or,Kr,Dt,m,P,ve);if(!(Ln===void 0?Or===Kr||We(Or,Kr,K,se,ve):Ln)){tr=!1;break}Fr||(Fr=Dt=="constructor")}if(tr&&!Fr){var Fi=m.constructor,zt=P.constructor;Fi!=zt&&"constructor"in m&&"constructor"in P&&!(typeof Fi=="function"&&Fi instanceof Fi&&typeof zt=="function"&&zt instanceof zt)&&(tr=!1)}return ve.delete(m),ve.delete(P),tr}function sn(m){return Rn(m,fa,Ps)}function yi(m,P){var K=m.__data__;return As(P)?K[typeof P=="string"?"string":"hash"]:K.map}function vr(m,P){var K=Ue(m,P);return aa(K)?K:void 0}function Os(m){var P=Me.call(m,er),K=m[er];try{m[er]=void 0;var se=!0}catch{}var We=Ut.call(m);return se&&(P?m[er]=K:delete m[er]),We}var Ps=Xr?function(m){return m==null?[]:(m=Object(m),$e(Xr(m),function(P){return ur.call(m,P)}))}:Ke,Vr=$i;(dt&&Vr(new dt(new ArrayBuffer(1)))!=Pe||nt&&Vr(new nt)!=Y||pt&&Vr(pt.resolve())!=w||gt&&Vr(new gt)!=v||ut&&Vr(new ut)!=ne)&&(Vr=function(m){var P=$i(m),K=P==y?m.constructor:void 0,se=K?ei(K):"";if(se)switch(se){case At:return Pe;case Ct:return Y;case yt:return w;case Rt:return v;case mt:return ne}return P});function Ts(m,P){return P=P??f,!!P&&(typeof m=="number"||Br.test(m))&&m>-1&&m%1==0&&m<P}function As(m){var P=typeof m;return P=="string"||P=="number"||P=="symbol"||P=="boolean"?m!=="__proto__":m===null}function Cs(m){return!!Tt&&Tt in m}function Rs(m){var P=m&&m.constructor,K=typeof P=="function"&&P.prototype||Le;return m===K}function ua(m){return Ut.call(m)}function ei(m){if(m!=null){try{return ft.call(m)}catch{}try{return m+""}catch{}}return""}function Ns(m,P){return m===P||m!==m&&P!==P}var $s=Nn(function(){return arguments}())?Nn:function(m){return Di(m)&&Me.call(m,"callee")&&!ur.call(m,"callee")},on=Array.isArray;function ha(m){return m!=null&&Ls(m.length)&&!an(m)}var $n=gi||ke;function la(m,P){return Li(m,P)}function an(m){if(!Ds(m))return!1;var P=$i(m);return P==k||P==W||P==T||P==S}function Ls(m){return typeof m=="number"&&m>-1&&m%1==0&&m<=f}function Ds(m){var P=typeof m;return m!=null&&(P=="object"||P=="function")}function Di(m){return m!=null&&typeof m=="object"}var Fs=_e?wt(_e):Is;function fa(m){return ha(m)?_s(m):Ss(m)}function Ke(){return[]}function ke(){return!1}n.exports=la})(nE,Do);function sE(n,t){if(n.length>=255)throw new TypeError("Alphabet too long");for(var r=new Uint8Array(256),s=0;s<r.length;s++)r[s]=255;for(var a=0;a<n.length;a++){var u=n.charAt(a),f=u.charCodeAt(0);if(r[f]!==255)throw new TypeError(u+" is ambiguous");r[f]=a}var g=n.length,_=n.charAt(0),T=Math.log(g)/Math.log(256),C=Math.log(256)/Math.log(g);function F(W){if(W instanceof Uint8Array||(ArrayBuffer.isView(W)?W=new Uint8Array(W.buffer,W.byteOffset,W.byteLength):Array.isArray(W)&&(W=Uint8Array.from(W))),!(W instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(W.length===0)return"";for(var Y=0,X=0,he=0,y=W.length;he!==y&&W[he]===0;)he++,Y++;for(var w=(y-he)*C+1>>>0,S=new Uint8Array(w);he!==y;){for(var I=W[he],v=0,N=w-1;(I!==0||v<X)&&N!==-1;N--,v++)I+=256*S[N]>>>0,S[N]=I%g>>>0,I=I/g>>>0;if(I!==0)throw new Error("Non-zero carry");X=v,he++}for(var L=w-X;L!==w&&S[L]===0;)L++;for(var ie=_.repeat(Y);L<w;++L)ie+=n.charAt(S[L]);return ie}function V(W){if(typeof W!="string")throw new TypeError("Expected String");if(W.length===0)return new Uint8Array;var Y=0;if(W[Y]!==" "){for(var X=0,he=0;W[Y]===_;)X++,Y++;for(var y=(W.length-Y)*T+1>>>0,w=new Uint8Array(y);W[Y];){var S=r[W.charCodeAt(Y)];if(S===255)return;for(var I=0,v=y-1;(S!==0||I<he)&&v!==-1;v--,I++)S+=g*w[v]>>>0,w[v]=S%256>>>0,S=S/256>>>0;if(S!==0)throw new Error("Non-zero carry");he=I,Y++}if(W[Y]!==" "){for(var N=y-he;N!==y&&w[N]===0;)N++;for(var L=new Uint8Array(X+(y-N)),ie=X;N!==y;)L[ie++]=w[N++];return L}}}function k(W){var Y=V(W);if(Y)return Y;throw new Error(`Non-${t} character`)}return{encode:F,decodeUnsafe:V,decode:k}}var oE=sE,aE=oE;const Nd=n=>{if(n instanceof Uint8Array&&n.constructor.name==="Uint8Array")return n;if(n instanceof ArrayBuffer)return new Uint8Array(n);if(ArrayBuffer.isView(n))return new Uint8Array(n.buffer,n.byteOffset,n.byteLength);throw new Error("Unknown type, must be binary type")},cE=n=>new TextEncoder().encode(n),uE=n=>new TextDecoder().decode(n);class hE{constructor(t,r,s){this.name=t,this.prefix=r,this.baseEncode=s}encode(t){if(t instanceof Uint8Array)return`${this.prefix}${this.baseEncode(t)}`;throw Error("Unknown type, must be binary type")}}class lE{constructor(t,r,s){if(this.name=t,this.prefix=r,r.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=r.codePointAt(0),this.baseDecode=s}decode(t){if(typeof t=="string"){if(t.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(t)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(t.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(t){return $d(this,t)}}class fE{constructor(t){this.decoders=t}or(t){return $d(this,t)}decode(t){const r=t[0],s=this.decoders[r];if(s)return s.decode(t);throw RangeError(`Unable to decode multibase string ${JSON.stringify(t)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}const $d=(n,t)=>new fE({...n.decoders||{[n.prefix]:n},...t.decoders||{[t.prefix]:t}});class dE{constructor(t,r,s,a){this.name=t,this.prefix=r,this.baseEncode=s,this.baseDecode=a,this.encoder=new hE(t,r,s),this.decoder=new lE(t,r,a)}encode(t){return this.encoder.encode(t)}decode(t){return this.decoder.decode(t)}}const Ho=({name:n,prefix:t,encode:r,decode:s})=>new dE(n,t,r,s),ms=({prefix:n,name:t,alphabet:r})=>{const{encode:s,decode:a}=aE(r,t);return Ho({prefix:n,name:t,encode:s,decode:u=>Nd(a(u))})},pE=(n,t,r,s)=>{const a={};for(let C=0;C<t.length;++C)a[t[C]]=C;let u=n.length;for(;n[u-1]==="=";)--u;const f=new Uint8Array(u*r/8|0);let g=0,_=0,T=0;for(let C=0;C<u;++C){const F=a[n[C]];if(F===void 0)throw new SyntaxError(`Non-${s} character`);_=_<<r|F,g+=r,g>=8&&(g-=8,f[T++]=255&_>>g)}if(g>=r||255&_<<8-g)throw new SyntaxError("Unexpected end of data");return f},gE=(n,t,r)=>{const s=t[t.length-1]==="=",a=(1<<r)-1;let u="",f=0,g=0;for(let _=0;_<n.length;++_)for(g=g<<8|n[_],f+=8;f>r;)f-=r,u+=t[a&g>>f];if(f&&(u+=t[a&g<<r-f]),s)for(;u.length*r&7;)u+="=";return u},Jt=({name:n,prefix:t,bitsPerChar:r,alphabet:s})=>Ho({prefix:t,name:n,encode(a){return gE(a,s,r)},decode(a){return pE(a,s,r,n)}}),yE=Ho({prefix:"\0",name:"identity",encode:n=>uE(n),decode:n=>cE(n)});var mE=Object.freeze({__proto__:null,identity:yE});const vE=Jt({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1});var bE=Object.freeze({__proto__:null,base2:vE});const wE=Jt({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3});var _E=Object.freeze({__proto__:null,base8:wE});const EE=ms({prefix:"9",name:"base10",alphabet:"0123456789"});var IE=Object.freeze({__proto__:null,base10:EE});const SE=Jt({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),xE=Jt({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4});var OE=Object.freeze({__proto__:null,base16:SE,base16upper:xE});const PE=Jt({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),TE=Jt({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),AE=Jt({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),CE=Jt({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),RE=Jt({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),NE=Jt({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),$E=Jt({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),LE=Jt({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),DE=Jt({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5});var FE=Object.freeze({__proto__:null,base32:PE,base32upper:TE,base32pad:AE,base32padupper:CE,base32hex:RE,base32hexupper:NE,base32hexpad:$E,base32hexpadupper:LE,base32z:DE});const UE=ms({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),jE=ms({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"});var ME=Object.freeze({__proto__:null,base36:UE,base36upper:jE});const qE=ms({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),zE=ms({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"});var kE=Object.freeze({__proto__:null,base58btc:qE,base58flickr:zE});const BE=Jt({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),HE=Jt({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),VE=Jt({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),KE=Jt({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6});var WE=Object.freeze({__proto__:null,base64:BE,base64pad:HE,base64url:VE,base64urlpad:KE});const Ld=Array.from(""),GE=Ld.reduce((n,t,r)=>(n[r]=t,n),[]),JE=Ld.reduce((n,t,r)=>(n[t.codePointAt(0)]=r,n),[]);function QE(n){return n.reduce((t,r)=>(t+=GE[r],t),"")}function YE(n){const t=[];for(const r of n){const s=JE[r.codePointAt(0)];if(s===void 0)throw new Error(`Non-base256emoji character: ${r}`);t.push(s)}return new Uint8Array(t)}const XE=Ho({prefix:"",name:"base256emoji",encode:QE,decode:YE});var ZE=Object.freeze({__proto__:null,base256emoji:XE}),eI=Dd,ef=128,tI=127,rI=~tI,iI=Math.pow(2,31);function Dd(n,t,r){t=t||[],r=r||0;for(var s=r;n>=iI;)t[r++]=n&255|ef,n/=128;for(;n&rI;)t[r++]=n&255|ef,n>>>=7;return t[r]=n|0,Dd.bytes=r-s+1,t}var nI=qc,sI=128,tf=127;function qc(n,s){var r=0,s=s||0,a=0,u=s,f,g=n.length;do{if(u>=g)throw qc.bytes=0,new RangeError("Could not decode varint");f=n[u++],r+=a<28?(f&tf)<<a:(f&tf)*Math.pow(2,a),a+=7}while(f>=sI);return qc.bytes=u-s,r}var oI=Math.pow(2,7),aI=Math.pow(2,14),cI=Math.pow(2,21),uI=Math.pow(2,28),hI=Math.pow(2,35),lI=Math.pow(2,42),fI=Math.pow(2,49),dI=Math.pow(2,56),pI=Math.pow(2,63),gI=function(n){return n<oI?1:n<aI?2:n<cI?3:n<uI?4:n<hI?5:n<lI?6:n<fI?7:n<dI?8:n<pI?9:10},yI={encode:eI,decode:nI,encodingLength:gI},Fd=yI;const rf=(n,t,r=0)=>(Fd.encode(n,t,r),t),nf=n=>Fd.encodingLength(n),zc=(n,t)=>{const r=t.byteLength,s=nf(n),a=s+nf(r),u=new Uint8Array(a+r);return rf(n,u,0),rf(r,u,s),u.set(t,a),new mI(n,r,t,u)};class mI{constructor(t,r,s,a){this.code=t,this.size=r,this.digest=s,this.bytes=a}}const Ud=({name:n,code:t,encode:r})=>new vI(n,t,r);class vI{constructor(t,r,s){this.name=t,this.code=r,this.encode=s}digest(t){if(t instanceof Uint8Array){const r=this.encode(t);return r instanceof Uint8Array?zc(this.code,r):r.then(s=>zc(this.code,s))}else throw Error("Unknown type, must be binary type")}}const jd=n=>async t=>new Uint8Array(await crypto.subtle.digest(n,t)),bI=Ud({name:"sha2-256",code:18,encode:jd("SHA-256")}),wI=Ud({name:"sha2-512",code:19,encode:jd("SHA-512")});var _I=Object.freeze({__proto__:null,sha256:bI,sha512:wI});const Md=0,EI="identity",qd=Nd,II=n=>zc(Md,qd(n)),SI={code:Md,name:EI,encode:qd,digest:II};var xI=Object.freeze({__proto__:null,identity:SI});new TextEncoder,new TextDecoder;const sf={...mE,...bE,..._E,...IE,...OE,...FE,...ME,...kE,...WE,...ZE};({..._I,...xI});function zd(n){return globalThis.Buffer!=null?new Uint8Array(n.buffer,n.byteOffset,n.byteLength):n}function OI(n=0){return globalThis.Buffer!=null&&globalThis.Buffer.allocUnsafe!=null?zd(globalThis.Buffer.allocUnsafe(n)):new Uint8Array(n)}function kd(n,t,r,s){return{name:n,prefix:t,encoder:{name:n,prefix:t,encode:r},decoder:{decode:s}}}const of=kd("utf8","u",n=>"u"+new TextDecoder("utf8").decode(n),n=>new TextEncoder().encode(n.substring(1))),Sc=kd("ascii","a",n=>{let t="a";for(let r=0;r<n.length;r++)t+=String.fromCharCode(n[r]);return t},n=>{n=n.substring(1);const t=OI(n.length);for(let r=0;r<n.length;r++)t[r]=n.charCodeAt(r);return t}),PI={utf8:of,"utf-8":of,hex:sf.base16,latin1:Sc,ascii:Sc,binary:Sc,...sf};function TI(n,t="utf8"){const r=PI[t];if(!r)throw new Error(`Unsupported encoding "${t}"`);return(t==="utf8"||t==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?zd(globalThis.Buffer.from(n,"utf-8")):r.decoder.decode(`${r.prefix}${n}`)}const Bd="wc",AI=2,nu="core",Pi=`${Bd}@2:${nu}:`,CI={name:nu,logger:"error"},RI={database:":memory:"},NI="crypto",af="client_ed25519_seed",$I=ue.ONE_DAY,LI="keychain",DI="0.3",FI="messages",UI="0.3",jI=ue.SIX_HOURS,MI="publisher",Hd="irn",qI="error",Vd="wss://relay.walletconnect.com",cf="wss://relay.walletconnect.org",zI="relayer",Xt={message:"relayer_message",message_ack:"relayer_message_ack",connect:"relayer_connect",disconnect:"relayer_disconnect",error:"relayer_error",connection_stalled:"relayer_connection_stalled",transport_closed:"relayer_transport_closed",publish:"relayer_publish"},kI="_subscription",fi={payload:"payload",connect:"connect",disconnect:"disconnect",error:"error"},BI=ue.ONE_SECOND,HI="2.10.1",VI=1e4,KI="0.3",WI="WALLETCONNECT_CLIENT_ID",Yr={created:"subscription_created",deleted:"subscription_deleted",expired:"subscription_expired",disabled:"subscription_disabled",sync:"subscription_sync",resubscribed:"subscription_resubscribed"},GI="subscription",JI="0.3",QI=ue.FIVE_SECONDS*1e3,YI="pairing",XI="0.3",es={wc_pairingDelete:{req:{ttl:ue.ONE_DAY,prompt:!1,tag:1e3},res:{ttl:ue.ONE_DAY,prompt:!1,tag:1001}},wc_pairingPing:{req:{ttl:ue.THIRTY_SECONDS,prompt:!1,tag:1002},res:{ttl:ue.THIRTY_SECONDS,prompt:!1,tag:1003}},unregistered_method:{req:{ttl:ue.ONE_DAY,prompt:!1,tag:0},res:{ttl:ue.ONE_DAY,prompt:!1,tag:0}}},ss={create:"pairing_create",expire:"pairing_expire",delete:"pairing_delete",ping:"pairing_ping"},Qr={created:"history_created",updated:"history_updated",deleted:"history_deleted",sync:"history_sync"},ZI="history",eS="0.3",tS="expirer",Lr={created:"expirer_created",deleted:"expirer_deleted",expired:"expirer_expired",sync:"expirer_sync"},rS="0.3",xc="verify-api",Co="https://verify.walletconnect.com",uf="https://verify.walletconnect.org";class iS{constructor(t,r){this.core=t,this.logger=r,this.keychain=new Map,this.name=LI,this.version=DI,this.initialized=!1,this.storagePrefix=Pi,this.init=async()=>{if(!this.initialized){const s=await this.getKeyChain();typeof s<"u"&&(this.keychain=s),this.initialized=!0}},this.has=s=>(this.isInitialized(),this.keychain.has(s)),this.set=async(s,a)=>{this.isInitialized(),this.keychain.set(s,a),await this.persist()},this.get=s=>{this.isInitialized();const a=this.keychain.get(s);if(typeof a>"u"){const{message:u}=re("NO_MATCHING_KEY",`${this.name}: ${s}`);throw new Error(u)}return a},this.del=async s=>{this.isInitialized(),this.keychain.delete(s),await this.persist()},this.core=t,this.logger=Ne.generateChildLogger(r,this.name)}get context(){return Ne.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}async setKeyChain(t){await this.core.storage.setItem(this.storageKey,bd(t))}async getKeyChain(){const t=await this.core.storage.getItem(this.storageKey);return typeof t<"u"?wd(t):void 0}async persist(){await this.setKeyChain(this.keychain)}isInitialized(){if(!this.initialized){const{message:t}=re("NOT_INITIALIZED",this.name);throw new Error(t)}}}let nS=class{constructor(t,r,s){this.core=t,this.logger=r,this.name=NI,this.initialized=!1,this.init=async()=>{this.initialized||(await this.keychain.init(),this.initialized=!0)},this.hasKeys=a=>(this.isInitialized(),this.keychain.has(a)),this.getClientId=async()=>{this.isInitialized();const a=await this.getClientSeed(),u=Al(a);return ld(u.publicKey)},this.generateKeyPair=()=>{this.isInitialized();const a=ww();return this.setPrivateKey(a.publicKey,a.privateKey)},this.signJWT=async a=>{this.isInitialized();const u=await this.getClientSeed(),f=Al(u),g=jc();return await Gb(g,a,$I,f)},this.generateSharedKey=(a,u,f)=>{this.isInitialized();const g=this.getPrivateKey(a),_=_w(g,u);return this.setSymKey(_,f)},this.setSymKey=async(a,u)=>{this.isInitialized();const f=u||Ew(a);return await this.keychain.set(f,a),f},this.deleteKeyPair=async a=>{this.isInitialized(),await this.keychain.del(a)},this.deleteSymKey=async a=>{this.isInitialized(),await this.keychain.del(a)},this.encode=async(a,u,f)=>{this.isInitialized();const g=vd(f),_=Nb(u);if(Fl(g)){const V=g.senderPublicKey,k=g.receiverPublicKey;a=await this.generateSharedKey(V,k)}const T=this.getSymKey(a),{type:C,senderPublicKey:F}=g;return Sw({type:C,symKey:T,message:_,senderPublicKey:F})},this.decode=async(a,u,f)=>{this.isInitialized();const g=Pw(u,f);if(Fl(g)){const _=g.receiverPublicKey,T=g.senderPublicKey;a=await this.generateSharedKey(_,T)}try{const _=this.getSymKey(a),T=xw({symKey:_,encoded:u});return Rb(T)}catch(_){this.logger.error(`Failed to decode message from topic: '${a}', clientId: '${await this.getClientId()}'`),this.logger.error(_)}},this.getPayloadType=a=>{const u=$o(a);return ds(u.type)},this.getPayloadSenderPublicKey=a=>{const u=$o(a);return u.senderPublicKey?cr(u.senderPublicKey,ar):void 0},this.core=t,this.logger=Ne.generateChildLogger(r,this.name),this.keychain=s||new iS(this.core,this.logger)}get context(){return Ne.getLoggerContext(this.logger)}async setPrivateKey(t,r){return await this.keychain.set(t,r),t}getPrivateKey(t){return this.keychain.get(t)}async getClientSeed(){let t="";try{t=this.keychain.get(af)}catch{t=jc(),await this.keychain.set(af,t)}return TI(t,"base16")}getSymKey(t){return this.keychain.get(t)}isInitialized(){if(!this.initialized){const{message:t}=re("NOT_INITIALIZED",this.name);throw new Error(t)}}};class sS extends wb{constructor(t,r){super(t,r),this.logger=t,this.core=r,this.messages=new Map,this.name=FI,this.version=UI,this.initialized=!1,this.storagePrefix=Pi,this.init=async()=>{if(!this.initialized){this.logger.trace("Initialized");try{const s=await this.getRelayerMessages();typeof s<"u"&&(this.messages=s),this.logger.debug(`Successfully Restored records for ${this.name}`),this.logger.trace({type:"method",method:"restore",size:this.messages.size})}catch(s){this.logger.debug(`Failed to Restore records for ${this.name}`),this.logger.error(s)}finally{this.initialized=!0}}},this.set=async(s,a)=>{this.isInitialized();const u=Sn(a);let f=this.messages.get(s);return typeof f>"u"&&(f={}),typeof f[u]<"u"||(f[u]=a,this.messages.set(s,f),await this.persist()),u},this.get=s=>{this.isInitialized();let a=this.messages.get(s);return typeof a>"u"&&(a={}),a},this.has=(s,a)=>{this.isInitialized();const u=this.get(s),f=Sn(a);return typeof u[f]<"u"},this.del=async s=>{this.isInitialized(),this.messages.delete(s),await this.persist()},this.logger=Ne.generateChildLogger(t,this.name),this.core=r}get context(){return Ne.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}async setRelayerMessages(t){await this.core.storage.setItem(this.storageKey,bd(t))}async getRelayerMessages(){const t=await this.core.storage.getItem(this.storageKey);return typeof t<"u"?wd(t):void 0}async persist(){await this.setRelayerMessages(this.messages)}isInitialized(){if(!this.initialized){const{message:t}=re("NOT_INITIALIZED",this.name);throw new Error(t)}}}class oS extends _b{constructor(t,r){super(t,r),this.relayer=t,this.logger=r,this.events=new Vt.EventEmitter,this.name=MI,this.queue=new Map,this.publishTimeout=ue.toMiliseconds(ue.TEN_SECONDS),this.needsTransportRestart=!1,this.publish=async(s,a,u)=>{var f;this.logger.debug("Publishing Payload"),this.logger.trace({type:"method",method:"publish",params:{topic:s,message:a,opts:u}});try{const g=(u==null?void 0:u.ttl)||jI,_=Mc(u),T=(u==null?void 0:u.prompt)||!1,C=(u==null?void 0:u.tag)||0,F=(u==null?void 0:u.id)||Ad().toString(),V={topic:s,message:a,opts:{ttl:g,relay:_,prompt:T,tag:C,id:F}},k=setTimeout(()=>this.queue.set(F,V),this.publishTimeout);try{await await ls(this.rpcPublish(s,a,g,_,T,C,F),this.publishTimeout,"Failed to publish payload, please try again."),this.removeRequestFromQueue(F),this.relayer.events.emit(Xt.publish,V)}catch(W){if(this.logger.debug("Publishing Payload stalled"),this.needsTransportRestart=!0,(f=u==null?void 0:u.internal)!=null&&f.throwOnFailedPublish)throw this.removeRequestFromQueue(F),W;return}finally{clearTimeout(k)}this.logger.debug("Successfully Published Payload"),this.logger.trace({type:"method",method:"publish",params:{topic:s,message:a,opts:u}})}catch(g){throw this.logger.debug("Failed to Publish Payload"),this.logger.error(g),g}},this.on=(s,a)=>{this.events.on(s,a)},this.once=(s,a)=>{this.events.once(s,a)},this.off=(s,a)=>{this.events.off(s,a)},this.removeListener=(s,a)=>{this.events.removeListener(s,a)},this.relayer=t,this.logger=Ne.generateChildLogger(r,this.name),this.registerEventListeners()}get context(){return Ne.getLoggerContext(this.logger)}rpcPublish(t,r,s,a,u,f,g){var _,T,C,F;const V={method:To(a.protocol).publish,params:{topic:t,message:r,ttl:s,prompt:u,tag:f},id:g};return or((_=V.params)==null?void 0:_.prompt)&&((T=V.params)==null||delete T.prompt),or((C=V.params)==null?void 0:C.tag)&&((F=V.params)==null||delete F.tag),this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"message",direction:"outgoing",request:V}),this.relayer.request(V)}removeRequestFromQueue(t){this.queue.delete(t)}checkQueue(){this.queue.forEach(async t=>{const{topic:r,message:s,opts:a}=t;await this.publish(r,s,a)})}registerEventListeners(){this.relayer.core.heartbeat.on(On.HEARTBEAT_EVENTS.pulse,()=>{if(this.needsTransportRestart){this.needsTransportRestart=!1,this.relayer.events.emit(Xt.connection_stalled);return}this.checkQueue()}),this.relayer.on(Xt.message_ack,t=>{this.removeRequestFromQueue(t.id.toString())})}}class aS{constructor(){this.map=new Map,this.set=(t,r)=>{const s=this.get(t);this.exists(t,r)||this.map.set(t,[...s,r])},this.get=t=>this.map.get(t)||[],this.exists=(t,r)=>this.get(t).includes(r),this.delete=(t,r)=>{if(typeof r>"u"){this.map.delete(t);return}if(!this.map.has(t))return;const s=this.get(t);if(!this.exists(t,r))return;const a=s.filter(u=>u!==r);if(!a.length){this.map.delete(t);return}this.map.set(t,a)},this.clear=()=>{this.map.clear()}}get topics(){return Array.from(this.map.keys())}}var cS=Object.defineProperty,uS=Object.defineProperties,hS=Object.getOwnPropertyDescriptors,hf=Object.getOwnPropertySymbols,lS=Object.prototype.hasOwnProperty,fS=Object.prototype.propertyIsEnumerable,lf=(n,t,r)=>t in n?cS(n,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):n[t]=r,ts=(n,t)=>{for(var r in t||(t={}))lS.call(t,r)&&lf(n,r,t[r]);if(hf)for(var r of hf(t))fS.call(t,r)&&lf(n,r,t[r]);return n},Oc=(n,t)=>uS(n,hS(t));class dS extends Sb{constructor(t,r){super(t,r),this.relayer=t,this.logger=r,this.subscriptions=new Map,this.topicMap=new aS,this.events=new Vt.EventEmitter,this.name=GI,this.version=JI,this.pending=new Map,this.cached=[],this.initialized=!1,this.pendingSubscriptionWatchLabel="pending_sub_watch_label",this.pollingInterval=20,this.storagePrefix=Pi,this.subscribeTimeout=1e4,this.restartInProgress=!1,this.batchSubscribeTopicsLimit=500,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),this.registerEventListeners(),this.clientId=await this.relayer.core.crypto.getClientId())},this.subscribe=async(s,a)=>{await this.restartToComplete(),this.isInitialized(),this.logger.debug("Subscribing Topic"),this.logger.trace({type:"method",method:"subscribe",params:{topic:s,opts:a}});try{const u=Mc(a),f={topic:s,relay:u};this.pending.set(s,f);const g=await this.rpcSubscribe(s,u);return this.onSubscribe(g,f),this.logger.debug("Successfully Subscribed Topic"),this.logger.trace({type:"method",method:"subscribe",params:{topic:s,opts:a}}),g}catch(u){throw this.logger.debug("Failed to Subscribe Topic"),this.logger.error(u),u}},this.unsubscribe=async(s,a)=>{await this.restartToComplete(),this.isInitialized(),typeof(a==null?void 0:a.id)<"u"?await this.unsubscribeById(s,a.id,a):await this.unsubscribeByTopic(s,a)},this.isSubscribed=async s=>this.topics.includes(s)?!0:await new Promise((a,u)=>{const f=new ue.Watch;f.start(this.pendingSubscriptionWatchLabel);const g=setInterval(()=>{!this.pending.has(s)&&this.topics.includes(s)&&(clearInterval(g),f.stop(this.pendingSubscriptionWatchLabel),a(!0)),f.elapsed(this.pendingSubscriptionWatchLabel)>=QI&&(clearInterval(g),f.stop(this.pendingSubscriptionWatchLabel),u(new Error("Subscription resolution timeout")))},this.pollingInterval)}).catch(()=>!1),this.on=(s,a)=>{this.events.on(s,a)},this.once=(s,a)=>{this.events.once(s,a)},this.off=(s,a)=>{this.events.off(s,a)},this.removeListener=(s,a)=>{this.events.removeListener(s,a)},this.restart=async()=>{this.restartInProgress=!0,await this.restore(),await this.reset(),this.restartInProgress=!1},this.relayer=t,this.logger=Ne.generateChildLogger(r,this.name),this.clientId=""}get context(){return Ne.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}get length(){return this.subscriptions.size}get ids(){return Array.from(this.subscriptions.keys())}get values(){return Array.from(this.subscriptions.values())}get topics(){return this.topicMap.topics}hasSubscription(t,r){let s=!1;try{s=this.getSubscription(t).topic===r}catch{}return s}onEnable(){this.cached=[],this.initialized=!0}onDisable(){this.cached=this.values,this.subscriptions.clear(),this.topicMap.clear()}async unsubscribeByTopic(t,r){const s=this.topicMap.get(t);await Promise.all(s.map(async a=>await this.unsubscribeById(t,a,r)))}async unsubscribeById(t,r,s){this.logger.debug("Unsubscribing Topic"),this.logger.trace({type:"method",method:"unsubscribe",params:{topic:t,id:r,opts:s}});try{const a=Mc(s);await this.rpcUnsubscribe(t,r,a);const u=Bt("USER_DISCONNECTED",`${this.name}, ${t}`);await this.onUnsubscribe(t,r,u),this.logger.debug("Successfully Unsubscribed Topic"),this.logger.trace({type:"method",method:"unsubscribe",params:{topic:t,id:r,opts:s}})}catch(a){throw this.logger.debug("Failed to Unsubscribe Topic"),this.logger.error(a),a}}async rpcSubscribe(t,r){const s={method:To(r.protocol).subscribe,params:{topic:t}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:s});try{await await ls(this.relayer.request(s),this.subscribeTimeout)}catch{this.logger.debug("Outgoing Relay Subscribe Payload stalled"),this.relayer.events.emit(Xt.connection_stalled)}return Sn(t+this.clientId)}async rpcBatchSubscribe(t){if(!t.length)return;const r=t[0].relay,s={method:To(r.protocol).batchSubscribe,params:{topics:t.map(a=>a.topic)}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:s});try{return await await ls(this.relayer.request(s),this.subscribeTimeout)}catch{this.logger.debug("Outgoing Relay Payload stalled"),this.relayer.events.emit(Xt.connection_stalled)}}rpcUnsubscribe(t,r,s){const a={method:To(s.protocol).unsubscribe,params:{topic:t,id:r}};return this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:a}),this.relayer.request(a)}onSubscribe(t,r){this.setSubscription(t,Oc(ts({},r),{id:t})),this.pending.delete(r.topic)}onBatchSubscribe(t){t.length&&t.forEach(r=>{this.setSubscription(r.id,ts({},r)),this.pending.delete(r.topic)})}async onUnsubscribe(t,r,s){this.events.removeAllListeners(r),this.hasSubscription(r,t)&&this.deleteSubscription(r,s),await this.relayer.messages.del(t)}async setRelayerSubscriptions(t){await this.relayer.core.storage.setItem(this.storageKey,t)}async getRelayerSubscriptions(){return await this.relayer.core.storage.getItem(this.storageKey)}setSubscription(t,r){this.subscriptions.has(t)||(this.logger.debug("Setting subscription"),this.logger.trace({type:"method",method:"setSubscription",id:t,subscription:r}),this.addSubscription(t,r))}addSubscription(t,r){this.subscriptions.set(t,ts({},r)),this.topicMap.set(r.topic,t),this.events.emit(Yr.created,r)}getSubscription(t){this.logger.debug("Getting subscription"),this.logger.trace({type:"method",method:"getSubscription",id:t});const r=this.subscriptions.get(t);if(!r){const{message:s}=re("NO_MATCHING_KEY",`${this.name}: ${t}`);throw new Error(s)}return r}deleteSubscription(t,r){this.logger.debug("Deleting subscription"),this.logger.trace({type:"method",method:"deleteSubscription",id:t,reason:r});const s=this.getSubscription(t);this.subscriptions.delete(t),this.topicMap.delete(s.topic,t),this.events.emit(Yr.deleted,Oc(ts({},s),{reason:r}))}async persist(){await this.setRelayerSubscriptions(this.values),this.events.emit(Yr.sync)}async reset(){if(this.cached.length){const t=Math.ceil(this.cached.length/this.batchSubscribeTopicsLimit);for(let r=0;r<t;r++){const s=this.cached.splice(0,this.batchSubscribeTopicsLimit);await this.batchSubscribe(s)}}this.events.emit(Yr.resubscribed)}async restore(){try{const t=await this.getRelayerSubscriptions();if(typeof t>"u"||!t.length)return;if(this.subscriptions.size){const{message:r}=re("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(r),this.logger.error(`${this.name}: ${JSON.stringify(this.values)}`),new Error(r)}this.cached=t,this.logger.debug(`Successfully Restored subscriptions for ${this.name}`),this.logger.trace({type:"method",method:"restore",subscriptions:this.values})}catch(t){this.logger.debug(`Failed to Restore subscriptions for ${this.name}`),this.logger.error(t)}}async batchSubscribe(t){if(!t.length)return;const r=await this.rpcBatchSubscribe(t);ys(r)&&this.onBatchSubscribe(r.map((s,a)=>Oc(ts({},t[a]),{id:s})))}async onConnect(){this.restartInProgress||(await this.restart(),this.onEnable())}onDisconnect(){this.onDisable()}async checkPending(){if(!this.initialized||this.relayer.transportExplicitlyClosed)return;const t=[];this.pending.forEach(r=>{t.push(r)}),await this.batchSubscribe(t)}registerEventListeners(){this.relayer.core.heartbeat.on(On.HEARTBEAT_EVENTS.pulse,async()=>{await this.checkPending()}),this.relayer.on(Xt.connect,async()=>{await this.onConnect()}),this.relayer.on(Xt.disconnect,()=>{this.onDisconnect()}),this.events.on(Yr.created,async t=>{const r=Yr.created;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:t}),await this.persist()}),this.events.on(Yr.deleted,async t=>{const r=Yr.deleted;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:t}),await this.persist()})}isInitialized(){if(!this.initialized){const{message:t}=re("NOT_INITIALIZED",this.name);throw new Error(t)}}async restartToComplete(){this.restartInProgress&&await new Promise(t=>{const r=setInterval(()=>{this.restartInProgress||(clearInterval(r),t())},this.pollingInterval)})}}var pS=Object.defineProperty,ff=Object.getOwnPropertySymbols,gS=Object.prototype.hasOwnProperty,yS=Object.prototype.propertyIsEnumerable,df=(n,t,r)=>t in n?pS(n,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):n[t]=r,mS=(n,t)=>{for(var r in t||(t={}))gS.call(t,r)&&df(n,r,t[r]);if(ff)for(var r of ff(t))yS.call(t,r)&&df(n,r,t[r]);return n};class vS extends Eb{constructor(t){super(t),this.protocol="wc",this.version=2,this.events=new Vt.EventEmitter,this.name=zI,this.transportExplicitlyClosed=!1,this.initialized=!1,this.connectionAttemptInProgress=!1,this.connectionStatusPollingInterval=20,this.staleConnectionErrors=["socket hang up","socket stalled"],this.hasExperiencedNetworkDisruption=!1,this.request=async r=>{this.logger.debug("Publishing Request Payload");try{return await this.toEstablishConnection(),await this.provider.request(r)}catch(s){throw this.logger.debug("Failed to Publish Request"),this.logger.error(s),s}},this.onPayloadHandler=r=>{this.onProviderPayload(r)},this.onConnectHandler=()=>{this.events.emit(Xt.connect)},this.onDisconnectHandler=()=>{this.onProviderDisconnect()},this.onProviderErrorHandler=r=>{this.logger.error(r),this.events.emit(Xt.error,r),this.logger.info("Fatal socket error received, closing transport"),this.transportClose()},this.registerProviderListeners=()=>{this.provider.on(fi.payload,this.onPayloadHandler),this.provider.on(fi.connect,this.onConnectHandler),this.provider.on(fi.disconnect,this.onDisconnectHandler),this.provider.on(fi.error,this.onProviderErrorHandler)},this.core=t.core,this.logger=typeof t.logger<"u"&&typeof t.logger!="string"?Ne.generateChildLogger(t.logger,this.name):Ne.pino(Ne.getDefaultLoggerOptions({level:t.logger||qI})),this.messages=new sS(this.logger,t.core),this.subscriber=new dS(this,this.logger),this.publisher=new oS(this,this.logger),this.relayUrl=(t==null?void 0:t.relayUrl)||Vd,this.projectId=t.projectId,this.provider={}}async init(){this.logger.trace("Initialized"),this.registerEventListeners(),await this.createProvider(),await Promise.all([this.messages.init(),this.subscriber.init()]);try{await this.transportOpen()}catch{this.logger.warn(`Connection via ${this.relayUrl} failed, attempting to connect via failover domain ${cf}...`),await this.restartTransport(cf)}this.initialized=!0,setTimeout(async()=>{this.subscriber.topics.length===0&&(this.logger.info("No topics subscribed to after init, closing transport"),await this.transportClose(),this.transportExplicitlyClosed=!1)},VI)}get context(){return Ne.getLoggerContext(this.logger)}get connected(){return this.provider.connection.connected}get connecting(){return this.provider.connection.connecting}async publish(t,r,s){this.isInitialized(),await this.publisher.publish(t,r,s),await this.recordMessageEvent({topic:t,message:r,publishedAt:Date.now()})}async subscribe(t,r){var s;this.isInitialized();let a=((s=this.subscriber.topicMap.get(t))==null?void 0:s[0])||"";return a||(await Promise.all([new Promise(u=>{this.subscriber.once(Yr.created,f=>{f.topic===t&&u()})}),new Promise(async u=>{a=await this.subscriber.subscribe(t,r),u()})]),a)}async unsubscribe(t,r){this.isInitialized(),await this.subscriber.unsubscribe(t,r)}on(t,r){this.events.on(t,r)}once(t,r){this.events.once(t,r)}off(t,r){this.events.off(t,r)}removeListener(t,r){this.events.removeListener(t,r)}async transportClose(){this.transportExplicitlyClosed=!0,this.hasExperiencedNetworkDisruption&&this.connected?await ls(this.provider.disconnect(),1e3,"provider.disconnect()").catch(()=>this.onProviderDisconnect()):this.connected&&await this.provider.disconnect()}async transportOpen(t){if(this.transportExplicitlyClosed=!1,await this.confirmOnlineStateOrThrow(),!this.connectionAttemptInProgress){t&&t!==this.relayUrl&&(this.relayUrl=t,await this.transportClose(),await this.createProvider()),this.connectionAttemptInProgress=!0;try{await Promise.all([new Promise(r=>{if(!this.initialized)return r();this.subscriber.once(Yr.resubscribed,()=>{r()})}),new Promise(async(r,s)=>{try{await ls(this.provider.connect(),1e4,`Socket stalled when trying to connect to ${this.relayUrl}`)}catch(a){s(a);return}r()})])}catch(r){this.logger.error(r);const s=r;if(!this.isConnectionStalled(s.message))throw r;this.provider.events.emit(fi.disconnect)}finally{this.connectionAttemptInProgress=!1,this.hasExperiencedNetworkDisruption=!1}}}async restartTransport(t){await this.confirmOnlineStateOrThrow(),!this.connectionAttemptInProgress&&(this.relayUrl=t||this.relayUrl,await this.transportClose(),await this.createProvider(),await this.transportOpen())}async confirmOnlineStateOrThrow(){if(!await Kl())throw new Error("No internet connection detected. Please restart your network and try again.")}isConnectionStalled(t){return this.staleConnectionErrors.some(r=>t.includes(r))}async createProvider(){this.provider.connection&&this.unregisterProviderListeners();const t=await this.core.crypto.signJWT(this.relayUrl);this.provider=new Ai(new iE(jw({sdkVersion:HI,protocol:this.protocol,version:this.version,relayUrl:this.relayUrl,projectId:this.projectId,auth:t,useOnCloseEvent:!0}))),this.registerProviderListeners()}async recordMessageEvent(t){const{topic:r,message:s}=t;await this.messages.set(r,s)}async shouldIgnoreMessageEvent(t){const{topic:r,message:s}=t;if(!s||s.length===0)return this.logger.debug(`Ignoring invalid/empty message: ${s}`),!0;if(!await this.subscriber.isSubscribed(r))return this.logger.debug(`Ignoring message for non-subscribed topic ${r}`),!0;const a=this.messages.has(r,s);return a&&this.logger.debug(`Ignoring duplicate message: ${s}`),a}async onProviderPayload(t){if(this.logger.debug("Incoming Relay Payload"),this.logger.trace({type:"payload",direction:"incoming",payload:t}),iu(t)){if(!t.method.endsWith(kI))return;const r=t.params,{topic:s,message:a,publishedAt:u}=r.data,f={topic:s,message:a,publishedAt:u};this.logger.debug("Emitting Relayer Payload"),this.logger.trace(mS({type:"event",event:r.id},f)),this.events.emit(r.id,f),await this.acknowledgePayload(t),await this.onMessageEvent(f)}else Bo(t)&&this.events.emit(Xt.message_ack,t)}async onMessageEvent(t){await this.shouldIgnoreMessageEvent(t)||(this.events.emit(Xt.message,t),await this.recordMessageEvent(t))}async acknowledgePayload(t){const r=ru(t.id,!0);await this.provider.connection.send(r)}unregisterProviderListeners(){this.provider.off(fi.payload,this.onPayloadHandler),this.provider.off(fi.connect,this.onConnectHandler),this.provider.off(fi.disconnect,this.onDisconnectHandler),this.provider.off(fi.error,this.onProviderErrorHandler)}async registerEventListeners(){this.events.on(Xt.connection_stalled,()=>{this.restartTransport().catch(r=>this.logger.error(r))});let t=await Kl();C_(async r=>{this.initialized&&t!==r&&(t=r,r?await this.restartTransport().catch(s=>this.logger.error(s)):(this.hasExperiencedNetworkDisruption=!0,await this.transportClose().catch(s=>this.logger.error(s))))})}onProviderDisconnect(){this.events.emit(Xt.disconnect),this.attemptToReconnect()}attemptToReconnect(){this.transportExplicitlyClosed||(this.logger.info("attemptToReconnect called. Connecting..."),setTimeout(async()=>{await this.restartTransport().catch(t=>this.logger.error(t))},ue.toMiliseconds(BI)))}isInitialized(){if(!this.initialized){const{message:t}=re("NOT_INITIALIZED",this.name);throw new Error(t)}}async toEstablishConnection(){if(await this.confirmOnlineStateOrThrow(),!this.connected){if(this.connectionAttemptInProgress)return await new Promise(t=>{const r=setInterval(()=>{this.connected&&(clearInterval(r),t())},this.connectionStatusPollingInterval)});await this.restartTransport()}}}var bS=Object.defineProperty,pf=Object.getOwnPropertySymbols,wS=Object.prototype.hasOwnProperty,_S=Object.prototype.propertyIsEnumerable,gf=(n,t,r)=>t in n?bS(n,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):n[t]=r,yf=(n,t)=>{for(var r in t||(t={}))wS.call(t,r)&&gf(n,r,t[r]);if(pf)for(var r of pf(t))_S.call(t,r)&&gf(n,r,t[r]);return n};class Vo extends Ib{constructor(t,r,s,a=Pi,u=void 0){super(t,r,s,a),this.core=t,this.logger=r,this.name=s,this.map=new Map,this.version=KI,this.cached=[],this.initialized=!1,this.storagePrefix=Pi,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(f=>{this.getKey&&f!==null&&!or(f)?this.map.set(this.getKey(f),f):a_(f)?this.map.set(f.id,f):c_(f)&&this.map.set(f.topic,f)}),this.cached=[],this.initialized=!0)},this.set=async(f,g)=>{this.isInitialized(),this.map.has(f)?await this.update(f,g):(this.logger.debug("Setting value"),this.logger.trace({type:"method",method:"set",key:f,value:g}),this.map.set(f,g),await this.persist())},this.get=f=>(this.isInitialized(),this.logger.debug("Getting value"),this.logger.trace({type:"method",method:"get",key:f}),this.getData(f)),this.getAll=f=>(this.isInitialized(),f?this.values.filter(g=>Object.keys(f).every(_=>Do(g[_],f[_]))):this.values),this.update=async(f,g)=>{this.isInitialized(),this.logger.debug("Updating value"),this.logger.trace({type:"method",method:"update",key:f,update:g});const _=yf(yf({},this.getData(f)),g);this.map.set(f,_),await this.persist()},this.delete=async(f,g)=>{this.isInitialized(),this.map.has(f)&&(this.logger.debug("Deleting value"),this.logger.trace({type:"method",method:"delete",key:f,reason:g}),this.map.delete(f),await this.persist())},this.logger=Ne.generateChildLogger(r,this.name),this.storagePrefix=a,this.getKey=u}get context(){return Ne.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}get length(){return this.map.size}get keys(){return Array.from(this.map.keys())}get values(){return Array.from(this.map.values())}async setDataStore(t){await this.core.storage.setItem(this.storageKey,t)}async getDataStore(){return await this.core.storage.getItem(this.storageKey)}getData(t){const r=this.map.get(t);if(!r){const{message:s}=re("NO_MATCHING_KEY",`${this.name}: ${t}`);throw this.logger.error(s),new Error(s)}return r}async persist(){await this.setDataStore(this.values)}async restore(){try{const t=await this.getDataStore();if(typeof t>"u"||!t.length)return;if(this.map.size){const{message:r}=re("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(r),new Error(r)}this.cached=t,this.logger.debug(`Successfully Restored value for ${this.name}`),this.logger.trace({type:"method",method:"restore",value:this.values})}catch(t){this.logger.debug(`Failed to Restore value for ${this.name}`),this.logger.error(t)}}isInitialized(){if(!this.initialized){const{message:t}=re("NOT_INITIALIZED",this.name);throw new Error(t)}}}class ES{constructor(t,r){this.core=t,this.logger=r,this.name=YI,this.version=XI,this.events=new Vt,this.initialized=!1,this.storagePrefix=Pi,this.ignoredPayloadTypes=[Qi],this.registeredMethods=[],this.init=async()=>{this.initialized||(await this.pairings.init(),await this.cleanup(),this.registerRelayerEvents(),this.registerExpirerEvents(),this.initialized=!0,this.logger.trace("Initialized"))},this.register=({methods:s})=>{this.isInitialized(),this.registeredMethods=[...new Set([...this.registeredMethods,...s])]},this.create=async()=>{this.isInitialized();const s=jc(),a=await this.core.crypto.setSymKey(s),u=zr(ue.FIVE_MINUTES),f={protocol:Hd},g={topic:a,expiry:u,relay:f,active:!1},_=Yw({protocol:this.core.protocol,version:this.core.version,topic:a,symKey:s,relay:f});return await this.pairings.set(a,g),await this.core.relayer.subscribe(a),this.core.expirer.set(a,u),{topic:a,uri:_}},this.pair=async s=>{this.isInitialized(),this.isValidPair(s);const{topic:a,symKey:u,relay:f}=Gw(s.uri);let g;if(this.pairings.keys.includes(a)&&(g=this.pairings.get(a),g.active))throw new Error(`Pairing already exists: ${a}. Please try again with a new connection URI.`);this.core.crypto.keychain.has(a)||(await this.core.crypto.setSymKey(u,a),await this.core.relayer.subscribe(a,{relay:f}));const _=zr(ue.FIVE_MINUTES),T={topic:a,relay:f,expiry:_,active:!1};return await this.pairings.set(a,T),this.core.expirer.set(a,_),s.activatePairing&&await this.activate({topic:a}),this.events.emit(ss.create,T),T},this.activate=async({topic:s})=>{this.isInitialized();const a=zr(ue.THIRTY_DAYS);await this.pairings.update(s,{active:!0,expiry:a}),this.core.expirer.set(s,a)},this.ping=async s=>{this.isInitialized(),await this.isValidPing(s);const{topic:a}=s;if(this.pairings.keys.includes(a)){const u=await this.sendRequest(a,"wc_pairingPing",{}),{done:f,resolve:g,reject:_}=En();this.events.once(Ft("pairing_ping",u),({error:T})=>{T?_(T):g()}),await f()}},this.updateExpiry=async({topic:s,expiry:a})=>{this.isInitialized(),await this.pairings.update(s,{expiry:a})},this.updateMetadata=async({topic:s,metadata:a})=>{this.isInitialized(),await this.pairings.update(s,{peerMetadata:a})},this.getPairings=()=>(this.isInitialized(),this.pairings.values),this.disconnect=async s=>{this.isInitialized(),await this.isValidDisconnect(s);const{topic:a}=s;this.pairings.keys.includes(a)&&(await this.sendRequest(a,"wc_pairingDelete",Bt("USER_DISCONNECTED")),await this.deletePairing(a))},this.sendRequest=async(s,a,u)=>{const f=xn(a,u),g=await this.core.crypto.encode(s,f),_=es[a].req;return this.core.history.set(s,f),this.core.relayer.publish(s,g,_),f.id},this.sendResult=async(s,a,u)=>{const f=ru(s,u),g=await this.core.crypto.encode(a,f),_=await this.core.history.get(a,s),T=es[_.request.method].res;await this.core.relayer.publish(a,g,T),await this.core.history.resolve(f)},this.sendError=async(s,a,u)=>{const f=ko(s,u),g=await this.core.crypto.encode(a,f),_=await this.core.history.get(a,s),T=es[_.request.method]?es[_.request.method].res:es.unregistered_method.res;await this.core.relayer.publish(a,g,T),await this.core.history.resolve(f)},this.deletePairing=async(s,a)=>{await this.core.relayer.unsubscribe(s),await Promise.all([this.pairings.delete(s,Bt("USER_DISCONNECTED")),this.core.crypto.deleteSymKey(s),a?Promise.resolve():this.core.expirer.del(s)])},this.cleanup=async()=>{const s=this.pairings.getAll().filter(a=>Oi(a.expiry));await Promise.all(s.map(a=>this.deletePairing(a.topic)))},this.onRelayEventRequest=s=>{const{topic:a,payload:u}=s;switch(u.method){case"wc_pairingPing":return this.onPairingPingRequest(a,u);case"wc_pairingDelete":return this.onPairingDeleteRequest(a,u);default:return this.onUnknownRpcMethodRequest(a,u)}},this.onRelayEventResponse=async s=>{const{topic:a,payload:u}=s,f=(await this.core.history.get(a,u.id)).request.method;switch(f){case"wc_pairingPing":return this.onPairingPingResponse(a,u);default:return this.onUnknownRpcMethodResponse(f)}},this.onPairingPingRequest=async(s,a)=>{const{id:u}=a;try{this.isValidPing({topic:s}),await this.sendResult(u,s,!0),this.events.emit(ss.ping,{id:u,topic:s})}catch(f){await this.sendError(u,s,f),this.logger.error(f)}},this.onPairingPingResponse=(s,a)=>{const{id:u}=a;setTimeout(()=>{pi(a)?this.events.emit(Ft("pairing_ping",u),{}):kr(a)&&this.events.emit(Ft("pairing_ping",u),{error:a.error})},500)},this.onPairingDeleteRequest=async(s,a)=>{const{id:u}=a;try{this.isValidDisconnect({topic:s}),await this.deletePairing(s),this.events.emit(ss.delete,{id:u,topic:s})}catch(f){await this.sendError(u,s,f),this.logger.error(f)}},this.onUnknownRpcMethodRequest=async(s,a)=>{const{id:u,method:f}=a;try{if(this.registeredMethods.includes(f))return;const g=Bt("WC_METHOD_UNSUPPORTED",f);await this.sendError(u,s,g),this.logger.error(g)}catch(g){await this.sendError(u,s,g),this.logger.error(g)}},this.onUnknownRpcMethodResponse=s=>{this.registeredMethods.includes(s)||this.logger.error(Bt("WC_METHOD_UNSUPPORTED",s))},this.isValidPair=s=>{if(!yr(s)){const{message:a}=re("MISSING_OR_INVALID",`pair() params: ${s}`);throw new Error(a)}if(!o_(s.uri)){const{message:a}=re("MISSING_OR_INVALID",`pair() uri: ${s.uri}`);throw new Error(a)}},this.isValidPing=async s=>{if(!yr(s)){const{message:u}=re("MISSING_OR_INVALID",`ping() params: ${s}`);throw new Error(u)}const{topic:a}=s;await this.isValidPairingTopic(a)},this.isValidDisconnect=async s=>{if(!yr(s)){const{message:u}=re("MISSING_OR_INVALID",`disconnect() params: ${s}`);throw new Error(u)}const{topic:a}=s;await this.isValidPairingTopic(a)},this.isValidPairingTopic=async s=>{if(!Ht(s,!1)){const{message:a}=re("MISSING_OR_INVALID",`pairing topic should be a string: ${s}`);throw new Error(a)}if(!this.pairings.keys.includes(s)){const{message:a}=re("NO_MATCHING_KEY",`pairing topic doesn't exist: ${s}`);throw new Error(a)}if(Oi(this.pairings.get(s).expiry)){await this.deletePairing(s);const{message:a}=re("EXPIRED",`pairing topic: ${s}`);throw new Error(a)}},this.core=t,this.logger=Ne.generateChildLogger(r,this.name),this.pairings=new Vo(this.core,this.logger,this.name,this.storagePrefix)}get context(){return Ne.getLoggerContext(this.logger)}isInitialized(){if(!this.initialized){const{message:t}=re("NOT_INITIALIZED",this.name);throw new Error(t)}}registerRelayerEvents(){this.core.relayer.on(Xt.message,async t=>{const{topic:r,message:s}=t;if(!this.pairings.keys.includes(r)||this.ignoredPayloadTypes.includes(this.core.crypto.getPayloadType(s)))return;const a=await this.core.crypto.decode(r,s);try{iu(a)?(this.core.history.set(r,a),this.onRelayEventRequest({topic:r,payload:a})):Bo(a)&&(await this.core.history.resolve(a),await this.onRelayEventResponse({topic:r,payload:a}),this.core.history.delete(r,a.id))}catch(u){this.logger.error(u)}})}registerExpirerEvents(){this.core.expirer.on(Lr.expired,async t=>{const{topic:r}=Ed(t.target);r&&this.pairings.keys.includes(r)&&(await this.deletePairing(r,!0),this.events.emit(ss.expire,{topic:r}))})}}class IS extends bb{constructor(t,r){super(t,r),this.core=t,this.logger=r,this.records=new Map,this.events=new Vt.EventEmitter,this.name=ZI,this.version=eS,this.cached=[],this.initialized=!1,this.storagePrefix=Pi,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(s=>this.records.set(s.id,s)),this.cached=[],this.registerEventListeners(),this.initialized=!0)},this.set=(s,a,u)=>{if(this.isInitialized(),this.logger.debug("Setting JSON-RPC request history record"),this.logger.trace({type:"method",method:"set",topic:s,request:a,chainId:u}),this.records.has(a.id))return;const f={id:a.id,topic:s,request:{method:a.method,params:a.params||null},chainId:u,expiry:zr(ue.THIRTY_DAYS)};this.records.set(f.id,f),this.events.emit(Qr.created,f)},this.resolve=async s=>{if(this.isInitialized(),this.logger.debug("Updating JSON-RPC response history record"),this.logger.trace({type:"method",method:"update",response:s}),!this.records.has(s.id))return;const a=await this.getRecord(s.id);typeof a.response>"u"&&(a.response=kr(s)?{error:s.error}:{result:s.result},this.records.set(a.id,a),this.events.emit(Qr.updated,a))},this.get=async(s,a)=>(this.isInitialized(),this.logger.debug("Getting record"),this.logger.trace({type:"method",method:"get",topic:s,id:a}),await this.getRecord(a)),this.delete=(s,a)=>{this.isInitialized(),this.logger.debug("Deleting record"),this.logger.trace({type:"method",method:"delete",id:a}),this.values.forEach(u=>{if(u.topic===s){if(typeof a<"u"&&u.id!==a)return;this.records.delete(u.id),this.events.emit(Qr.deleted,u)}})},this.exists=async(s,a)=>(this.isInitialized(),this.records.has(a)?(await this.getRecord(a)).topic===s:!1),this.on=(s,a)=>{this.events.on(s,a)},this.once=(s,a)=>{this.events.once(s,a)},this.off=(s,a)=>{this.events.off(s,a)},this.removeListener=(s,a)=>{this.events.removeListener(s,a)},this.logger=Ne.generateChildLogger(r,this.name)}get context(){return Ne.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}get size(){return this.records.size}get keys(){return Array.from(this.records.keys())}get values(){return Array.from(this.records.values())}get pending(){const t=[];return this.values.forEach(r=>{if(typeof r.response<"u")return;const s={topic:r.topic,request:xn(r.request.method,r.request.params,r.id),chainId:r.chainId};return t.push(s)}),t}async setJsonRpcRecords(t){await this.core.storage.setItem(this.storageKey,t)}async getJsonRpcRecords(){return await this.core.storage.getItem(this.storageKey)}getRecord(t){this.isInitialized();const r=this.records.get(t);if(!r){const{message:s}=re("NO_MATCHING_KEY",`${this.name}: ${t}`);throw new Error(s)}return r}async persist(){await this.setJsonRpcRecords(this.values),this.events.emit(Qr.sync)}async restore(){try{const t=await this.getJsonRpcRecords();if(typeof t>"u"||!t.length)return;if(this.records.size){const{message:r}=re("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(r),new Error(r)}this.cached=t,this.logger.debug(`Successfully Restored records for ${this.name}`),this.logger.trace({type:"method",method:"restore",records:this.values})}catch(t){this.logger.debug(`Failed to Restore records for ${this.name}`),this.logger.error(t)}}registerEventListeners(){this.events.on(Qr.created,t=>{const r=Qr.created;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,record:t}),this.persist()}),this.events.on(Qr.updated,t=>{const r=Qr.updated;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,record:t}),this.persist()}),this.events.on(Qr.deleted,t=>{const r=Qr.deleted;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,record:t}),this.persist()}),this.core.heartbeat.on(On.HEARTBEAT_EVENTS.pulse,()=>{this.cleanup()})}cleanup(){try{this.records.forEach(t=>{ue.toMiliseconds(t.expiry||0)-Date.now()<=0&&(this.logger.info(`Deleting expired history log: ${t.id}`),this.delete(t.topic,t.id))})}catch(t){this.logger.warn(t)}}isInitialized(){if(!this.initialized){const{message:t}=re("NOT_INITIALIZED",this.name);throw new Error(t)}}}class SS extends xb{constructor(t,r){super(t,r),this.core=t,this.logger=r,this.expirations=new Map,this.events=new Vt.EventEmitter,this.name=tS,this.version=rS,this.cached=[],this.initialized=!1,this.storagePrefix=Pi,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(s=>this.expirations.set(s.target,s)),this.cached=[],this.registerEventListeners(),this.initialized=!0)},this.has=s=>{try{const a=this.formatTarget(s);return typeof this.getExpiration(a)<"u"}catch{return!1}},this.set=(s,a)=>{this.isInitialized();const u=this.formatTarget(s),f={target:u,expiry:a};this.expirations.set(u,f),this.checkExpiry(u,f),this.events.emit(Lr.created,{target:u,expiration:f})},this.get=s=>{this.isInitialized();const a=this.formatTarget(s);return this.getExpiration(a)},this.del=s=>{if(this.isInitialized(),this.has(s)){const a=this.formatTarget(s),u=this.getExpiration(a);this.expirations.delete(a),this.events.emit(Lr.deleted,{target:a,expiration:u})}},this.on=(s,a)=>{this.events.on(s,a)},this.once=(s,a)=>{this.events.once(s,a)},this.off=(s,a)=>{this.events.off(s,a)},this.removeListener=(s,a)=>{this.events.removeListener(s,a)},this.logger=Ne.generateChildLogger(r,this.name)}get context(){return Ne.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}get length(){return this.expirations.size}get keys(){return Array.from(this.expirations.keys())}get values(){return Array.from(this.expirations.values())}formatTarget(t){if(typeof t=="string")return Mw(t);if(typeof t=="number")return qw(t);const{message:r}=re("UNKNOWN_TYPE",`Target type: ${typeof t}`);throw new Error(r)}async setExpirations(t){await this.core.storage.setItem(this.storageKey,t)}async getExpirations(){return await this.core.storage.getItem(this.storageKey)}async persist(){await this.setExpirations(this.values),this.events.emit(Lr.sync)}async restore(){try{const t=await this.getExpirations();if(typeof t>"u"||!t.length)return;if(this.expirations.size){const{message:r}=re("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(r),new Error(r)}this.cached=t,this.logger.debug(`Successfully Restored expirations for ${this.name}`),this.logger.trace({type:"method",method:"restore",expirations:this.values})}catch(t){this.logger.debug(`Failed to Restore expirations for ${this.name}`),this.logger.error(t)}}getExpiration(t){const r=this.expirations.get(t);if(!r){const{message:s}=re("NO_MATCHING_KEY",`${this.name}: ${t}`);throw this.logger.error(s),new Error(s)}return r}checkExpiry(t,r){const{expiry:s}=r;ue.toMiliseconds(s)-Date.now()<=0&&this.expire(t,r)}expire(t,r){this.expirations.delete(t),this.events.emit(Lr.expired,{target:t,expiration:r})}checkExpirations(){this.core.relayer.connected&&this.expirations.forEach((t,r)=>this.checkExpiry(r,t))}registerEventListeners(){this.core.heartbeat.on(On.HEARTBEAT_EVENTS.pulse,()=>this.checkExpirations()),this.events.on(Lr.created,t=>{const r=Lr.created;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:t}),this.persist()}),this.events.on(Lr.expired,t=>{const r=Lr.expired;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:t}),this.persist()}),this.events.on(Lr.deleted,t=>{const r=Lr.deleted;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:t}),this.persist()})}isInitialized(){if(!this.initialized){const{message:t}=re("NOT_INITIALIZED",this.name);throw new Error(t)}}}class xS extends Ob{constructor(t,r){super(t,r),this.projectId=t,this.logger=r,this.name=xc,this.initialized=!1,this.queue=[],this.verifyDisabled=!1,this.init=async s=>{if(this.verifyDisabled||zo()||!ps())return;const a=(s==null?void 0:s.verifyUrl)||Co;this.verifyUrl!==a&&this.removeIframe(),this.verifyUrl=a;try{await this.createIframe()}catch(u){this.logger.info(`Verify iframe failed to load: ${this.verifyUrl}`),this.logger.info(u)}if(!this.initialized){this.removeIframe(),this.verifyUrl=uf;try{await this.createIframe()}catch(u){this.logger.info(`Verify iframe failed to load: ${this.verifyUrl}`),this.logger.info(u),this.verifyDisabled=!0}}},this.register=async s=>{this.initialized?this.sendPost(s.attestationId):(this.addToQueue(s.attestationId),await this.init())},this.resolve=async s=>{if(this.isDevEnv)return"";const a=(s==null?void 0:s.verifyUrl)||Co;let u;try{u=await this.fetchAttestation(s.attestationId,a)}catch(f){this.logger.info(`failed to resolve attestation: ${s.attestationId} from url: ${a}`),this.logger.info(f),u=await this.fetchAttestation(s.attestationId,uf)}return u},this.fetchAttestation=async(s,a)=>{this.logger.info(`resolving attestation: ${s} from url: ${a}`);const u=this.startAbortTimer(ue.ONE_SECOND*2),f=await fetch(`${a}/attestation/${s}`,{signal:this.abortController.signal});return clearTimeout(u),f.status===200?await f.json():void 0},this.addToQueue=s=>{this.queue.push(s)},this.processQueue=()=>{this.queue.length!==0&&(this.queue.forEach(s=>this.sendPost(s)),this.queue=[])},this.sendPost=s=>{var a;try{if(!this.iframe)return;(a=this.iframe.contentWindow)==null||a.postMessage(s,"*"),this.logger.info(`postMessage sent: ${s} ${this.verifyUrl}`)}catch{}},this.createIframe=async()=>{let s;const a=u=>{u.data==="verify_ready"&&(this.initialized=!0,this.processQueue(),window.removeEventListener("message",a),s())};await Promise.race([new Promise(u=>{if(document.getElementById(xc))return u();window.addEventListener("message",a);const f=document.createElement("iframe");f.id=xc,f.src=`${this.verifyUrl}/${this.projectId}`,f.style.display="none",document.body.append(f),this.iframe=f,s=u}),new Promise((u,f)=>setTimeout(()=>{window.removeEventListener("message",a),f("verify iframe load timeout")},ue.toMiliseconds(ue.FIVE_SECONDS)))])},this.removeIframe=()=>{this.iframe&&(this.iframe.remove(),this.iframe=void 0,this.initialized=!1)},this.logger=Ne.generateChildLogger(r,this.name),this.verifyUrl=Co,this.abortController=new AbortController,this.isDevEnv=Xc()&&{}.IS_VITEST}get context(){return Ne.getLoggerContext(this.logger)}startAbortTimer(t){return this.abortController=new AbortController,setTimeout(()=>this.abortController.abort(),ue.toMiliseconds(t))}}var OS=Object.defineProperty,mf=Object.getOwnPropertySymbols,PS=Object.prototype.hasOwnProperty,TS=Object.prototype.propertyIsEnumerable,vf=(n,t,r)=>t in n?OS(n,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):n[t]=r,bf=(n,t)=>{for(var r in t||(t={}))PS.call(t,r)&&vf(n,r,t[r]);if(mf)for(var r of mf(t))TS.call(t,r)&&vf(n,r,t[r]);return n};class su extends vb{constructor(t){super(t),this.protocol=Bd,this.version=AI,this.name=nu,this.events=new Vt.EventEmitter,this.initialized=!1,this.on=(s,a)=>this.events.on(s,a),this.once=(s,a)=>this.events.once(s,a),this.off=(s,a)=>this.events.off(s,a),this.removeListener=(s,a)=>this.events.removeListener(s,a),this.projectId=t==null?void 0:t.projectId,this.relayUrl=(t==null?void 0:t.relayUrl)||Vd;const r=typeof(t==null?void 0:t.logger)<"u"&&typeof(t==null?void 0:t.logger)!="string"?t.logger:Ne.pino(Ne.getDefaultLoggerOptions({level:(t==null?void 0:t.logger)||CI.logger}));this.logger=Ne.generateChildLogger(r,this.name),this.heartbeat=new On.HeartBeat,this.crypto=new nS(this,this.logger,t==null?void 0:t.keychain),this.history=new IS(this,this.logger),this.expirer=new SS(this,this.logger),this.storage=t!=null&&t.storage?t.storage:new ub(bf(bf({},RI),t==null?void 0:t.storageOptions)),this.relayer=new vS({core:this,logger:this.logger,relayUrl:this.relayUrl,projectId:this.projectId}),this.pairing=new ES(this,this.logger),this.verify=new xS(this.projectId||"",this.logger)}static async init(t){const r=new su(t);await r.initialize();const s=await r.crypto.getClientId();return await r.storage.setItem(WI,s),r}get context(){return Ne.getLoggerContext(this.logger)}async start(){this.initialized||await this.initialize()}async initialize(){this.logger.trace("Initialized");try{await this.crypto.init(),await this.history.init(),await this.expirer.init(),await this.relayer.init(),await this.heartbeat.init(),await this.pairing.init(),this.initialized=!0,this.logger.info("Core Initialization Success")}catch(t){throw this.logger.warn(`Core Initialization Failure at epoch ${Date.now()}`,t),this.logger.error(t.message),t}}}const AS=su,Kd="wc",Wd=2,Gd="client",ou=`${Kd}@${Wd}:${Gd}:`,Pc={name:Gd,logger:"error",controller:!1,relayUrl:"wss://relay.walletconnect.com"},wf="WALLETCONNECT_DEEPLINK_CHOICE",CS="proposal",Jd="Proposal expired",RS="session",So=ue.SEVEN_DAYS,NS="engine",rs={wc_sessionPropose:{req:{ttl:ue.FIVE_MINUTES,prompt:!0,tag:1100},res:{ttl:ue.FIVE_MINUTES,prompt:!1,tag:1101}},wc_sessionSettle:{req:{ttl:ue.FIVE_MINUTES,prompt:!1,tag:1102},res:{ttl:ue.FIVE_MINUTES,prompt:!1,tag:1103}},wc_sessionUpdate:{req:{ttl:ue.ONE_DAY,prompt:!1,tag:1104},res:{ttl:ue.ONE_DAY,prompt:!1,tag:1105}},wc_sessionExtend:{req:{ttl:ue.ONE_DAY,prompt:!1,tag:1106},res:{ttl:ue.ONE_DAY,prompt:!1,tag:1107}},wc_sessionRequest:{req:{ttl:ue.FIVE_MINUTES,prompt:!0,tag:1108},res:{ttl:ue.FIVE_MINUTES,prompt:!1,tag:1109}},wc_sessionEvent:{req:{ttl:ue.FIVE_MINUTES,prompt:!0,tag:1110},res:{ttl:ue.FIVE_MINUTES,prompt:!1,tag:1111}},wc_sessionDelete:{req:{ttl:ue.ONE_DAY,prompt:!1,tag:1112},res:{ttl:ue.ONE_DAY,prompt:!1,tag:1113}},wc_sessionPing:{req:{ttl:ue.THIRTY_SECONDS,prompt:!1,tag:1114},res:{ttl:ue.THIRTY_SECONDS,prompt:!1,tag:1115}}},Tc={min:ue.FIVE_MINUTES,max:ue.SEVEN_DAYS},di={idle:"IDLE",active:"ACTIVE"},$S="request",LS=["wc_sessionPropose","wc_sessionRequest","wc_authRequest"];var DS=Object.defineProperty,FS=Object.defineProperties,US=Object.getOwnPropertyDescriptors,_f=Object.getOwnPropertySymbols,jS=Object.prototype.hasOwnProperty,MS=Object.prototype.propertyIsEnumerable,Ef=(n,t,r)=>t in n?DS(n,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):n[t]=r,gr=(n,t)=>{for(var r in t||(t={}))jS.call(t,r)&&Ef(n,r,t[r]);if(_f)for(var r of _f(t))MS.call(t,r)&&Ef(n,r,t[r]);return n},is=(n,t)=>FS(n,US(t));class qS extends Tb{constructor(t){super(t),this.name=NS,this.events=new Vt,this.initialized=!1,this.ignoredPayloadTypes=[Qi],this.requestQueue={state:di.idle,queue:[]},this.sessionRequestQueue={state:di.idle,queue:[]},this.requestQueueDelay=ue.ONE_SECOND,this.init=async()=>{this.initialized||(await this.cleanup(),this.registerRelayerEvents(),this.registerExpirerEvents(),this.registerPairingEvents(),this.client.core.pairing.register({methods:Object.keys(rs)}),this.initialized=!0,setTimeout(()=>{this.sessionRequestQueue.queue=this.getPendingSessionRequests(),this.processSessionRequestQueue()},ue.toMiliseconds(this.requestQueueDelay)))},this.connect=async r=>{await this.isInitialized();const s=is(gr({},r),{requiredNamespaces:r.requiredNamespaces||{},optionalNamespaces:r.optionalNamespaces||{}});await this.isValidConnect(s);const{pairingTopic:a,requiredNamespaces:u,optionalNamespaces:f,sessionProperties:g,relays:_}=s;let T=a,C,F=!1;if(T&&(F=this.client.core.pairing.pairings.get(T).active),!T||!F){const{topic:w,uri:S}=await this.client.core.pairing.create();T=w,C=S}const V=await this.client.core.crypto.generateKeyPair(),k=gr({requiredNamespaces:u,optionalNamespaces:f,relays:_??[{protocol:Hd}],proposer:{publicKey:V,metadata:this.client.metadata}},g&&{sessionProperties:g}),{reject:W,resolve:Y,done:X}=En(ue.FIVE_MINUTES,Jd);if(this.events.once(Ft("session_connect"),async({error:w,session:S})=>{if(w)W(w);else if(S){S.self.publicKey=V;const I=is(gr({},S),{requiredNamespaces:S.requiredNamespaces,optionalNamespaces:S.optionalNamespaces});await this.client.session.set(S.topic,I),await this.setExpiry(S.topic,S.expiry),T&&await this.client.core.pairing.updateMetadata({topic:T,metadata:S.peer.metadata}),Y(I)}}),!T){const{message:w}=re("NO_MATCHING_KEY",`connect() pairing topic: ${T}`);throw new Error(w)}const he=await this.sendRequest({topic:T,method:"wc_sessionPropose",params:k}),y=zr(ue.FIVE_MINUTES);return await this.setProposal(he,gr({id:he,expiry:y},k)),{uri:C,approval:X}},this.pair=async r=>(await this.isInitialized(),await this.client.core.pairing.pair(r)),this.approve=async r=>{await this.isInitialized(),await this.isValidApprove(r);const{id:s,relayProtocol:a,namespaces:u,sessionProperties:f}=r,g=this.client.proposal.get(s);let{pairingTopic:_,proposer:T,requiredNamespaces:C,optionalNamespaces:F}=g;_=_||"",cs(C)||(C=t_(u,"approve()"));const V=await this.client.core.crypto.generateKeyPair(),k=T.publicKey,W=await this.client.core.crypto.generateSharedKey(V,k);_&&s&&(await this.client.core.pairing.updateMetadata({topic:_,metadata:T.metadata}),await this.sendResult({id:s,topic:_,result:{relay:{protocol:a??"irn"},responderPublicKey:V}}),await this.client.proposal.delete(s,Bt("USER_DISCONNECTED")),await this.client.core.pairing.activate({topic:_}));const Y=gr({relay:{protocol:a??"irn"},namespaces:u,requiredNamespaces:C,optionalNamespaces:F,pairingTopic:_,controller:{publicKey:V,metadata:this.client.metadata},expiry:zr(So)},f&&{sessionProperties:f});await this.client.core.relayer.subscribe(W),await this.sendRequest({topic:W,method:"wc_sessionSettle",params:Y,throwOnFailedPublish:!0});const X=is(gr({},Y),{topic:W,pairingTopic:_,acknowledged:!1,self:Y.controller,peer:{publicKey:T.publicKey,metadata:T.metadata},controller:V});return await this.client.session.set(W,X),await this.setExpiry(W,zr(So)),{topic:W,acknowledged:()=>new Promise(he=>setTimeout(()=>he(this.client.session.get(W)),500))}},this.reject=async r=>{await this.isInitialized(),await this.isValidReject(r);const{id:s,reason:a}=r,{pairingTopic:u}=this.client.proposal.get(s);u&&(await this.sendError(s,u,a),await this.client.proposal.delete(s,Bt("USER_DISCONNECTED")))},this.update=async r=>{await this.isInitialized(),await this.isValidUpdate(r);const{topic:s,namespaces:a}=r,u=await this.sendRequest({topic:s,method:"wc_sessionUpdate",params:{namespaces:a}}),{done:f,resolve:g,reject:_}=En();return this.events.once(Ft("session_update",u),({error:T})=>{T?_(T):g()}),await this.client.session.update(s,{namespaces:a}),{acknowledged:f}},this.extend=async r=>{await this.isInitialized(),await this.isValidExtend(r);const{topic:s}=r,a=await this.sendRequest({topic:s,method:"wc_sessionExtend",params:{}}),{done:u,resolve:f,reject:g}=En();return this.events.once(Ft("session_extend",a),({error:_})=>{_?g(_):f()}),await this.setExpiry(s,zr(So)),{acknowledged:u}},this.request=async r=>{await this.isInitialized(),await this.isValidRequest(r);const{chainId:s,request:a,topic:u,expiry:f}=r,g=tu(),{done:_,resolve:T,reject:C}=En(f);return this.events.once(Ft("session_request",g),({error:F,result:V})=>{F?C(F):T(V)}),await Promise.all([new Promise(async F=>{await this.sendRequest({clientRpcId:g,topic:u,method:"wc_sessionRequest",params:{request:a,chainId:s},expiry:f,throwOnFailedPublish:!0}).catch(V=>C(V)),this.client.events.emit("session_request_sent",{topic:u,request:a,chainId:s,id:g}),F()}),new Promise(async F=>{const V=await this.client.core.storage.getItem(wf);zw({id:g,topic:u,wcDeepLink:V}),F()}),_()]).then(F=>F[2])},this.respond=async r=>{await this.isInitialized(),await this.isValidRespond(r);const{topic:s,response:a}=r,{id:u}=a;pi(a)?await this.sendResult({id:u,topic:s,result:a.result,throwOnFailedPublish:!0}):kr(a)&&await this.sendError(u,s,a.error),this.cleanupAfterResponse(r)},this.ping=async r=>{await this.isInitialized(),await this.isValidPing(r);const{topic:s}=r;if(this.client.session.keys.includes(s)){const a=await this.sendRequest({topic:s,method:"wc_sessionPing",params:{}}),{done:u,resolve:f,reject:g}=En();this.events.once(Ft("session_ping",a),({error:_})=>{_?g(_):f()}),await u()}else this.client.core.pairing.pairings.keys.includes(s)&&await this.client.core.pairing.ping({topic:s})},this.emit=async r=>{await this.isInitialized(),await this.isValidEmit(r);const{topic:s,event:a,chainId:u}=r;await this.sendRequest({topic:s,method:"wc_sessionEvent",params:{event:a,chainId:u}})},this.disconnect=async r=>{await this.isInitialized(),await this.isValidDisconnect(r);const{topic:s}=r;this.client.session.keys.includes(s)?(await this.sendRequest({topic:s,method:"wc_sessionDelete",params:Bt("USER_DISCONNECTED"),throwOnFailedPublish:!0}),await this.deleteSession(s)):await this.client.core.pairing.disconnect({topic:s})},this.find=r=>(this.isInitialized(),this.client.session.getAll().filter(s=>n_(s,r))),this.getPendingSessionRequests=()=>(this.isInitialized(),this.client.pendingRequest.getAll()),this.cleanupDuplicatePairings=async r=>{if(r.pairingTopic)try{const s=this.client.core.pairing.pairings.get(r.pairingTopic),a=this.client.core.pairing.pairings.getAll().filter(u=>{var f,g;return((f=u.peerMetadata)==null?void 0:f.url)&&((g=u.peerMetadata)==null?void 0:g.url)===r.peer.metadata.url&&u.topic&&u.topic!==s.topic});if(a.length===0)return;this.client.logger.info(`Cleaning up ${a.length} duplicate pairing(s)`),await Promise.all(a.map(u=>this.client.core.pairing.disconnect({topic:u.topic}))),this.client.logger.info("Duplicate pairings clean up finished")}catch(s){this.client.logger.error(s)}},this.deleteSession=async(r,s)=>{const{self:a}=this.client.session.get(r);await this.client.core.relayer.unsubscribe(r),this.client.session.delete(r,Bt("USER_DISCONNECTED")),this.client.core.crypto.keychain.has(a.publicKey)&&await this.client.core.crypto.deleteKeyPair(a.publicKey),this.client.core.crypto.keychain.has(r)&&await this.client.core.crypto.deleteSymKey(r),s||this.client.core.expirer.del(r),this.client.core.storage.removeItem(wf).catch(u=>this.client.logger.warn(u))},this.deleteProposal=async(r,s)=>{await Promise.all([this.client.proposal.delete(r,Bt("USER_DISCONNECTED")),s?Promise.resolve():this.client.core.expirer.del(r)])},this.deletePendingSessionRequest=async(r,s,a=!1)=>{await Promise.all([this.client.pendingRequest.delete(r,s),a?Promise.resolve():this.client.core.expirer.del(r)]),this.sessionRequestQueue.queue=this.sessionRequestQueue.queue.filter(u=>u.id!==r),a&&(this.sessionRequestQueue.state=di.idle)},this.setExpiry=async(r,s)=>{this.client.session.keys.includes(r)&&await this.client.session.update(r,{expiry:s}),this.client.core.expirer.set(r,s)},this.setProposal=async(r,s)=>{await this.client.proposal.set(r,s),this.client.core.expirer.set(r,s.expiry)},this.setPendingSessionRequest=async r=>{const s=rs.wc_sessionRequest.req.ttl,{id:a,topic:u,params:f,verifyContext:g}=r;await this.client.pendingRequest.set(a,{id:a,topic:u,params:f,verifyContext:g}),s&&this.client.core.expirer.set(a,zr(s))},this.sendRequest=async r=>{const{topic:s,method:a,params:u,expiry:f,relayRpcId:g,clientRpcId:_,throwOnFailedPublish:T}=r,C=xn(a,u,_);if(ps()&&LS.includes(a)){const k=Sn(JSON.stringify(C));this.client.core.verify.register({attestationId:k})}const F=await this.client.core.crypto.encode(s,C),V=rs[a].req;return f&&(V.ttl=f),g&&(V.id=g),this.client.core.history.set(s,C),T?(V.internal=is(gr({},V.internal),{throwOnFailedPublish:!0}),await this.client.core.relayer.publish(s,F,V)):this.client.core.relayer.publish(s,F,V).catch(k=>this.client.logger.error(k)),C.id},this.sendResult=async r=>{const{id:s,topic:a,result:u,throwOnFailedPublish:f}=r,g=ru(s,u),_=await this.client.core.crypto.encode(a,g),T=await this.client.core.history.get(a,s),C=rs[T.request.method].res;f?(C.internal=is(gr({},C.internal),{throwOnFailedPublish:!0}),await this.client.core.relayer.publish(a,_,C)):this.client.core.relayer.publish(a,_,C).catch(F=>this.client.logger.error(F)),await this.client.core.history.resolve(g)},this.sendError=async(r,s,a)=>{const u=ko(r,a),f=await this.client.core.crypto.encode(s,u),g=await this.client.core.history.get(s,r),_=rs[g.request.method].res;this.client.core.relayer.publish(s,f,_),await this.client.core.history.resolve(u)},this.cleanup=async()=>{const r=[],s=[];this.client.session.getAll().forEach(a=>{Oi(a.expiry)&&r.push(a.topic)}),this.client.proposal.getAll().forEach(a=>{Oi(a.expiry)&&s.push(a.id)}),await Promise.all([...r.map(a=>this.deleteSession(a)),...s.map(a=>this.deleteProposal(a))])},this.onRelayEventRequest=async r=>{this.requestQueue.queue.push(r),await this.processRequestsQueue()},this.processRequestsQueue=async()=>{if(this.requestQueue.state===di.active){this.client.logger.info("Request queue already active, skipping...");return}for(this.client.logger.info(`Request queue starting with ${this.requestQueue.queue.length} requests`);this.requestQueue.queue.length>0;){this.requestQueue.state=di.active;const r=this.requestQueue.queue.shift();if(r)try{this.processRequest(r),await new Promise(s=>setTimeout(s,300))}catch(s){this.client.logger.warn(s)}}this.requestQueue.state=di.idle},this.processRequest=r=>{const{topic:s,payload:a}=r,u=a.method;switch(u){case"wc_sessionPropose":return this.onSessionProposeRequest(s,a);case"wc_sessionSettle":return this.onSessionSettleRequest(s,a);case"wc_sessionUpdate":return this.onSessionUpdateRequest(s,a);case"wc_sessionExtend":return this.onSessionExtendRequest(s,a);case"wc_sessionPing":return this.onSessionPingRequest(s,a);case"wc_sessionDelete":return this.onSessionDeleteRequest(s,a);case"wc_sessionRequest":return this.onSessionRequest(s,a);case"wc_sessionEvent":return this.onSessionEventRequest(s,a);default:return this.client.logger.info(`Unsupported request method ${u}`)}},this.onRelayEventResponse=async r=>{const{topic:s,payload:a}=r,u=(await this.client.core.history.get(s,a.id)).request.method;switch(u){case"wc_sessionPropose":return this.onSessionProposeResponse(s,a);case"wc_sessionSettle":return this.onSessionSettleResponse(s,a);case"wc_sessionUpdate":return this.onSessionUpdateResponse(s,a);case"wc_sessionExtend":return this.onSessionExtendResponse(s,a);case"wc_sessionPing":return this.onSessionPingResponse(s,a);case"wc_sessionRequest":return this.onSessionRequestResponse(s,a);default:return this.client.logger.info(`Unsupported response method ${u}`)}},this.onRelayEventUnknownPayload=r=>{const{topic:s}=r,{message:a}=re("MISSING_OR_INVALID",`Decoded payload on topic ${s} is not identifiable as a JSON-RPC request or a response.`);throw new Error(a)},this.onSessionProposeRequest=async(r,s)=>{const{params:a,id:u}=s;try{this.isValidConnect(gr({},s.params));const f=zr(ue.FIVE_MINUTES),g=gr({id:u,pairingTopic:r,expiry:f},a);await this.setProposal(u,g);const _=Sn(JSON.stringify(s)),T=await this.getVerifyContext(_,g.proposer.metadata);this.client.events.emit("session_proposal",{id:u,params:g,verifyContext:T})}catch(f){await this.sendError(u,r,f),this.client.logger.error(f)}},this.onSessionProposeResponse=async(r,s)=>{const{id:a}=s;if(pi(s)){const{result:u}=s;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",result:u});const f=this.client.proposal.get(a);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",proposal:f});const g=f.proposer.publicKey;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",selfPublicKey:g});const _=u.responderPublicKey;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",peerPublicKey:_});const T=await this.client.core.crypto.generateSharedKey(g,_);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",sessionTopic:T});const C=await this.client.core.relayer.subscribe(T);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",subscriptionId:C}),await this.client.core.pairing.activate({topic:r})}else kr(s)&&(await this.client.proposal.delete(a,Bt("USER_DISCONNECTED")),this.events.emit(Ft("session_connect"),{error:s.error}))},this.onSessionSettleRequest=async(r,s)=>{const{id:a,params:u}=s;try{this.isValidSessionSettleRequest(u);const{relay:f,controller:g,expiry:_,namespaces:T,requiredNamespaces:C,optionalNamespaces:F,sessionProperties:V,pairingTopic:k}=s.params,W=gr({topic:r,relay:f,expiry:_,namespaces:T,acknowledged:!0,pairingTopic:k,requiredNamespaces:C,optionalNamespaces:F,controller:g.publicKey,self:{publicKey:"",metadata:this.client.metadata},peer:{publicKey:g.publicKey,metadata:g.metadata}},V&&{sessionProperties:V});await this.sendResult({id:s.id,topic:r,result:!0}),this.events.emit(Ft("session_connect"),{session:W}),this.cleanupDuplicatePairings(W)}catch(f){await this.sendError(a,r,f),this.client.logger.error(f)}},this.onSessionSettleResponse=async(r,s)=>{const{id:a}=s;pi(s)?(await this.client.session.update(r,{acknowledged:!0}),this.events.emit(Ft("session_approve",a),{})):kr(s)&&(await this.client.session.delete(r,Bt("USER_DISCONNECTED")),this.events.emit(Ft("session_approve",a),{error:s.error}))},this.onSessionUpdateRequest=async(r,s)=>{const{params:a,id:u}=s;try{const f=`${r}_session_update`,g=Io.get(f);if(g&&this.isRequestOutOfSync(g,u)){this.client.logger.info(`Discarding out of sync request - ${u}`);return}this.isValidUpdate(gr({topic:r},a)),await this.client.session.update(r,{namespaces:a.namespaces}),await this.sendResult({id:u,topic:r,result:!0}),this.client.events.emit("session_update",{id:u,topic:r,params:a}),Io.set(f,u)}catch(f){await this.sendError(u,r,f),this.client.logger.error(f)}},this.isRequestOutOfSync=(r,s)=>parseInt(s.toString().slice(0,-3))<=parseInt(r.toString().slice(0,-3)),this.onSessionUpdateResponse=(r,s)=>{const{id:a}=s;pi(s)?this.events.emit(Ft("session_update",a),{}):kr(s)&&this.events.emit(Ft("session_update",a),{error:s.error})},this.onSessionExtendRequest=async(r,s)=>{const{id:a}=s;try{this.isValidExtend({topic:r}),await this.setExpiry(r,zr(So)),await this.sendResult({id:a,topic:r,result:!0}),this.client.events.emit("session_extend",{id:a,topic:r})}catch(u){await this.sendError(a,r,u),this.client.logger.error(u)}},this.onSessionExtendResponse=(r,s)=>{const{id:a}=s;pi(s)?this.events.emit(Ft("session_extend",a),{}):kr(s)&&this.events.emit(Ft("session_extend",a),{error:s.error})},this.onSessionPingRequest=async(r,s)=>{const{id:a}=s;try{this.isValidPing({topic:r}),await this.sendResult({id:a,topic:r,result:!0}),this.client.events.emit("session_ping",{id:a,topic:r})}catch(u){await this.sendError(a,r,u),this.client.logger.error(u)}},this.onSessionPingResponse=(r,s)=>{const{id:a}=s;setTimeout(()=>{pi(s)?this.events.emit(Ft("session_ping",a),{}):kr(s)&&this.events.emit(Ft("session_ping",a),{error:s.error})},500)},this.onSessionDeleteRequest=async(r,s)=>{const{id:a}=s;try{this.isValidDisconnect({topic:r,reason:s.params}),await Promise.all([new Promise(u=>{this.client.core.relayer.once(Xt.publish,async()=>{u(await this.deleteSession(r))})}),this.sendResult({id:a,topic:r,result:!0})]),this.client.events.emit("session_delete",{id:a,topic:r})}catch(u){this.client.logger.error(u)}},this.onSessionRequest=async(r,s)=>{const{id:a,params:u}=s;try{this.isValidRequest(gr({topic:r},u));const f=Sn(JSON.stringify(xn("wc_sessionRequest",u,a))),g=this.client.session.get(r),_=await this.getVerifyContext(f,g.peer.metadata),T={id:a,topic:r,params:u,verifyContext:_};await this.setPendingSessionRequest(T),this.addSessionRequestToSessionRequestQueue(T),this.processSessionRequestQueue()}catch(f){await this.sendError(a,r,f),this.client.logger.error(f)}},this.onSessionRequestResponse=(r,s)=>{const{id:a}=s;pi(s)?this.events.emit(Ft("session_request",a),{result:s.result}):kr(s)&&this.events.emit(Ft("session_request",a),{error:s.error})},this.onSessionEventRequest=async(r,s)=>{const{id:a,params:u}=s;try{const f=`${r}_session_event_${u.event.name}`,g=Io.get(f);if(g&&this.isRequestOutOfSync(g,a)){this.client.logger.info(`Discarding out of sync request - ${a}`);return}this.isValidEmit(gr({topic:r},u)),this.client.events.emit("session_event",{id:a,topic:r,params:u}),Io.set(f,a)}catch(f){await this.sendError(a,r,f),this.client.logger.error(f)}},this.addSessionRequestToSessionRequestQueue=r=>{this.sessionRequestQueue.queue.push(r)},this.cleanupAfterResponse=r=>{this.deletePendingSessionRequest(r.response.id,{message:"fulfilled",code:0}),setTimeout(()=>{this.sessionRequestQueue.state=di.idle,this.processSessionRequestQueue()},ue.toMiliseconds(this.requestQueueDelay))},this.processSessionRequestQueue=()=>{if(this.sessionRequestQueue.state===di.active){this.client.logger.info("session request queue is already active.");return}const r=this.sessionRequestQueue.queue[0];if(!r){this.client.logger.info("session request queue is empty.");return}try{this.sessionRequestQueue.state=di.active,this.client.events.emit("session_request",r)}catch(s){this.client.logger.error(s)}},this.onPairingCreated=r=>{if(r.active)return;const s=this.client.proposal.getAll().find(a=>a.pairingTopic===r.topic);s&&this.onSessionProposeRequest(r.topic,xn("wc_sessionPropose",{requiredNamespaces:s.requiredNamespaces,optionalNamespaces:s.optionalNamespaces,relays:s.relays,proposer:s.proposer},s.id))},this.isValidConnect=async r=>{if(!yr(r)){const{message:_}=re("MISSING_OR_INVALID",`connect() params: ${JSON.stringify(r)}`);throw new Error(_)}const{pairingTopic:s,requiredNamespaces:a,optionalNamespaces:u,sessionProperties:f,relays:g}=r;if(or(s)||await this.isValidPairingTopic(s),!y_(g,!0)){const{message:_}=re("MISSING_OR_INVALID",`connect() relays: ${g}`);throw new Error(_)}!or(a)&&cs(a)!==0&&this.validateNamespaces(a,"requiredNamespaces"),!or(u)&&cs(u)!==0&&this.validateNamespaces(u,"optionalNamespaces"),or(f)||this.validateSessionProps(f,"sessionProperties")},this.validateNamespaces=(r,s)=>{const a=g_(r,"connect()",s);if(a)throw new Error(a.message)},this.isValidApprove=async r=>{if(!yr(r))throw new Error(re("MISSING_OR_INVALID",`approve() params: ${r}`).message);const{id:s,namespaces:a,relayProtocol:u,sessionProperties:f}=r;await this.isValidProposalId(s);const g=this.client.proposal.get(s),_=Ao(a,"approve()");if(_)throw new Error(_.message);const T=Hl(g.requiredNamespaces,a,"approve()");if(T)throw new Error(T.message);if(!Ht(u,!0)){const{message:C}=re("MISSING_OR_INVALID",`approve() relayProtocol: ${u}`);throw new Error(C)}or(f)||this.validateSessionProps(f,"sessionProperties")},this.isValidReject=async r=>{if(!yr(r)){const{message:u}=re("MISSING_OR_INVALID",`reject() params: ${r}`);throw new Error(u)}const{id:s,reason:a}=r;if(await this.isValidProposalId(s),!v_(a)){const{message:u}=re("MISSING_OR_INVALID",`reject() reason: ${JSON.stringify(a)}`);throw new Error(u)}},this.isValidSessionSettleRequest=r=>{if(!yr(r)){const{message:T}=re("MISSING_OR_INVALID",`onSessionSettleRequest() params: ${r}`);throw new Error(T)}const{relay:s,controller:a,namespaces:u,expiry:f}=r;if(!Sd(s)){const{message:T}=re("MISSING_OR_INVALID","onSessionSettleRequest() relay protocol should be a string");throw new Error(T)}const g=u_(a,"onSessionSettleRequest()");if(g)throw new Error(g.message);const _=Ao(u,"onSessionSettleRequest()");if(_)throw new Error(_.message);if(Oi(f)){const{message:T}=re("EXPIRED","onSessionSettleRequest()");throw new Error(T)}},this.isValidUpdate=async r=>{if(!yr(r)){const{message:_}=re("MISSING_OR_INVALID",`update() params: ${r}`);throw new Error(_)}const{topic:s,namespaces:a}=r;await this.isValidSessionTopic(s);const u=this.client.session.get(s),f=Ao(a,"update()");if(f)throw new Error(f.message);const g=Hl(u.requiredNamespaces,a,"update()");if(g)throw new Error(g.message)},this.isValidExtend=async r=>{if(!yr(r)){const{message:a}=re("MISSING_OR_INVALID",`extend() params: ${r}`);throw new Error(a)}const{topic:s}=r;await this.isValidSessionTopic(s)},this.isValidRequest=async r=>{if(!yr(r)){const{message:_}=re("MISSING_OR_INVALID",`request() params: ${r}`);throw new Error(_)}const{topic:s,request:a,chainId:u,expiry:f}=r;await this.isValidSessionTopic(s);const{namespaces:g}=this.client.session.get(s);if(!Bl(g,u)){const{message:_}=re("MISSING_OR_INVALID",`request() chainId: ${u}`);throw new Error(_)}if(!b_(a)){const{message:_}=re("MISSING_OR_INVALID",`request() ${JSON.stringify(a)}`);throw new Error(_)}if(!E_(g,u,a.method)){const{message:_}=re("MISSING_OR_INVALID",`request() method: ${a.method}`);throw new Error(_)}if(f&&!O_(f,Tc)){const{message:_}=re("MISSING_OR_INVALID",`request() expiry: ${f}. Expiry must be a number (in seconds) between ${Tc.min} and ${Tc.max}`);throw new Error(_)}},this.isValidRespond=async r=>{if(!yr(r)){const{message:u}=re("MISSING_OR_INVALID",`respond() params: ${r}`);throw new Error(u)}const{topic:s,response:a}=r;if(await this.isValidSessionTopic(s),!w_(a)){const{message:u}=re("MISSING_OR_INVALID",`respond() response: ${JSON.stringify(a)}`);throw new Error(u)}},this.isValidPing=async r=>{if(!yr(r)){const{message:a}=re("MISSING_OR_INVALID",`ping() params: ${r}`);throw new Error(a)}const{topic:s}=r;await this.isValidSessionOrPairingTopic(s)},this.isValidEmit=async r=>{if(!yr(r)){const{message:g}=re("MISSING_OR_INVALID",`emit() params: ${r}`);throw new Error(g)}const{topic:s,event:a,chainId:u}=r;await this.isValidSessionTopic(s);const{namespaces:f}=this.client.session.get(s);if(!Bl(f,u)){const{message:g}=re("MISSING_OR_INVALID",`emit() chainId: ${u}`);throw new Error(g)}if(!__(a)){const{message:g}=re("MISSING_OR_INVALID",`emit() event: ${JSON.stringify(a)}`);throw new Error(g)}if(!I_(f,u,a.name)){const{message:g}=re("MISSING_OR_INVALID",`emit() event: ${JSON.stringify(a)}`);throw new Error(g)}},this.isValidDisconnect=async r=>{if(!yr(r)){const{message:a}=re("MISSING_OR_INVALID",`disconnect() params: ${r}`);throw new Error(a)}const{topic:s}=r;await this.isValidSessionOrPairingTopic(s)},this.getVerifyContext=async(r,s)=>{const a={verified:{verifyUrl:s.verifyUrl||Co,validation:"UNKNOWN",origin:s.url||""}};try{const u=await this.client.core.verify.resolve({attestationId:r,verifyUrl:s.verifyUrl});u&&(a.verified.origin=u.origin,a.verified.isScam=u.isScam,a.verified.validation=u.origin===new URL(s.url).origin?"VALID":"INVALID")}catch(u){this.client.logger.info(u)}return this.client.logger.info(`Verify context: ${JSON.stringify(a)}`),a},this.validateSessionProps=(r,s)=>{Object.values(r).forEach(a=>{if(!Ht(a,!1)){const{message:u}=re("MISSING_OR_INVALID",`${s} must be in Record<string, string> format. Received: ${JSON.stringify(a)}`);throw new Error(u)}})}}async isInitialized(){if(!this.initialized){const{message:t}=re("NOT_INITIALIZED",this.name);throw new Error(t)}await this.client.core.relayer.confirmOnlineStateOrThrow()}registerRelayerEvents(){this.client.core.relayer.on(Xt.message,async t=>{const{topic:r,message:s}=t;if(this.ignoredPayloadTypes.includes(this.client.core.crypto.getPayloadType(s)))return;const a=await this.client.core.crypto.decode(r,s);try{iu(a)?(this.client.core.history.set(r,a),this.onRelayEventRequest({topic:r,payload:a})):Bo(a)?(await this.client.core.history.resolve(a),await this.onRelayEventResponse({topic:r,payload:a}),this.client.core.history.delete(r,a.id)):this.onRelayEventUnknownPayload({topic:r,payload:a})}catch(u){this.client.logger.error(u)}})}registerExpirerEvents(){this.client.core.expirer.on(Lr.expired,async t=>{const{topic:r,id:s}=Ed(t.target);if(s&&this.client.pendingRequest.keys.includes(s))return await this.deletePendingSessionRequest(s,re("EXPIRED"),!0);r?this.client.session.keys.includes(r)&&(await this.deleteSession(r,!0),this.client.events.emit("session_expire",{topic:r})):s&&(await this.deleteProposal(s,!0),this.client.events.emit("proposal_expire",{id:s}))})}registerPairingEvents(){this.client.core.pairing.events.on(ss.create,t=>this.onPairingCreated(t))}isValidPairingTopic(t){if(!Ht(t,!1)){const{message:r}=re("MISSING_OR_INVALID",`pairing topic should be a string: ${t}`);throw new Error(r)}if(!this.client.core.pairing.pairings.keys.includes(t)){const{message:r}=re("NO_MATCHING_KEY",`pairing topic doesn't exist: ${t}`);throw new Error(r)}if(Oi(this.client.core.pairing.pairings.get(t).expiry)){const{message:r}=re("EXPIRED",`pairing topic: ${t}`);throw new Error(r)}}async isValidSessionTopic(t){if(!Ht(t,!1)){const{message:r}=re("MISSING_OR_INVALID",`session topic should be a string: ${t}`);throw new Error(r)}if(!this.client.session.keys.includes(t)){const{message:r}=re("NO_MATCHING_KEY",`session topic doesn't exist: ${t}`);throw new Error(r)}if(Oi(this.client.session.get(t).expiry)){await this.deleteSession(t);const{message:r}=re("EXPIRED",`session topic: ${t}`);throw new Error(r)}}async isValidSessionOrPairingTopic(t){if(this.client.session.keys.includes(t))await this.isValidSessionTopic(t);else if(this.client.core.pairing.pairings.keys.includes(t))this.isValidPairingTopic(t);else if(Ht(t,!1)){const{message:r}=re("NO_MATCHING_KEY",`session or pairing topic doesn't exist: ${t}`);throw new Error(r)}else{const{message:r}=re("MISSING_OR_INVALID",`session or pairing topic should be a string: ${t}`);throw new Error(r)}}async isValidProposalId(t){if(!m_(t)){const{message:r}=re("MISSING_OR_INVALID",`proposal id should be a number: ${t}`);throw new Error(r)}if(!this.client.proposal.keys.includes(t)){const{message:r}=re("NO_MATCHING_KEY",`proposal id doesn't exist: ${t}`);throw new Error(r)}if(Oi(this.client.proposal.get(t).expiry)){await this.deleteProposal(t);const{message:r}=re("EXPIRED",`proposal id: ${t}`);throw new Error(r)}}}class zS extends Vo{constructor(t,r){super(t,r,CS,ou),this.core=t,this.logger=r}}class kS extends Vo{constructor(t,r){super(t,r,RS,ou),this.core=t,this.logger=r}}class BS extends Vo{constructor(t,r){super(t,r,$S,ou,s=>s.id),this.core=t,this.logger=r}}let HS=class Qd extends Pb{constructor(t){super(t),this.protocol=Kd,this.version=Wd,this.name=Pc.name,this.events=new Vt.EventEmitter,this.on=(s,a)=>this.events.on(s,a),this.once=(s,a)=>this.events.once(s,a),this.off=(s,a)=>this.events.off(s,a),this.removeListener=(s,a)=>this.events.removeListener(s,a),this.removeAllListeners=s=>this.events.removeAllListeners(s),this.connect=async s=>{try{return await this.engine.connect(s)}catch(a){throw this.logger.error(a.message),a}},this.pair=async s=>{try{return await this.engine.pair(s)}catch(a){throw this.logger.error(a.message),a}},this.approve=async s=>{try{return await this.engine.approve(s)}catch(a){throw this.logger.error(a.message),a}},this.reject=async s=>{try{return await this.engine.reject(s)}catch(a){throw this.logger.error(a.message),a}},this.update=async s=>{try{return await this.engine.update(s)}catch(a){throw this.logger.error(a.message),a}},this.extend=async s=>{try{return await this.engine.extend(s)}catch(a){throw this.logger.error(a.message),a}},this.request=async s=>{try{return await this.engine.request(s)}catch(a){throw this.logger.error(a.message),a}},this.respond=async s=>{try{return await this.engine.respond(s)}catch(a){throw this.logger.error(a.message),a}},this.ping=async s=>{try{return await this.engine.ping(s)}catch(a){throw this.logger.error(a.message),a}},this.emit=async s=>{try{return await this.engine.emit(s)}catch(a){throw this.logger.error(a.message),a}},this.disconnect=async s=>{try{return await this.engine.disconnect(s)}catch(a){throw this.logger.error(a.message),a}},this.find=s=>{try{return this.engine.find(s)}catch(a){throw this.logger.error(a.message),a}},this.getPendingSessionRequests=()=>{try{return this.engine.getPendingSessionRequests()}catch(s){throw this.logger.error(s.message),s}},this.name=(t==null?void 0:t.name)||Pc.name,this.metadata=(t==null?void 0:t.metadata)||Lw();const r=typeof(t==null?void 0:t.logger)<"u"&&typeof(t==null?void 0:t.logger)!="string"?t.logger:Ne.pino(Ne.getDefaultLoggerOptions({level:(t==null?void 0:t.logger)||Pc.logger}));this.core=(t==null?void 0:t.core)||new AS(t),this.logger=Ne.generateChildLogger(r,this.name),this.session=new kS(this.core,this.logger),this.proposal=new zS(this.core,this.logger),this.pendingRequest=new BS(this.core,this.logger),this.engine=new qS(this)}static async init(t){const r=new Qd(t);return await r.initialize(),r}get context(){return Ne.getLoggerContext(this.logger)}get pairing(){return this.core.pairing.pairings}async initialize(){this.logger.trace("Initialized");try{await this.core.start(),await this.session.init(),await this.proposal.init(),await this.pendingRequest.init(),await this.engine.init(),this.core.verify.init({verifyUrl:this.metadata.verifyUrl}),this.logger.info("SignClient Initialization Success")}catch(t){throw this.logger.info("SignClient Initialization Failure"),this.logger.error(t.message),t}}};var Xe={};Object.defineProperty(Xe,"__esModule",{value:!0});Xe.getLocalStorage=Xe.getLocalStorageOrThrow=Xe.getCrypto=Xe.getCryptoOrThrow=Xe.getLocation=Xe.getLocationOrThrow=Xe.getNavigator=Xe.getNavigatorOrThrow=Xe.getDocument=Xe.getDocumentOrThrow=Xe.getFromWindowOrThrow=Xe.getFromWindow=void 0;function Yi(n){let t;return typeof window<"u"&&typeof window[n]<"u"&&(t=window[n]),t}Xe.getFromWindow=Yi;function An(n){const t=Yi(n);if(!t)throw new Error(`${n} is not defined in Window`);return t}Xe.getFromWindowOrThrow=An;function VS(){return An("document")}Xe.getDocumentOrThrow=VS;function KS(){return Yi("document")}Xe.getDocument=KS;function WS(){return An("navigator")}Xe.getNavigatorOrThrow=WS;function GS(){return Yi("navigator")}Xe.getNavigator=GS;function JS(){return An("location")}Xe.getLocationOrThrow=JS;function QS(){return Yi("location")}Xe.getLocation=QS;function YS(){return An("crypto")}Xe.getCryptoOrThrow=YS;function XS(){return Yi("crypto")}Xe.getCrypto=XS;function ZS(){return An("localStorage")}Xe.getLocalStorageOrThrow=ZS;function ex(){return Yi("localStorage")}Xe.getLocalStorage=ex;var au={};Object.defineProperty(au,"__esModule",{value:!0});au.getWindowMetadata=void 0;const If=Xe;function tx(){let n,t;try{n=If.getDocumentOrThrow(),t=If.getLocationOrThrow()}catch{return null}function r(){const F=n.getElementsByTagName("link"),V=[];for(let k=0;k<F.length;k++){const W=F[k],Y=W.getAttribute("rel");if(Y&&Y.toLowerCase().indexOf("icon")>-1){const X=W.getAttribute("href");if(X)if(X.toLowerCase().indexOf("https:")===-1&&X.toLowerCase().indexOf("http:")===-1&&X.indexOf("//")!==0){let he=t.protocol+"//"+t.host;if(X.indexOf("/")===0)he+=X;else{const y=t.pathname.split("/");y.pop();const w=y.join("/");he+=w+"/"+X}V.push(he)}else if(X.indexOf("//")===0){const he=t.protocol+X;V.push(he)}else V.push(X)}}return V}function s(...F){const V=n.getElementsByTagName("meta");for(let k=0;k<V.length;k++){const W=V[k],Y=["itemprop","property","name"].map(X=>W.getAttribute(X)).filter(X=>X?F.includes(X):!1);if(Y.length&&Y){const X=W.getAttribute("content");if(X)return X}}return""}function a(){let F=s("name","og:site_name","og:title","twitter:title");return F||(F=n.title),F}function u(){return s("description","og:description","twitter:description","keywords")}const f=a(),g=u(),_=t.origin,T=r();return{description:g,url:_,icons:T,name:f}}au.getWindowMetadata=tx;var rx={};(function(n){const t=Bf,r=Hf,s=zf,a=kf,u=y=>y==null,f=Symbol("encodeFragmentIdentifier");function g(y){switch(y.arrayFormat){case"index":return w=>(S,I)=>{const v=S.length;return I===void 0||y.skipNull&&I===null||y.skipEmptyString&&I===""?S:I===null?[...S,[C(w,y),"[",v,"]"].join("")]:[...S,[C(w,y),"[",C(v,y),"]=",C(I,y)].join("")]};case"bracket":return w=>(S,I)=>I===void 0||y.skipNull&&I===null||y.skipEmptyString&&I===""?S:I===null?[...S,[C(w,y),"[]"].join("")]:[...S,[C(w,y),"[]=",C(I,y)].join("")];case"colon-list-separator":return w=>(S,I)=>I===void 0||y.skipNull&&I===null||y.skipEmptyString&&I===""?S:I===null?[...S,[C(w,y),":list="].join("")]:[...S,[C(w,y),":list=",C(I,y)].join("")];case"comma":case"separator":case"bracket-separator":{const w=y.arrayFormat==="bracket-separator"?"[]=":"=";return S=>(I,v)=>v===void 0||y.skipNull&&v===null||y.skipEmptyString&&v===""?I:(v=v===null?"":v,I.length===0?[[C(S,y),w,C(v,y)].join("")]:[[I,C(v,y)].join(y.arrayFormatSeparator)])}default:return w=>(S,I)=>I===void 0||y.skipNull&&I===null||y.skipEmptyString&&I===""?S:I===null?[...S,C(w,y)]:[...S,[C(w,y),"=",C(I,y)].join("")]}}function _(y){let w;switch(y.arrayFormat){case"index":return(S,I,v)=>{if(w=/\[(\d*)\]$/.exec(S),S=S.replace(/\[\d*\]$/,""),!w){v[S]=I;return}v[S]===void 0&&(v[S]={}),v[S][w[1]]=I};case"bracket":return(S,I,v)=>{if(w=/(\[\])$/.exec(S),S=S.replace(/\[\]$/,""),!w){v[S]=I;return}if(v[S]===void 0){v[S]=[I];return}v[S]=[].concat(v[S],I)};case"colon-list-separator":return(S,I,v)=>{if(w=/(:list)$/.exec(S),S=S.replace(/:list$/,""),!w){v[S]=I;return}if(v[S]===void 0){v[S]=[I];return}v[S]=[].concat(v[S],I)};case"comma":case"separator":return(S,I,v)=>{const N=typeof I=="string"&&I.includes(y.arrayFormatSeparator),L=typeof I=="string"&&!N&&F(I,y).includes(y.arrayFormatSeparator);I=L?F(I,y):I;const ie=N||L?I.split(y.arrayFormatSeparator).map(ne=>F(ne,y)):I===null?I:F(I,y);v[S]=ie};case"bracket-separator":return(S,I,v)=>{const N=/(\[\])$/.test(S);if(S=S.replace(/\[\]$/,""),!N){v[S]=I&&F(I,y);return}const L=I===null?[]:I.split(y.arrayFormatSeparator).map(ie=>F(ie,y));if(v[S]===void 0){v[S]=L;return}v[S]=[].concat(v[S],L)};default:return(S,I,v)=>{if(v[S]===void 0){v[S]=I;return}v[S]=[].concat(v[S],I)}}}function T(y){if(typeof y!="string"||y.length!==1)throw new TypeError("arrayFormatSeparator must be single character string")}function C(y,w){return w.encode?w.strict?t(y):encodeURIComponent(y):y}function F(y,w){return w.decode?r(y):y}function V(y){return Array.isArray(y)?y.sort():typeof y=="object"?V(Object.keys(y)).sort((w,S)=>Number(w)-Number(S)).map(w=>y[w]):y}function k(y){const w=y.indexOf("#");return w!==-1&&(y=y.slice(0,w)),y}function W(y){let w="";const S=y.indexOf("#");return S!==-1&&(w=y.slice(S)),w}function Y(y){y=k(y);const w=y.indexOf("?");return w===-1?"":y.slice(w+1)}function X(y,w){return w.parseNumbers&&!Number.isNaN(Number(y))&&typeof y=="string"&&y.trim()!==""?y=Number(y):w.parseBooleans&&y!==null&&(y.toLowerCase()==="true"||y.toLowerCase()==="false")&&(y=y.toLowerCase()==="true"),y}function he(y,w){w=Object.assign({decode:!0,sort:!0,arrayFormat:"none",arrayFormatSeparator:",",parseNumbers:!1,parseBooleans:!1},w),T(w.arrayFormatSeparator);const S=_(w),I=Object.create(null);if(typeof y!="string"||(y=y.trim().replace(/^[?#&]/,""),!y))return I;for(const v of y.split("&")){if(v==="")continue;let[N,L]=s(w.decode?v.replace(/\+/g," "):v,"=");L=L===void 0?null:["comma","separator","bracket-separator"].includes(w.arrayFormat)?L:F(L,w),S(F(N,w),L,I)}for(const v of Object.keys(I)){const N=I[v];if(typeof N=="object"&&N!==null)for(const L of Object.keys(N))N[L]=X(N[L],w);else I[v]=X(N,w)}return w.sort===!1?I:(w.sort===!0?Object.keys(I).sort():Object.keys(I).sort(w.sort)).reduce((v,N)=>{const L=I[N];return L&&typeof L=="object"&&!Array.isArray(L)?v[N]=V(L):v[N]=L,v},Object.create(null))}n.extract=Y,n.parse=he,n.stringify=(y,w)=>{if(!y)return"";w=Object.assign({encode:!0,strict:!0,arrayFormat:"none",arrayFormatSeparator:","},w),T(w.arrayFormatSeparator);const S=L=>w.skipNull&&u(y[L])||w.skipEmptyString&&y[L]==="",I=g(w),v={};for(const L of Object.keys(y))S(L)||(v[L]=y[L]);const N=Object.keys(v);return w.sort!==!1&&N.sort(w.sort),N.map(L=>{const ie=y[L];return ie===void 0?"":ie===null?C(L,w):Array.isArray(ie)?ie.length===0&&w.arrayFormat==="bracket-separator"?C(L,w)+"[]":ie.reduce(I(L),[]).join("&"):C(L,w)+"="+C(ie,w)}).filter(L=>L.length>0).join("&")},n.parseUrl=(y,w)=>{w=Object.assign({decode:!0},w);const[S,I]=s(y,"#");return Object.assign({url:S.split("?")[0]||"",query:he(Y(y),w)},w&&w.parseFragmentIdentifier&&I?{fragmentIdentifier:F(I,w)}:{})},n.stringifyUrl=(y,w)=>{w=Object.assign({encode:!0,strict:!0,[f]:!0},w);const S=k(y.url).split("?")[0]||"",I=n.extract(y.url),v=n.parse(I,{sort:!1}),N=Object.assign(v,y.query);let L=n.stringify(N,w);L&&(L=`?${L}`);let ie=W(y.url);return y.fragmentIdentifier&&(ie=`#${w[f]?C(y.fragmentIdentifier,w):y.fragmentIdentifier}`),`${S}${L}${ie}`},n.pick=(y,w,S)=>{S=Object.assign({parseFragmentIdentifier:!0,[f]:!1},S);const{url:I,query:v,fragmentIdentifier:N}=n.parseUrl(y,S);return n.stringifyUrl({url:I,query:a(v,w),fragmentIdentifier:N},S)},n.exclude=(y,w,S)=>{const I=Array.isArray(w)?v=>!w.includes(v):(v,N)=>!w(v,N);return n.pick(y,I,S)}})(rx);const ix=":";function nx(n){const[t,r]=n.split(ix);return{namespace:t,reference:r}}function Ac(n=[],t=[]){return[...new Set([...n,...t])]}function cu(n){return n.includes(":")}function os(n){return cu(n)?n.split(":")[0]:n}const sx={INVALID_METHOD:{message:"Invalid method.",code:1001},INVALID_EVENT:{message:"Invalid event.",code:1002},INVALID_UPDATE_REQUEST:{message:"Invalid update request.",code:1003},INVALID_EXTEND_REQUEST:{message:"Invalid extend request.",code:1004},INVALID_SESSION_SETTLE_REQUEST:{message:"Invalid session settle request.",code:1005},UNAUTHORIZED_METHOD:{message:"Unauthorized method.",code:3001},UNAUTHORIZED_EVENT:{message:"Unauthorized event.",code:3002},UNAUTHORIZED_UPDATE_REQUEST:{message:"Unauthorized update request.",code:3003},UNAUTHORIZED_EXTEND_REQUEST:{message:"Unauthorized extend request.",code:3004},USER_REJECTED:{message:"User rejected.",code:5e3},USER_REJECTED_CHAINS:{message:"User rejected chains.",code:5001},USER_REJECTED_METHODS:{message:"User rejected methods.",code:5002},USER_REJECTED_EVENTS:{message:"User rejected events.",code:5003},UNSUPPORTED_CHAINS:{message:"Unsupported chains.",code:5100},UNSUPPORTED_METHODS:{message:"Unsupported methods.",code:5101},UNSUPPORTED_EVENTS:{message:"Unsupported events.",code:5102},UNSUPPORTED_ACCOUNTS:{message:"Unsupported accounts.",code:5103},UNSUPPORTED_NAMESPACE_KEY:{message:"Unsupported namespace key.",code:5104},USER_DISCONNECTED:{message:"User disconnected.",code:6e3},SESSION_SETTLEMENT_FAILED:{message:"Session settlement failed.",code:7e3},WC_METHOD_UNSUPPORTED:{message:"Unsupported wc_ method.",code:10001}};function Sf(n,t){const{message:r,code:s}=sx[n];return{message:t?`${r} ${t}`:r,code:s}}function xf(n,t){return Array.isArray(n)?typeof t<"u"&&n.length?n.every(t):!0:!1}function ox(n){return Object.getPrototypeOf(n)===Object.prototype&&Object.keys(n).length}var Fo={},ax={get exports(){return Fo},set exports(n){Fo=n}};(function(n,t){var r=function(){function a(){this.fetch=!1,this.DOMException=globalThis.DOMException}return a.prototype=globalThis,new a}();(function(a){(function(u){var f={searchParams:"URLSearchParams"in a,iterable:"Symbol"in a&&"iterator"in Symbol,blob:"FileReader"in a&&"Blob"in a&&function(){try{return new Blob,!0}catch{return!1}}(),formData:"FormData"in a,arrayBuffer:"ArrayBuffer"in a};function g(D){return D&&DataView.prototype.isPrototypeOf(D)}if(f.arrayBuffer)var _=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],T=ArrayBuffer.isView||function(D){return D&&_.indexOf(Object.prototype.toString.call(D))>-1};function C(D){if(typeof D!="string"&&(D=String(D)),/[^a-z0-9\-#$%&'*+.^_`|~]/i.test(D))throw new TypeError("Invalid character in header field name");return D.toLowerCase()}function F(D){return typeof D!="string"&&(D=String(D)),D}function V(D){var E={next:function(){var U=D.shift();return{done:U===void 0,value:U}}};return f.iterable&&(E[Symbol.iterator]=function(){return E}),E}function k(D){this.map={},D instanceof k?D.forEach(function(E,U){this.append(U,E)},this):Array.isArray(D)?D.forEach(function(E){this.append(E[0],E[1])},this):D&&Object.getOwnPropertyNames(D).forEach(function(E){this.append(E,D[E])},this)}k.prototype.append=function(D,E){D=C(D),E=F(E);var U=this.map[D];this.map[D]=U?U+", "+E:E},k.prototype.delete=function(D){delete this.map[C(D)]},k.prototype.get=function(D){return D=C(D),this.has(D)?this.map[D]:null},k.prototype.has=function(D){return this.map.hasOwnProperty(C(D))},k.prototype.set=function(D,E){this.map[C(D)]=F(E)},k.prototype.forEach=function(D,E){for(var U in this.map)this.map.hasOwnProperty(U)&&D.call(E,this.map[U],U,this)},k.prototype.keys=function(){var D=[];return this.forEach(function(E,U){D.push(U)}),V(D)},k.prototype.values=function(){var D=[];return this.forEach(function(E){D.push(E)}),V(D)},k.prototype.entries=function(){var D=[];return this.forEach(function(E,U){D.push([U,E])}),V(D)},f.iterable&&(k.prototype[Symbol.iterator]=k.prototype.entries);function W(D){if(D.bodyUsed)return Promise.reject(new TypeError("Already read"));D.bodyUsed=!0}function Y(D){return new Promise(function(E,U){D.onload=function(){E(D.result)},D.onerror=function(){U(D.error)}})}function X(D){var E=new FileReader,U=Y(E);return E.readAsArrayBuffer(D),U}function he(D){var E=new FileReader,U=Y(E);return E.readAsText(D),U}function y(D){for(var E=new Uint8Array(D),U=new Array(E.length),ye=0;ye<E.length;ye++)U[ye]=String.fromCharCode(E[ye]);return U.join("")}function w(D){if(D.slice)return D.slice(0);var E=new Uint8Array(D.byteLength);return E.set(new Uint8Array(D)),E.buffer}function S(){return this.bodyUsed=!1,this._initBody=function(D){this._bodyInit=D,D?typeof D=="string"?this._bodyText=D:f.blob&&Blob.prototype.isPrototypeOf(D)?this._bodyBlob=D:f.formData&&FormData.prototype.isPrototypeOf(D)?this._bodyFormData=D:f.searchParams&&URLSearchParams.prototype.isPrototypeOf(D)?this._bodyText=D.toString():f.arrayBuffer&&f.blob&&g(D)?(this._bodyArrayBuffer=w(D.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer])):f.arrayBuffer&&(ArrayBuffer.prototype.isPrototypeOf(D)||T(D))?this._bodyArrayBuffer=w(D):this._bodyText=D=Object.prototype.toString.call(D):this._bodyText="",this.headers.get("content-type")||(typeof D=="string"?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):f.searchParams&&URLSearchParams.prototype.isPrototypeOf(D)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},f.blob&&(this.blob=function(){var D=W(this);if(D)return D;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))},this.arrayBuffer=function(){return this._bodyArrayBuffer?W(this)||Promise.resolve(this._bodyArrayBuffer):this.blob().then(X)}),this.text=function(){var D=W(this);if(D)return D;if(this._bodyBlob)return he(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(y(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},f.formData&&(this.formData=function(){return this.text().then(L)}),this.json=function(){return this.text().then(JSON.parse)},this}var I=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];function v(D){var E=D.toUpperCase();return I.indexOf(E)>-1?E:D}function N(D,E){E=E||{};var U=E.body;if(D instanceof N){if(D.bodyUsed)throw new TypeError("Already read");this.url=D.url,this.credentials=D.credentials,E.headers||(this.headers=new k(D.headers)),this.method=D.method,this.mode=D.mode,this.signal=D.signal,!U&&D._bodyInit!=null&&(U=D._bodyInit,D.bodyUsed=!0)}else this.url=String(D);if(this.credentials=E.credentials||this.credentials||"same-origin",(E.headers||!this.headers)&&(this.headers=new k(E.headers)),this.method=v(E.method||this.method||"GET"),this.mode=E.mode||this.mode||null,this.signal=E.signal||this.signal,this.referrer=null,(this.method==="GET"||this.method==="HEAD")&&U)throw new TypeError("Body not allowed for GET or HEAD requests");this._initBody(U)}N.prototype.clone=function(){return new N(this,{body:this._bodyInit})};function L(D){var E=new FormData;return D.trim().split("&").forEach(function(U){if(U){var ye=U.split("="),fe=ye.shift().replace(/\+/g," "),Q=ye.join("=").replace(/\+/g," ");E.append(decodeURIComponent(fe),decodeURIComponent(Q))}}),E}function ie(D){var E=new k,U=D.replace(/\r?\n[\t ]+/g," ");return U.split(/\r?\n/).forEach(function(ye){var fe=ye.split(":"),Q=fe.shift().trim();if(Q){var Z=fe.join(":").trim();E.append(Q,Z)}}),E}S.call(N.prototype);function ne(D,E){E||(E={}),this.type="default",this.status=E.status===void 0?200:E.status,this.ok=this.status>=200&&this.status<300,this.statusText="statusText"in E?E.statusText:"OK",this.headers=new k(E.headers),this.url=E.url||"",this._initBody(D)}S.call(ne.prototype),ne.prototype.clone=function(){return new ne(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new k(this.headers),url:this.url})},ne.error=function(){var D=new ne(null,{status:0,statusText:""});return D.type="error",D};var Ie=[301,302,303,307,308];ne.redirect=function(D,E){if(Ie.indexOf(E)===-1)throw new RangeError("Invalid status code");return new ne(null,{status:E,headers:{location:D}})},u.DOMException=a.DOMException;try{new u.DOMException}catch{u.DOMException=function(E,U){this.message=E,this.name=U;var ye=Error(E);this.stack=ye.stack},u.DOMException.prototype=Object.create(Error.prototype),u.DOMException.prototype.constructor=u.DOMException}function Pe(D,E){return new Promise(function(U,ye){var fe=new N(D,E);if(fe.signal&&fe.signal.aborted)return ye(new u.DOMException("Aborted","AbortError"));var Q=new XMLHttpRequest;function Z(){Q.abort()}Q.onload=function(){var J={status:Q.status,statusText:Q.statusText,headers:ie(Q.getAllResponseHeaders()||"")};J.url="responseURL"in Q?Q.responseURL:J.headers.get("X-Request-URL");var ee="response"in Q?Q.response:Q.responseText;U(new ne(ee,J))},Q.onerror=function(){ye(new TypeError("Network request failed"))},Q.ontimeout=function(){ye(new TypeError("Network request failed"))},Q.onabort=function(){ye(new u.DOMException("Aborted","AbortError"))},Q.open(fe.method,fe.url,!0),fe.credentials==="include"?Q.withCredentials=!0:fe.credentials==="omit"&&(Q.withCredentials=!1),"responseType"in Q&&f.blob&&(Q.responseType="blob"),fe.headers.forEach(function(J,ee){Q.setRequestHeader(ee,J)}),fe.signal&&(fe.signal.addEventListener("abort",Z),Q.onreadystatechange=function(){Q.readyState===4&&fe.signal.removeEventListener("abort",Z)}),Q.send(typeof fe._bodyInit>"u"?null:fe._bodyInit)})}return Pe.polyfill=!0,a.fetch||(a.fetch=Pe,a.Headers=k,a.Request=N,a.Response=ne),u.Headers=k,u.Request=N,u.Response=ne,u.fetch=Pe,Object.defineProperty(u,"__esModule",{value:!0}),u})({})})(r),r.fetch.ponyfill=!0,delete r.fetch.polyfill;var s=r;t=s.fetch,t.default=s.fetch,t.fetch=s.fetch,t.Headers=s.Headers,t.Request=s.Request,t.Response=s.Response,n.exports=t})(ax,Fo);const Of=B1(Fo),cx=n=>JSON.stringify(n,(t,r)=>typeof r=="bigint"?r.toString()+"n":r),ux=n=>{const t=/([\[:])?(\d{17,}|(?:[9](?:[1-9]07199254740991|0[1-9]7199254740991|00[8-9]199254740991|007[2-9]99254740991|007199[3-9]54740991|0071992[6-9]4740991|00719925[5-9]740991|007199254[8-9]40991|0071992547[5-9]0991|00719925474[1-9]991|00719925474099[2-9])))([,\}\]])/g,r=n.replace(t,'$1"$2n"$3');return JSON.parse(r,(s,a)=>typeof a=="string"&&a.match(/^\d+n$/)?BigInt(a.substring(0,a.length-1)):a)};function hx(n){if(typeof n!="string")throw new Error(`Cannot safe json parse value of type ${typeof n}`);try{return ux(n)}catch{return n}}function Pf(n){return typeof n=="string"?n:cx(n)||""}const lx={Accept:"application/json","Content-Type":"application/json"},fx="POST",Tf={headers:lx,method:fx},Af=10;class Xi{constructor(t,r=!1){if(this.url=t,this.disableProviderPing=r,this.events=new Vt.EventEmitter,this.isAvailable=!1,this.registering=!1,!Ql(t))throw new Error(`Provided URL is not compatible with HTTP connection: ${t}`);this.url=t,this.disableProviderPing=r}get connected(){return this.isAvailable}get connecting(){return this.registering}on(t,r){this.events.on(t,r)}once(t,r){this.events.once(t,r)}off(t,r){this.events.off(t,r)}removeListener(t,r){this.events.removeListener(t,r)}async open(t=this.url){await this.register(t)}async close(){if(!this.isAvailable)throw new Error("Connection already closed");this.onClose()}async send(t,r){this.isAvailable||await this.register();try{const s=Pf(t),u=await(await Of(this.url,Object.assign(Object.assign({},Tf),{body:s}))).json();this.onPayload({data:u})}catch(s){this.onError(t.id,s)}}async register(t=this.url){if(!Ql(t))throw new Error(`Provided URL is not compatible with HTTP connection: ${t}`);if(this.registering){const r=this.events.getMaxListeners();return(this.events.listenerCount("register_error")>=r||this.events.listenerCount("open")>=r)&&this.events.setMaxListeners(r+1),new Promise((s,a)=>{this.events.once("register_error",u=>{this.resetMaxListeners(),a(u)}),this.events.once("open",()=>{if(this.resetMaxListeners(),typeof this.isAvailable>"u")return a(new Error("HTTP connection is missing or invalid"));s()})})}this.url=t,this.registering=!0;try{if(!this.disableProviderPing){const r=Pf({id:1,jsonrpc:"2.0",method:"test",params:[]});await Of(t,Object.assign(Object.assign({},Tf),{body:r}))}this.onOpen()}catch(r){const s=this.parseError(r);throw this.events.emit("register_error",s),this.onClose(),s}}onOpen(){this.isAvailable=!0,this.registering=!1,this.events.emit("open")}onClose(){this.isAvailable=!1,this.registering=!1,this.events.emit("close")}onPayload(t){if(typeof t.data>"u")return;const r=typeof t.data=="string"?hx(t.data):t.data;this.events.emit("payload",r)}onError(t,r){const s=this.parseError(r),a=s.message||s.toString(),u=ko(t,a);this.events.emit("payload",u)}parseError(t,r=this.url){return Pd(t,r,"HTTP")}resetMaxListeners(){this.events.getMaxListeners()>Af&&this.events.setMaxListeners(Af)}}const Cf="error",dx="wss://relay.walletconnect.com",px="wc",gx="universal_provider",Rf=`${px}@2:${gx}:`,yx="https://rpc.walletconnect.com/v1/",Ci={DEFAULT_CHAIN_CHANGED:"default_chain_changed"};var ns=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof globalThis<"u"?globalThis:typeof self<"u"?self:{},kc={exports:{}};/**
* @license
* Lodash <https://lodash.com/>
* Copyright OpenJS Foundation and other contributors <https://openjsf.org/>
* Released under MIT license <https://lodash.com/license>
* Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>
* Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
*/(function(n,t){(function(){var r,s="4.17.21",a=200,u="Unsupported core-js use. Try https://npms.io/search?q=ponyfill.",f="Expected a function",g="Invalid `variable` option passed into `_.template`",_="__lodash_hash_undefined__",T=500,C="__lodash_placeholder__",F=1,V=2,k=4,W=1,Y=2,X=1,he=2,y=4,w=8,S=16,I=32,v=64,N=128,L=256,ie=512,ne=30,Ie="...",Pe=800,D=16,E=1,U=2,ye=3,fe=1/0,Q=9007199254740991,Z=17976931348623157e292,J=0/0,ee=4294967295,lt=ee-1,He=ee>>>1,Br=[["ary",N],["bind",X],["bindKey",he],["curry",w],["curryRight",S],["flip",ie],["partial",I],["partialRight",v],["rearg",L]],Se="[object Arguments]",Ot="[object Array]",q="[object AsyncFunction]",M="[object Boolean]",$="[object Date]",h="[object DOMException]",O="[object Error]",ae="[object Function]",ge="[object GeneratorFunction]",_e="[object Map]",$e="[object Number]",De="[object Null]",Te="[object Object]",Pt="[object Promise]",wt="[object Proxy]",at="[object RegExp]",Ue="[object Set]",Ze="[object String]",et="[object Symbol]",ct="[object Undefined]",ze="[object WeakMap]",tt="[object WeakSet]",Le="[object ArrayBuffer]",Ve="[object DataView]",ft="[object Float32Array]",Me="[object Float64Array]",Tt="[object Int8Array]",Ut="[object Int16Array]",Kt="[object Int32Array]",Wt="[object Uint8Array]",qt="[object Uint8ClampedArray]",Zt="[object Uint16Array]",ur="[object Uint32Array]",Hr=/\b__p \+= '';/g,er=/\b(__p \+=) '' \+/g,Xr=/(__e\(.*?\)|\b__t\)) \+\n'';/g,gi=/&(?:amp|lt|gt|quot|#39);/g,Ri=/[&<>"']/g,dt=RegExp(gi.source),nt=RegExp(Ri.source),pt=/<%-([\s\S]+?)%>/g,gt=/<%([\s\S]+?)%>/g,ut=/<%=([\s\S]+?)%>/g,st=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,At=/^\w*$/,Ct=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,yt=/[\\^$.*+?()[\]{}|]/g,Rt=RegExp(yt.source),mt=/^\s+/,_t=/\s/,vt=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,Qe=/\{\n\/\* \[wrapped with (.+)\] \*/,Nt=/,? & /,$t=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,Ko=/[()=,{}\[\]\/\s]/,Wo=/\\(\\)?/g,Go=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,xr=/\w*$/,Jo=/^[-+]0x[0-9a-f]+$/i,Qo=/^0b[01]+$/i,Yo=/^\[object .+?Constructor\]$/,Xo=/^0o[0-7]+$/i,Zo=/^(?:0|[1-9]\d*)$/,Zr=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,en=/($^)/,ea=/['\n\r\u2028\u2029\\]/g,tn="\\ud800-\\udfff",ta="\\u0300-\\u036f",ra="\\ufe20-\\ufe2f",rn="\\u20d0-\\u20ff",vs=ta+ra+rn,bs="\\u2700-\\u27bf",Dr="a-z\\xdf-\\xf6\\xf8-\\xff",ia="\\xac\\xb1\\xd7\\xf7",na="\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf",sa="\\u2000-\\u206f",oa=" \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",ws="A-Z\\xc0-\\xd6\\xd8-\\xde",_s="\\ufe0e\\ufe0f",Ni=ia+na+sa+oa,Rn="[']",$i="["+tn+"]",Nn="["+Ni+"]",Li="["+vs+"]",Es="\\d+",aa="["+bs+"]",Is="["+Dr+"]",Ss="[^"+tn+Ni+Es+bs+Dr+ws+"]",nn="\\ud83c[\\udffb-\\udfff]",ca="(?:"+Li+"|"+nn+")",xs="[^"+tn+"]",sn="(?:\\ud83c[\\udde6-\\uddff]){2}",yi="[\\ud800-\\udbff][\\udc00-\\udfff]",vr="["+ws+"]",Os="\\u200d",Ps="(?:"+Is+"|"+Ss+")",Vr="(?:"+vr+"|"+Ss+")",Ts="(?:"+Rn+"(?:d|ll|m|re|s|t|ve))?",As="(?:"+Rn+"(?:D|LL|M|RE|S|T|VE))?",Cs=ca+"?",Rs="["+_s+"]?",ua="(?:"+Os+"(?:"+[xs,sn,yi].join("|")+")"+Rs+Cs+")*",ei="\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",Ns="\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])",$s=Rs+Cs+ua,on="(?:"+[aa,sn,yi].join("|")+")"+$s,ha="(?:"+[xs+Li+"?",Li,sn,yi,$i].join("|")+")",$n=RegExp(Rn,"g"),la=RegExp(Li,"g"),an=RegExp(nn+"(?="+nn+")|"+ha+$s,"g"),Ls=RegExp([vr+"?"+Is+"+"+Ts+"(?="+[Nn,vr,"$"].join("|")+")",Vr+"+"+As+"(?="+[Nn,vr+Ps,"$"].join("|")+")",vr+"?"+Ps+"+"+Ts,vr+"+"+As,Ns,ei,Es,on].join("|"),"g"),Ds=RegExp("["+Os+tn+vs+_s+"]"),Di=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,Fs=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],fa=-1,Ke={};Ke[ft]=Ke[Me]=Ke[Tt]=Ke[Ut]=Ke[Kt]=Ke[Wt]=Ke[qt]=Ke[Zt]=Ke[ur]=!0,Ke[Se]=Ke[Ot]=Ke[Le]=Ke[M]=Ke[Ve]=Ke[$]=Ke[O]=Ke[ae]=Ke[_e]=Ke[$e]=Ke[Te]=Ke[at]=Ke[Ue]=Ke[Ze]=Ke[ze]=!1;var ke={};ke[Se]=ke[Ot]=ke[Le]=ke[Ve]=ke[M]=ke[$]=ke[ft]=ke[Me]=ke[Tt]=ke[Ut]=ke[Kt]=ke[_e]=ke[$e]=ke[Te]=ke[at]=ke[Ue]=ke[Ze]=ke[et]=ke[Wt]=ke[qt]=ke[Zt]=ke[ur]=!0,ke[O]=ke[ae]=ke[ze]=!1;var m={:"A",:"A",:"A",:"A",:"A",:"A",:"a",:"a",:"a",:"a",:"a",:"a",:"C",:"c",:"D",:"d",:"E",:"E",:"E",:"E",:"e",:"e",:"e",:"e",:"I",:"I",:"I",:"I",:"i",:"i",:"i",:"i",:"N",:"n",:"O",:"O",:"O",:"O",:"O",:"O",:"o",:"o",:"o",:"o",:"o",:"o",:"U",:"U",:"U",:"U",:"u",:"u",:"u",:"u",:"Y",:"y",:"y",:"Ae",:"ae",:"Th",:"th",:"ss",:"A",:"A",:"A",:"a",:"a",:"a",:"C",:"C",:"C",:"C",:"c",:"c",:"c",:"c",:"D",:"D",:"d",:"d",:"E",:"E",:"E",:"E",:"E",:"e",:"e",:"e",:"e",:"e",:"G",:"G",:"G",:"G",:"g",:"g",:"g",:"g",:"H",:"H",:"h",:"h",:"I",:"I",:"I",:"I",:"I",:"i",:"i",:"i",:"i",:"i",:"J",:"j",:"K",:"k",:"k",:"L",:"L",:"L",:"L",:"L",:"l",:"l",:"l",:"l",:"l",:"N",:"N",:"N",:"N",:"n",:"n",:"n",:"n",:"O",:"O",:"O",:"o",:"o",:"o",:"R",:"R",:"R",:"r",:"r",:"r",:"S",:"S",:"S",:"S",:"s",:"s",:"s",:"s",:"T",:"T",:"T",:"t",:"t",:"t",:"U",:"U",:"U",:"U",:"U",:"U",:"u",:"u",:"u",:"u",:"u",:"u",:"W",:"w",:"Y",:"y",:"Y",:"Z",:"Z",:"Z",:"z",:"z",:"z",:"IJ",:"ij",:"Oe",:"oe",:"'n",:"s"},P={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},K={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"},se={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},We=parseFloat,ve=parseInt,rt=typeof ns=="object"&&ns&&ns.Object===Object&&ns,Lt=typeof self=="object"&&self&&self.Object===Object&&self,Ce=rt||Lt||Function("return this")(),Ge=t&&!t.nodeType&&t,Et=Ge&&!0&&n&&!n.nodeType&&n,hr=Et&&Et.exports===Ge,Dt=hr&&rt.process,it=function(){try{var A=Et&&Et.require&&Et.require("util").types;return A||Dt&&Dt.binding&&Dt.binding("util")}catch{}}(),tr=it&&it.isArrayBuffer,Fr=it&&it.isDate,Or=it&&it.isMap,Kr=it&&it.isRegExp,Ln=it&&it.isSet,Fi=it&&it.isTypedArray;function zt(A,z,j){switch(j.length){case 0:return A.call(z);case 1:return A.call(z,j[0]);case 2:return A.call(z,j[0],j[1]);case 3:return A.call(z,j[0],j[1],j[2])}return A.apply(z,j)}function Zd(A,z,j,oe){for(var me=-1,Fe=A==null?0:A.length;++me<Fe;){var jt=A[me];z(oe,jt,j(jt),A)}return oe}function Pr(A,z){for(var j=-1,oe=A==null?0:A.length;++j<oe&&z(A[j],j,A)!==!1;);return A}function ep(A,z){for(var j=A==null?0:A.length;j--&&z(A[j],j,A)!==!1;);return A}function lu(A,z){for(var j=-1,oe=A==null?0:A.length;++j<oe;)if(!z(A[j],j,A))return!1;return!0}function mi(A,z){for(var j=-1,oe=A==null?0:A.length,me=0,Fe=[];++j<oe;){var jt=A[j];z(jt,j,A)&&(Fe[me++]=jt)}return Fe}function Us(A,z){var j=A==null?0:A.length;return!!j&&cn(A,z,0)>-1}function da(A,z,j){for(var oe=-1,me=A==null?0:A.length;++oe<me;)if(j(z,A[oe]))return!0;return!1}function ot(A,z){for(var j=-1,oe=A==null?0:A.length,me=Array(oe);++j<oe;)me[j]=z(A[j],j,A);return me}function vi(A,z){for(var j=-1,oe=z.length,me=A.length;++j<oe;)A[me+j]=z[j];return A}function pa(A,z,j,oe){var me=-1,Fe=A==null?0:A.length;for(oe&&Fe&&(j=A[++me]);++me<Fe;)j=z(j,A[me],me,A);return j}function tp(A,z,j,oe){var me=A==null?0:A.length;for(oe&&me&&(j=A[--me]);me--;)j=z(j,A[me],me,A);return j}function ga(A,z){for(var j=-1,oe=A==null?0:A.length;++j<oe;)if(z(A[j],j,A))return!0;return!1}var rp=ya("length");function ip(A){return A.split("")}function np(A){return A.match($t)||[]}function fu(A,z,j){var oe;return j(A,function(me,Fe,jt){if(z(me,Fe,jt))return oe=Fe,!1}),oe}function js(A,z,j,oe){for(var me=A.length,Fe=j+(oe?1:-1);oe?Fe--:++Fe<me;)if(z(A[Fe],Fe,A))return Fe;return-1}function cn(A,z,j){return z===z?yp(A,z,j):js(A,du,j)}function sp(A,z,j,oe){for(var me=j-1,Fe=A.length;++me<Fe;)if(oe(A[me],z))return me;return-1}function du(A){return A!==A}function pu(A,z){var j=A==null?0:A.length;return j?va(A,z)/j:J}function ya(A){return function(z){return z==null?r:z[A]}}function ma(A){return function(z){return A==null?r:A[z]}}function gu(A,z,j,oe,me){return me(A,function(Fe,jt,Je){j=oe?(oe=!1,Fe):z(j,Fe,jt,Je)}),j}function op(A,z){var j=A.length;for(A.sort(z);j--;)A[j]=A[j].value;return A}function va(A,z){for(var j,oe=-1,me=A.length;++oe<me;){var Fe=z(A[oe]);Fe!==r&&(j=j===r?Fe:j+Fe)}return j}function ba(A,z){for(var j=-1,oe=Array(A);++j<A;)oe[j]=z(j);return oe}function ap(A,z){return ot(z,function(j){return[j,A[j]]})}function yu(A){return A&&A.slice(0,wu(A)+1).replace(mt,"")}function br(A){return function(z){return A(z)}}function wa(A,z){return ot(z,function(j){return A[j]})}function Dn(A,z){return A.has(z)}function mu(A,z){for(var j=-1,oe=A.length;++j<oe&&cn(z,A[j],0)>-1;);return j}function vu(A,z){for(var j=A.length;j--&&cn(z,A[j],0)>-1;);return j}function cp(A,z){for(var j=A.length,oe=0;j--;)A[j]===z&&++oe;return oe}var up=ma(m),hp=ma(P);function lp(A){return"\\"+se[A]}function fp(A,z){return A==null?r:A[z]}function un(A){return Ds.test(A)}function dp(A){return Di.test(A)}function pp(A){for(var z,j=[];!(z=A.next()).done;)j.push(z.value);return j}function _a(A){var z=-1,j=Array(A.size);return A.forEach(function(oe,me){j[++z]=[me,oe]}),j}function bu(A,z){return function(j){return A(z(j))}}function bi(A,z){for(var j=-1,oe=A.length,me=0,Fe=[];++j<oe;){var jt=A[j];(jt===z||jt===C)&&(A[j]=C,Fe[me++]=j)}return Fe}function Ms(A){var z=-1,j=Array(A.size);return A.forEach(function(oe){j[++z]=oe}),j}function gp(A){var z=-1,j=Array(A.size);return A.forEach(function(oe){j[++z]=[oe,oe]}),j}function yp(A,z,j){for(var oe=j-1,me=A.length;++oe<me;)if(A[oe]===z)return oe;return-1}function mp(A,z,j){for(var oe=j+1;oe--;)if(A[oe]===z)return oe;return oe}function hn(A){return un(A)?bp(A):rp(A)}function Ur(A){return un(A)?wp(A):ip(A)}function wu(A){for(var z=A.length;z--&&_t.test(A.charAt(z)););return z}var vp=ma(K);function bp(A){for(var z=an.lastIndex=0;an.test(A);)++z;return z}function wp(A){return A.match(an)||[]}function _p(A){return A.match(Ls)||[]}var Ep=function A(z){z=z==null?Ce:ln.defaults(Ce.Object(),z,ln.pick(Ce,Fs));var j=z.Array,oe=z.Date,me=z.Error,Fe=z.Function,jt=z.Math,Je=z.Object,Ea=z.RegExp,Ip=z.String,Tr=z.TypeError,qs=j.prototype,Sp=Fe.prototype,fn=Je.prototype,zs=z["__core-js_shared__"],ks=Sp.toString,qe=fn.hasOwnProperty,xp=0,_u=function(){var e=/[^.]+$/.exec(zs&&zs.keys&&zs.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}(),Bs=fn.toString,Op=ks.call(Je),Pp=Ce._,Tp=Ea("^"+ks.call(qe).replace(yt,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),Hs=hr?z.Buffer:r,wi=z.Symbol,Vs=z.Uint8Array,Eu=Hs?Hs.allocUnsafe:r,Ks=bu(Je.getPrototypeOf,Je),Iu=Je.create,Su=fn.propertyIsEnumerable,Ws=qs.splice,xu=wi?wi.isConcatSpreadable:r,Fn=wi?wi.iterator:r,Ui=wi?wi.toStringTag:r,Gs=function(){try{var e=ki(Je,"defineProperty");return e({},"",{}),e}catch{}}(),Ap=z.clearTimeout!==Ce.clearTimeout&&z.clearTimeout,Cp=oe&&oe.now!==Ce.Date.now&&oe.now,Rp=z.setTimeout!==Ce.setTimeout&&z.setTimeout,Js=jt.ceil,Qs=jt.floor,Ia=Je.getOwnPropertySymbols,Np=Hs?Hs.isBuffer:r,Ou=z.isFinite,$p=qs.join,Lp=bu(Je.keys,Je),Mt=jt.max,Qt=jt.min,Dp=oe.now,Fp=z.parseInt,Pu=jt.random,Up=qs.reverse,Sa=ki(z,"DataView"),Un=ki(z,"Map"),xa=ki(z,"Promise"),dn=ki(z,"Set"),jn=ki(z,"WeakMap"),Mn=ki(Je,"create"),Ys=jn&&new jn,pn={},jp=Bi(Sa),Mp=Bi(Un),qp=Bi(xa),zp=Bi(dn),kp=Bi(jn),Xs=wi?wi.prototype:r,qn=Xs?Xs.valueOf:r,Tu=Xs?Xs.toString:r;function d(e){if(bt(e)&&!be(e)&&!(e instanceof Ae)){if(e instanceof Ar)return e;if(qe.call(e,"__wrapped__"))return Ah(e)}return new Ar(e)}var gn=function(){function e(){}return function(i){if(!ht(i))return{};if(Iu)return Iu(i);e.prototype=i;var o=new e;return e.prototype=r,o}}();function Zs(){}function Ar(e,i){this.__wrapped__=e,this.__actions__=[],this.__chain__=!!i,this.__index__=0,this.__values__=r}d.templateSettings={escape:pt,evaluate:gt,interpolate:ut,variable:"",imports:{_:d}},d.prototype=Zs.prototype,d.prototype.constructor=d,Ar.prototype=gn(Zs.prototype),Ar.prototype.constructor=Ar;function Ae(e){this.__wrapped__=e,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=ee,this.__views__=[]}function Bp(){var e=new Ae(this.__wrapped__);return e.__actions__=lr(this.__actions__),e.__dir__=this.__dir__,e.__filtered__=this.__filtered__,e.__iteratees__=lr(this.__iteratees__),e.__takeCount__=this.__takeCount__,e.__views__=lr(this.__views__),e}function Hp(){if(this.__filtered__){var e=new Ae(this);e.__dir__=-1,e.__filtered__=!0}else e=this.clone(),e.__dir__*=-1;return e}function Vp(){var e=this.__wrapped__.value(),i=this.__dir__,o=be(e),c=i<0,l=o?e.length:0,p=iy(0,l,this.__views__),b=p.start,x=p.end,R=x-b,B=c?x:b-1,H=this.__iteratees__,G=H.length,te=0,ce=Qt(R,this.__takeCount__);if(!o||!c&&l==R&&ce==R)return Xu(e,this.__actions__);var de=[];e:for(;R--&&te<ce;){B+=i;for(var Ee=-1,pe=e[B];++Ee<G;){var Oe=H[Ee],Re=Oe.iteratee,Er=Oe.type,nr=Re(pe);if(Er==U)pe=nr;else if(!nr){if(Er==E)continue e;break e}}de[te++]=pe}return de}Ae.prototype=gn(Zs.prototype),Ae.prototype.constructor=Ae;function ji(e){var i=-1,o=e==null?0:e.length;for(this.clear();++i<o;){var c=e[i];this.set(c[0],c[1])}}function Kp(){this.__data__=Mn?Mn(null):{},this.size=0}function Wp(e){var i=this.has(e)&&delete this.__data__[e];return this.size-=i?1:0,i}function Gp(e){var i=this.__data__;if(Mn){var o=i[e];return o===_?r:o}return qe.call(i,e)?i[e]:r}function Jp(e){var i=this.__data__;return Mn?i[e]!==r:qe.call(i,e)}function Qp(e,i){var o=this.__data__;return this.size+=this.has(e)?0:1,o[e]=Mn&&i===r?_:i,this}ji.prototype.clear=Kp,ji.prototype.delete=Wp,ji.prototype.get=Gp,ji.prototype.has=Jp,ji.prototype.set=Qp;function ti(e){var i=-1,o=e==null?0:e.length;for(this.clear();++i<o;){var c=e[i];this.set(c[0],c[1])}}function Yp(){this.__data__=[],this.size=0}function Xp(e){var i=this.__data__,o=eo(i,e);if(o<0)return!1;var c=i.length-1;return o==c?i.pop():Ws.call(i,o,1),--this.size,!0}function Zp(e){var i=this.__data__,o=eo(i,e);return o<0?r:i[o][1]}function eg(e){return eo(this.__data__,e)>-1}function tg(e,i){var o=this.__data__,c=eo(o,e);return c<0?(++this.size,o.push([e,i])):o[c][1]=i,this}ti.prototype.clear=Yp,ti.prototype.delete=Xp,ti.prototype.get=Zp,ti.prototype.has=eg,ti.prototype.set=tg;function ri(e){var i=-1,o=e==null?0:e.length;for(this.clear();++i<o;){var c=e[i];this.set(c[0],c[1])}}function rg(){this.size=0,this.__data__={hash:new ji,map:new(Un||ti),string:new ji}}function ig(e){var i=fo(this,e).delete(e);return this.size-=i?1:0,i}function ng(e){return fo(this,e).get(e)}function sg(e){return fo(this,e).has(e)}function og(e,i){var o=fo(this,e),c=o.size;return o.set(e,i),this.size+=o.size==c?0:1,this}ri.prototype.clear=rg,ri.prototype.delete=ig,ri.prototype.get=ng,ri.prototype.has=sg,ri.prototype.set=og;function Mi(e){var i=-1,o=e==null?0:e.length;for(this.__data__=new ri;++i<o;)this.add(e[i])}function ag(e){return this.__data__.set(e,_),this}function cg(e){return this.__data__.has(e)}Mi.prototype.add=Mi.prototype.push=ag,Mi.prototype.has=cg;function jr(e){var i=this.__data__=new ti(e);this.size=i.size}function ug(){this.__data__=new ti,this.size=0}function hg(e){var i=this.__data__,o=i.delete(e);return this.size=i.size,o}function lg(e){return this.__data__.get(e)}function fg(e){return this.__data__.has(e)}function dg(e,i){var o=this.__data__;if(o instanceof ti){var c=o.__data__;if(!Un||c.length<a-1)return c.push([e,i]),this.size=++o.size,this;o=this.__data__=new ri(c)}return o.set(e,i),this.size=o.size,this}jr.prototype.clear=ug,jr.prototype.delete=hg,jr.prototype.get=lg,jr.prototype.has=fg,jr.prototype.set=dg;function Au(e,i){var o=be(e),c=!o&&Hi(e),l=!o&&!c&&xi(e),p=!o&&!c&&!l&&bn(e),b=o||c||l||p,x=b?ba(e.length,Ip):[],R=x.length;for(var B in e)(i||qe.call(e,B))&&!(b&&(B=="length"||l&&(B=="offset"||B=="parent")||p&&(B=="buffer"||B=="byteLength"||B=="byteOffset")||oi(B,R)))&&x.push(B);return x}function Cu(e){var i=e.length;return i?e[Fa(0,i-1)]:r}function pg(e,i){return po(lr(e),qi(i,0,e.length))}function gg(e){return po(lr(e))}function Oa(e,i,o){(o!==r&&!Mr(e[i],o)||o===r&&!(i in e))&&ii(e,i,o)}function zn(e,i,o){var c=e[i];(!(qe.call(e,i)&&Mr(c,o))||o===r&&!(i in e))&&ii(e,i,o)}function eo(e,i){for(var o=e.length;o--;)if(Mr(e[o][0],i))return o;return-1}function yg(e,i,o,c){return _i(e,function(l,p,b){i(c,l,o(l),b)}),c}function Ru(e,i){return e&&Gr(i,kt(i),e)}function mg(e,i){return e&&Gr(i,dr(i),e)}function ii(e,i,o){i=="__proto__"&&Gs?Gs(e,i,{configurable:!0,enumerable:!0,value:o,writable:!0}):e[i]=o}function Pa(e,i){for(var o=-1,c=i.length,l=j(c),p=e==null;++o<c;)l[o]=p?r:ac(e,i[o]);return l}function qi(e,i,o){return e===e&&(o!==r&&(e=e<=o?e:o),i!==r&&(e=e>=i?e:i)),e}function Cr(e,i,o,c,l,p){var b,x=i&F,R=i&V,B=i&k;if(o&&(b=l?o(e,c,l,p):o(e)),b!==r)return b;if(!ht(e))return e;var H=be(e);if(H){if(b=sy(e),!x)return lr(e,b)}else{var G=Yt(e),te=G==ae||G==ge;if(xi(e))return th(e,x);if(G==Te||G==Se||te&&!l){if(b=R||te?{}:wh(e),!x)return R?Gg(e,mg(b,e)):Wg(e,Ru(b,e))}else{if(!ke[G])return l?e:{};b=oy(e,G,x)}}p||(p=new jr);var ce=p.get(e);if(ce)return ce;p.set(e,b),Jh(e)?e.forEach(function(pe){b.add(Cr(pe,i,o,pe,e,p))}):Wh(e)&&e.forEach(function(pe,Oe){b.set(Oe,Cr(pe,i,o,Oe,e,p))});var de=B?R?Wa:Ka:R?dr:kt,Ee=H?r:de(e);return Pr(Ee||e,function(pe,Oe){Ee&&(Oe=pe,pe=e[Oe]),zn(b,Oe,Cr(pe,i,o,Oe,e,p))}),b}function vg(e){var i=kt(e);return function(o){return Nu(o,e,i)}}function Nu(e,i,o){var c=o.length;if(e==null)return!c;for(e=Je(e);c--;){var l=o[c],p=i[l],b=e[l];if(b===r&&!(l in e)||!p(b))return!1}return!0}function $u(e,i,o){if(typeof e!="function")throw new Tr(f);return Gn(function(){e.apply(r,o)},i)}function kn(e,i,o,c){var l=-1,p=Us,b=!0,x=e.length,R=[],B=i.length;if(!x)return R;o&&(i=ot(i,br(o))),c?(p=da,b=!1):i.length>=a&&(p=Dn,b=!1,i=new Mi(i));e:for(;++l<x;){var H=e[l],G=o==null?H:o(H);if(H=c||H!==0?H:0,b&&G===G){for(var te=B;te--;)if(i[te]===G)continue e;R.push(H)}else p(i,G,c)||R.push(H)}return R}var _i=oh(Wr),Lu=oh(Aa,!0);function bg(e,i){var o=!0;return _i(e,function(c,l,p){return o=!!i(c,l,p),o}),o}function to(e,i,o){for(var c=-1,l=e.length;++c<l;){var p=e[c],b=i(p);if(b!=null&&(x===r?b===b&&!_r(b):o(b,x)))var x=b,R=p}return R}function wg(e,i,o,c){var l=e.length;for(o=we(o),o<0&&(o=-o>l?0:l+o),c=c===r||c>l?l:we(c),c<0&&(c+=l),c=o>c?0:Yh(c);o<c;)e[o++]=i;return e}function Du(e,i){var o=[];return _i(e,function(c,l,p){i(c,l,p)&&o.push(c)}),o}function Gt(e,i,o,c,l){var p=-1,b=e.length;for(o||(o=cy),l||(l=[]);++p<b;){var x=e[p];i>0&&o(x)?i>1?Gt(x,i-1,o,c,l):vi(l,x):c||(l[l.length]=x)}return l}var Ta=ah(),Fu=ah(!0);function Wr(e,i){return e&&Ta(e,i,kt)}function Aa(e,i){return e&&Fu(e,i,kt)}function ro(e,i){return mi(i,function(o){return ai(e[o])})}function zi(e,i){i=Ii(i,e);for(var o=0,c=i.length;e!=null&&o<c;)e=e[Jr(i[o++])];return o&&o==c?e:r}function Uu(e,i,o){var c=i(e);return be(e)?c:vi(c,o(e))}function rr(e){return e==null?e===r?ct:De:Ui&&Ui in Je(e)?ry(e):gy(e)}function Ca(e,i){return e>i}function _g(e,i){return e!=null&&qe.call(e,i)}function Eg(e,i){return e!=null&&i in Je(e)}function Ig(e,i,o){return e>=Qt(i,o)&&e<Mt(i,o)}function Ra(e,i,o){for(var c=o?da:Us,l=e[0].length,p=e.length,b=p,x=j(p),R=1/0,B=[];b--;){var H=e[b];b&&i&&(H=ot(H,br(i))),R=Qt(H.length,R),x[b]=!o&&(i||l>=120&&H.length>=120)?new Mi(b&&H):r}H=e[0];var G=-1,te=x[0];e:for(;++G<l&&B.length<R;){var ce=H[G],de=i?i(ce):ce;if(ce=o||ce!==0?ce:0,!(te?Dn(te,de):c(B,de,o))){for(b=p;--b;){var Ee=x[b];if(!(Ee?Dn(Ee,de):c(e[b],de,o)))continue e}te&&te.push(de),B.push(ce)}}return B}function Sg(e,i,o,c){return Wr(e,function(l,p,b){i(c,o(l),p,b)}),c}function Bn(e,i,o){i=Ii(i,e),e=Sh(e,i);var c=e==null?e:e[Jr(Nr(i))];return c==null?r:zt(c,e,o)}function ju(e){return bt(e)&&rr(e)==Se}function xg(e){return bt(e)&&rr(e)==Le}function Og(e){return bt(e)&&rr(e)==$}function Hn(e,i,o,c,l){return e===i?!0:e==null||i==null||!bt(e)&&!bt(i)?e!==e&&i!==i:Pg(e,i,o,c,Hn,l)}function Pg(e,i,o,c,l,p){var b=be(e),x=be(i),R=b?Ot:Yt(e),B=x?Ot:Yt(i);R=R==Se?Te:R,B=B==Se?Te:B;var H=R==Te,G=B==Te,te=R==B;if(te&&xi(e)){if(!xi(i))return!1;b=!0,H=!1}if(te&&!H)return p||(p=new jr),b||bn(e)?mh(e,i,o,c,l,p):ey(e,i,R,o,c,l,p);if(!(o&W)){var ce=H&&qe.call(e,"__wrapped__"),de=G&&qe.call(i,"__wrapped__");if(ce||de){var Ee=ce?e.value():e,pe=de?i.value():i;return p||(p=new jr),l(Ee,pe,o,c,p)}}return te?(p||(p=new jr),ty(e,i,o,c,l,p)):!1}function Tg(e){return bt(e)&&Yt(e)==_e}function Na(e,i,o,c){var l=o.length,p=l,b=!c;if(e==null)return!p;for(e=Je(e);l--;){var x=o[l];if(b&&x[2]?x[1]!==e[x[0]]:!(x[0]in e))return!1}for(;++l<p;){x=o[l];var R=x[0],B=e[R],H=x[1];if(b&&x[2]){if(B===r&&!(R in e))return!1}else{var G=new jr;if(c)var te=c(B,H,R,e,i,G);if(!(te===r?Hn(H,B,W|Y,c,G):te))return!1}}return!0}function Mu(e){if(!ht(e)||hy(e))return!1;var i=ai(e)?Tp:Yo;return i.test(Bi(e))}function Ag(e){return bt(e)&&rr(e)==at}function Cg(e){return bt(e)&&Yt(e)==Ue}function Rg(e){return bt(e)&&wo(e.length)&&!!Ke[rr(e)]}function qu(e){return typeof e=="function"?e:e==null?pr:typeof e=="object"?be(e)?Bu(e[0],e[1]):ku(e):cl(e)}function $a(e){if(!Wn(e))return Lp(e);var i=[];for(var o in Je(e))qe.call(e,o)&&o!="constructor"&&i.push(o);return i}function Ng(e){if(!ht(e))return py(e);var i=Wn(e),o=[];for(var c in e)c=="constructor"&&(i||!qe.call(e,c))||o.push(c);return o}function La(e,i){return e<i}function zu(e,i){var o=-1,c=fr(e)?j(e.length):[];return _i(e,function(l,p,b){c[++o]=i(l,p,b)}),c}function ku(e){var i=Ja(e);return i.length==1&&i[0][2]?Eh(i[0][0],i[0][1]):function(o){return o===e||Na(o,e,i)}}function Bu(e,i){return Ya(e)&&_h(i)?Eh(Jr(e),i):function(o){var c=ac(o,e);return c===r&&c===i?cc(o,e):Hn(i,c,W|Y)}}function io(e,i,o,c,l){e!==i&&Ta(i,function(p,b){if(l||(l=new jr),ht(p))$g(e,i,b,o,io,c,l);else{var x=c?c(Za(e,b),p,b+"",e,i,l):r;x===r&&(x=p),Oa(e,b,x)}},dr)}function $g(e,i,o,c,l,p,b){var x=Za(e,o),R=Za(i,o),B=b.get(R);if(B){Oa(e,o,B);return}var H=p?p(x,R,o+"",e,i,b):r,G=H===r;if(G){var te=be(R),ce=!te&&xi(R),de=!te&&!ce&&bn(R);H=R,te||ce||de?be(x)?H=x:It(x)?H=lr(x):ce?(G=!1,H=th(R,!0)):de?(G=!1,H=rh(R,!0)):H=[]:Jn(R)||Hi(R)?(H=x,Hi(x)?H=Xh(x):(!ht(x)||ai(x))&&(H=wh(R))):G=!1}G&&(b.set(R,H),l(H,R,c,p,b),b.delete(R)),Oa(e,o,H)}function Hu(e,i){var o=e.length;if(o)return i+=i<0?o:0,oi(i,o)?e[i]:r}function Vu(e,i,o){i.length?i=ot(i,function(p){return be(p)?function(b){return zi(b,p.length===1?p[0]:p)}:p}):i=[pr];var c=-1;i=ot(i,br(le()));var l=zu(e,function(p,b,x){var R=ot(i,function(B){return B(p)});return{criteria:R,index:++c,value:p}});return op(l,function(p,b){return Kg(p,b,o)})}function Lg(e,i){return Ku(e,i,function(o,c){return cc(e,c)})}function Ku(e,i,o){for(var c=-1,l=i.length,p={};++c<l;){var b=i[c],x=zi(e,b);o(x,b)&&Vn(p,Ii(b,e),x)}return p}function Dg(e){return function(i){return zi(i,e)}}function Da(e,i,o,c){var l=c?sp:cn,p=-1,b=i.length,x=e;for(e===i&&(i=lr(i)),o&&(x=ot(e,br(o)));++p<b;)for(var R=0,B=i[p],H=o?o(B):B;(R=l(x,H,R,c))>-1;)x!==e&&Ws.call(x,R,1),Ws.call(e,R,1);return e}function Wu(e,i){for(var o=e?i.length:0,c=o-1;o--;){var l=i[o];if(o==c||l!==p){var p=l;oi(l)?Ws.call(e,l,1):Ma(e,l)}}return e}function Fa(e,i){return e+Qs(Pu()*(i-e+1))}function Fg(e,i,o,c){for(var l=-1,p=Mt(Js((i-e)/(o||1)),0),b=j(p);p--;)b[c?p:++l]=e,e+=o;return b}function Ua(e,i){var o="";if(!e||i<1||i>Q)return o;do i%2&&(o+=e),i=Qs(i/2),i&&(e+=e);while(i);return o}function xe(e,i){return ec(Ih(e,i,pr),e+"")}function Ug(e){return Cu(wn(e))}function jg(e,i){var o=wn(e);return po(o,qi(i,0,o.length))}function Vn(e,i,o,c){if(!ht(e))return e;i=Ii(i,e);for(var l=-1,p=i.length,b=p-1,x=e;x!=null&&++l<p;){var R=Jr(i[l]),B=o;if(R==="__proto__"||R==="constructor"||R==="prototype")return e;if(l!=b){var H=x[R];B=c?c(H,R,x):r,B===r&&(B=ht(H)?H:oi(i[l+1])?[]:{})}zn(x,R,B),x=x[R]}return e}var Gu=Ys?function(e,i){return Ys.set(e,i),e}:pr,Mg=Gs?function(e,i){return Gs(e,"toString",{configurable:!0,enumerable:!1,value:hc(i),writable:!0})}:pr;function qg(e){return po(wn(e))}function Rr(e,i,o){var c=-1,l=e.length;i<0&&(i=-i>l?0:l+i),o=o>l?l:o,o<0&&(o+=l),l=i>o?0:o-i>>>0,i>>>=0;for(var p=j(l);++c<l;)p[c]=e[c+i];return p}function zg(e,i){var o;return _i(e,function(c,l,p){return o=i(c,l,p),!o}),!!o}function no(e,i,o){var c=0,l=e==null?c:e.length;if(typeof i=="number"&&i===i&&l<=He){for(;c<l;){var p=c+l>>>1,b=e[p];b!==null&&!_r(b)&&(o?b<=i:b<i)?c=p+1:l=p}return l}return ja(e,i,pr,o)}function ja(e,i,o,c){var l=0,p=e==null?0:e.length;if(p===0)return 0;i=o(i);for(var b=i!==i,x=i===null,R=_r(i),B=i===r;l<p;){var H=Qs((l+p)/2),G=o(e[H]),te=G!==r,ce=G===null,de=G===G,Ee=_r(G);if(b)var pe=c||de;else B?pe=de&&(c||te):x?pe=de&&te&&(c||!ce):R?pe=de&&te&&!ce&&(c||!Ee):ce||Ee?pe=!1:pe=c?G<=i:G<i;pe?l=H+1:p=H}return Qt(p,lt)}function Ju(e,i){for(var o=-1,c=e.length,l=0,p=[];++o<c;){var b=e[o],x=i?i(b):b;if(!o||!Mr(x,R)){var R=x;p[l++]=b===0?0:b}}return p}function Qu(e){return typeof e=="number"?e:_r(e)?J:+e}function wr(e){if(typeof e=="string")return e;if(be(e))return ot(e,wr)+"";if(_r(e))return Tu?Tu.call(e):"";var i=e+"";return i=="0"&&1/e==-fe?"-0":i}function Ei(e,i,o){var c=-1,l=Us,p=e.length,b=!0,x=[],R=x;if(o)b=!1,l=da;else if(p>=a){var B=i?null:Xg(e);if(B)return Ms(B);b=!1,l=Dn,R=new Mi}else R=i?[]:x;e:for(;++c<p;){var H=e[c],G=i?i(H):H;if(H=o||H!==0?H:0,b&&G===G){for(var te=R.length;te--;)if(R[te]===G)continue e;i&&R.push(G),x.push(H)}else l(R,G,o)||(R!==x&&R.push(G),x.push(H))}return x}function Ma(e,i){return i=Ii(i,e),e=Sh(e,i),e==null||delete e[Jr(Nr(i))]}function Yu(e,i,o,c){return Vn(e,i,o(zi(e,i)),c)}function so(e,i,o,c){for(var l=e.length,p=c?l:-1;(c?p--:++p<l)&&i(e[p],p,e););return o?Rr(e,c?0:p,c?p+1:l):Rr(e,c?p+1:0,c?l:p)}function Xu(e,i){var o=e;return o instanceof Ae&&(o=o.value()),pa(i,function(c,l){return l.func.apply(l.thisArg,vi([c],l.args))},o)}function qa(e,i,o){var c=e.length;if(c<2)return c?Ei(e[0]):[];for(var l=-1,p=j(c);++l<c;)for(var b=e[l],x=-1;++x<c;)x!=l&&(p[l]=kn(p[l]||b,e[x],i,o));return Ei(Gt(p,1),i,o)}function Zu(e,i,o){for(var c=-1,l=e.length,p=i.length,b={};++c<l;){var x=c<p?i[c]:r;o(b,e[c],x)}return b}function za(e){return It(e)?e:[]}function ka(e){return typeof e=="function"?e:pr}function Ii(e,i){return be(e)?e:Ya(e,i)?[e]:Th(je(e))}var kg=xe;function Si(e,i,o){var c=e.length;return o=o===r?c:o,!i&&o>=c?e:Rr(e,i,o)}var eh=Ap||function(e){return Ce.clearTimeout(e)};function th(e,i){if(i)return e.slice();var o=e.length,c=Eu?Eu(o):new e.constructor(o);return e.copy(c),c}function Ba(e){var i=new e.constructor(e.byteLength);return new Vs(i).set(new Vs(e)),i}function Bg(e,i){var o=i?Ba(e.buffer):e.buffer;return new e.constructor(o,e.byteOffset,e.byteLength)}function Hg(e){var i=new e.constructor(e.source,xr.exec(e));return i.lastIndex=e.lastIndex,i}function Vg(e){return qn?Je(qn.call(e)):{}}function rh(e,i){var o=i?Ba(e.buffer):e.buffer;return new e.constructor(o,e.byteOffset,e.length)}function ih(e,i){if(e!==i){var o=e!==r,c=e===null,l=e===e,p=_r(e),b=i!==r,x=i===null,R=i===i,B=_r(i);if(!x&&!B&&!p&&e>i||p&&b&&R&&!x&&!B||c&&b&&R||!o&&R||!l)return 1;if(!c&&!p&&!B&&e<i||B&&o&&l&&!c&&!p||x&&o&&l||!b&&l||!R)return-1}return 0}function Kg(e,i,o){for(var c=-1,l=e.criteria,p=i.criteria,b=l.length,x=o.length;++c<b;){var R=ih(l[c],p[c]);if(R){if(c>=x)return R;var B=o[c];return R*(B=="desc"?-1:1)}}return e.index-i.index}function nh(e,i,o,c){for(var l=-1,p=e.length,b=o.length,x=-1,R=i.length,B=Mt(p-b,0),H=j(R+B),G=!c;++x<R;)H[x]=i[x];for(;++l<b;)(G||l<p)&&(H[o[l]]=e[l]);for(;B--;)H[x++]=e[l++];return H}function sh(e,i,o,c){for(var l=-1,p=e.length,b=-1,x=o.length,R=-1,B=i.length,H=Mt(p-x,0),G=j(H+B),te=!c;++l<H;)G[l]=e[l];for(var ce=l;++R<B;)G[ce+R]=i[R];for(;++b<x;)(te||l<p)&&(G[ce+o[b]]=e[l++]);return G}function lr(e,i){var o=-1,c=e.length;for(i||(i=j(c));++o<c;)i[o]=e[o];return i}function Gr(e,i,o,c){var l=!o;o||(o={});for(var p=-1,b=i.length;++p<b;){var x=i[p],R=c?c(o[x],e[x],x,o,e):r;R===r&&(R=e[x]),l?ii(o,x,R):zn(o,x,R)}return o}function Wg(e,i){return Gr(e,Qa(e),i)}function Gg(e,i){return Gr(e,vh(e),i)}function oo(e,i){return function(o,c){var l=be(o)?Zd:yg,p=i?i():{};return l(o,e,le(c,2),p)}}function yn(e){return xe(function(i,o){var c=-1,l=o.length,p=l>1?o[l-1]:r,b=l>2?o[2]:r;for(p=e.length>3&&typeof p=="function"?(l--,p):r,b&&ir(o[0],o[1],b)&&(p=l<3?r:p,l=1),i=Je(i);++c<l;){var x=o[c];x&&e(i,x,c,p)}return i})}function oh(e,i){return function(o,c){if(o==null)return o;if(!fr(o))return e(o,c);for(var l=o.length,p=i?l:-1,b=Je(o);(i?p--:++p<l)&&c(b[p],p,b)!==!1;);return o}}function ah(e){return function(i,o,c){for(var l=-1,p=Je(i),b=c(i),x=b.length;x--;){var R=b[e?x:++l];if(o(p[R],R,p)===!1)break}return i}}function Jg(e,i,o){var c=i&X,l=Kn(e);function p(){var b=this&&this!==Ce&&this instanceof p?l:e;return b.apply(c?o:this,arguments)}return p}function ch(e){return function(i){i=je(i);var o=un(i)?Ur(i):r,c=o?o[0]:i.charAt(0),l=o?Si(o,1).join(""):i.slice(1);return c[e]()+l}}function mn(e){return function(i){return pa(ol(sl(i).replace($n,"")),e,"")}}function Kn(e){return function(){var i=arguments;switch(i.length){case 0:return new e;case 1:return new e(i[0]);case 2:return new e(i[0],i[1]);case 3:return new e(i[0],i[1],i[2]);case 4:return new e(i[0],i[1],i[2],i[3]);case 5:return new e(i[0],i[1],i[2],i[3],i[4]);case 6:return new e(i[0],i[1],i[2],i[3],i[4],i[5]);case 7:return new e(i[0],i[1],i[2],i[3],i[4],i[5],i[6])}var o=gn(e.prototype),c=e.apply(o,i);return ht(c)?c:o}}function Qg(e,i,o){var c=Kn(e);function l(){for(var p=arguments.length,b=j(p),x=p,R=vn(l);x--;)b[x]=arguments[x];var B=p<3&&b[0]!==R&&b[p-1]!==R?[]:bi(b,R);if(p-=B.length,p<o)return dh(e,i,ao,l.placeholder,r,b,B,r,r,o-p);var H=this&&this!==Ce&&this instanceof l?c:e;return zt(H,this,b)}return l}function uh(e){return function(i,o,c){var l=Je(i);if(!fr(i)){var p=le(o,3);i=kt(i),o=function(x){return p(l[x],x,l)}}var b=e(i,o,c);return b>-1?l[p?i[b]:b]:r}}function hh(e){return si(function(i){var o=i.length,c=o,l=Ar.prototype.thru;for(e&&i.reverse();c--;){var p=i[c];if(typeof p!="function")throw new Tr(f);if(l&&!b&&lo(p)=="wrapper")var b=new Ar([],!0)}for(c=b?c:o;++c<o;){p=i[c];var x=lo(p),R=x=="wrapper"?Ga(p):r;R&&Xa(R[0])&&R[1]==(N|w|I|L)&&!R[4].length&&R[9]==1?b=b[lo(R[0])].apply(b,R[3]):b=p.length==1&&Xa(p)?b[x]():b.thru(p)}return function(){var B=arguments,H=B[0];if(b&&B.length==1&&be(H))return b.plant(H).value();for(var G=0,te=o?i[G].apply(this,B):H;++G<o;)te=i[G].call(this,te);return te}})}function ao(e,i,o,c,l,p,b,x,R,B){var H=i&N,G=i&X,te=i&he,ce=i&(w|S),de=i&ie,Ee=te?r:Kn(e);function pe(){for(var Oe=arguments.length,Re=j(Oe),Er=Oe;Er--;)Re[Er]=arguments[Er];if(ce)var nr=vn(pe),Ir=cp(Re,nr);if(c&&(Re=nh(Re,c,l,ce)),p&&(Re=sh(Re,p,b,ce)),Oe-=Ir,ce&&Oe<B){var St=bi(Re,nr);return dh(e,i,ao,pe.placeholder,o,Re,St,x,R,B-Oe)}var qr=G?o:this,ui=te?qr[e]:e;return Oe=Re.length,x?Re=yy(Re,x):de&&Oe>1&&Re.reverse(),H&&R<Oe&&(Re.length=R),this&&this!==Ce&&this instanceof pe&&(ui=Ee||Kn(ui)),ui.apply(qr,Re)}return pe}function lh(e,i){return function(o,c){return Sg(o,e,i(c),{})}}function co(e,i){return function(o,c){var l;if(o===r&&c===r)return i;if(o!==r&&(l=o),c!==r){if(l===r)return c;typeof o=="string"||typeof c=="string"?(o=wr(o),c=wr(c)):(o=Qu(o),c=Qu(c)),l=e(o,c)}return l}}function Ha(e){return si(function(i){return i=ot(i,br(le())),xe(function(o){var c=this;return e(i,function(l){return zt(l,c,o)})})})}function uo(e,i){i=i===r?" ":wr(i);var o=i.length;if(o<2)return o?Ua(i,e):i;var c=Ua(i,Js(e/hn(i)));return un(i)?Si(Ur(c),0,e).join(""):c.slice(0,e)}function Yg(e,i,o,c){var l=i&X,p=Kn(e);function b(){for(var x=-1,R=arguments.length,B=-1,H=c.length,G=j(H+R),te=this&&this!==Ce&&this instanceof b?p:e;++B<H;)G[B]=c[B];for(;R--;)G[B++]=arguments[++x];return zt(te,l?o:this,G)}return b}function fh(e){return function(i,o,c){return c&&typeof c!="number"&&ir(i,o,c)&&(o=c=r),i=ci(i),o===r?(o=i,i=0):o=ci(o),c=c===r?i<o?1:-1:ci(c),Fg(i,o,c,e)}}function ho(e){return function(i,o){return typeof i=="string"&&typeof o=="string"||(i=$r(i),o=$r(o)),e(i,o)}}function dh(e,i,o,c,l,p,b,x,R,B){var H=i&w,G=H?b:r,te=H?r:b,ce=H?p:r,de=H?r:p;i|=H?I:v,i&=~(H?v:I),i&y||(i&=~(X|he));var Ee=[e,i,l,ce,G,de,te,x,R,B],pe=o.apply(r,Ee);return Xa(e)&&xh(pe,Ee),pe.placeholder=c,Oh(pe,e,i)}function Va(e){var i=jt[e];return function(o,c){if(o=$r(o),c=c==null?0:Qt(we(c),292),c&&Ou(o)){var l=(je(o)+"e").split("e"),p=i(l[0]+"e"+(+l[1]+c));return l=(je(p)+"e").split("e"),+(l[0]+"e"+(+l[1]-c))}return i(o)}}var Xg=dn&&1/Ms(new dn([,-0]))[1]==fe?function(e){return new dn(e)}:dc;function ph(e){return function(i){var o=Yt(i);return o==_e?_a(i):o==Ue?gp(i):ap(i,e(i))}}function ni(e,i,o,c,l,p,b,x){var R=i&he;if(!R&&typeof e!="function")throw new Tr(f);var B=c?c.length:0;if(B||(i&=~(I|v),c=l=r),b=b===r?b:Mt(we(b),0),x=x===r?x:we(x),B-=l?l.length:0,i&v){var H=c,G=l;c=l=r}var te=R?r:Ga(e),ce=[e,i,o,c,l,H,G,p,b,x];if(te&&dy(ce,te),e=ce[0],i=ce[1],o=ce[2],c=ce[3],l=ce[4],x=ce[9]=ce[9]===r?R?0:e.length:Mt(ce[9]-B,0),!x&&i&(w|S)&&(i&=~(w|S)),!i||i==X)var de=Jg(e,i,o);else i==w||i==S?de=Qg(e,i,x):(i==I||i==(X|I))&&!l.length?de=Yg(e,i,o,c):de=ao.apply(r,ce);var Ee=te?Gu:xh;return Oh(Ee(de,ce),e,i)}function gh(e,i,o,c){return e===r||Mr(e,fn[o])&&!qe.call(c,o)?i:e}function yh(e,i,o,c,l,p){return ht(e)&&ht(i)&&(p.set(i,e),io(e,i,r,yh,p),p.delete(i)),e}function Zg(e){return Jn(e)?r:e}function mh(e,i,o,c,l,p){var b=o&W,x=e.length,R=i.length;if(x!=R&&!(b&&R>x))return!1;var B=p.get(e),H=p.get(i);if(B&&H)return B==i&&H==e;var G=-1,te=!0,ce=o&Y?new Mi:r;for(p.set(e,i),p.set(i,e);++G<x;){var de=e[G],Ee=i[G];if(c)var pe=b?c(Ee,de,G,i,e,p):c(de,Ee,G,e,i,p);if(pe!==r){if(pe)continue;te=!1;break}if(ce){if(!ga(i,function(Oe,Re){if(!Dn(ce,Re)&&(de===Oe||l(de,Oe,o,c,p)))return ce.push(Re)})){te=!1;break}}else if(!(de===Ee||l(de,Ee,o,c,p))){te=!1;break}}return p.delete(e),p.delete(i),te}function ey(e,i,o,c,l,p,b){switch(o){case Ve:if(e.byteLength!=i.byteLength||e.byteOffset!=i.byteOffset)return!1;e=e.buffer,i=i.buffer;case Le:return!(e.byteLength!=i.byteLength||!p(new Vs(e),new Vs(i)));case M:case $:case $e:return Mr(+e,+i);case O:return e.name==i.name&&e.message==i.message;case at:case Ze:return e==i+"";case _e:var x=_a;case Ue:var R=c&W;if(x||(x=Ms),e.size!=i.size&&!R)return!1;var B=b.get(e);if(B)return B==i;c|=Y,b.set(e,i);var H=mh(x(e),x(i),c,l,p,b);return b.delete(e),H;case et:if(qn)return qn.call(e)==qn.call(i)}return!1}function ty(e,i,o,c,l,p){var b=o&W,x=Ka(e),R=x.length,B=Ka(i),H=B.length;if(R!=H&&!b)return!1;for(var G=R;G--;){var te=x[G];if(!(b?te in i:qe.call(i,te)))return!1}var ce=p.get(e),de=p.get(i);if(ce&&de)return ce==i&&de==e;var Ee=!0;p.set(e,i),p.set(i,e);for(var pe=b;++G<R;){te=x[G];var Oe=e[te],Re=i[te];if(c)var Er=b?c(Re,Oe,te,i,e,p):c(Oe,Re,te,e,i,p);if(!(Er===r?Oe===Re||l(Oe,Re,o,c,p):Er)){Ee=!1;break}pe||(pe=te=="constructor")}if(Ee&&!pe){var nr=e.constructor,Ir=i.constructor;nr!=Ir&&"constructor"in e&&"constructor"in i&&!(typeof nr=="function"&&nr instanceof nr&&typeof Ir=="function"&&Ir instanceof Ir)&&(Ee=!1)}return p.delete(e),p.delete(i),Ee}function si(e){return ec(Ih(e,r,Nh),e+"")}function Ka(e){return Uu(e,kt,Qa)}function Wa(e){return Uu(e,dr,vh)}var Ga=Ys?function(e){return Ys.get(e)}:dc;function lo(e){for(var i=e.name+"",o=pn[i],c=qe.call(pn,i)?o.length:0;c--;){var l=o[c],p=l.func;if(p==null||p==e)return l.name}return i}function vn(e){var i=qe.call(d,"placeholder")?d:e;return i.placeholder}function le(){var e=d.iteratee||lc;return e=e===lc?qu:e,arguments.length?e(arguments[0],arguments[1]):e}function fo(e,i){var o=e.__data__;return uy(i)?o[typeof i=="string"?"string":"hash"]:o.map}function Ja(e){for(var i=kt(e),o=i.length;o--;){var c=i[o],l=e[c];i[o]=[c,l,_h(l)]}return i}function ki(e,i){var o=fp(e,i);return Mu(o)?o:r}function ry(e){var i=qe.call(e,Ui),o=e[Ui];try{e[Ui]=r;var c=!0}catch{}var l=Bs.call(e);return c&&(i?e[Ui]=o:delete e[Ui]),l}var Qa=Ia?function(e){return e==null?[]:(e=Je(e),mi(Ia(e),function(i){return Su.call(e,i)}))}:pc,vh=Ia?function(e){for(var i=[];e;)vi(i,Qa(e)),e=Ks(e);return i}:pc,Yt=rr;(Sa&&Yt(new Sa(new ArrayBuffer(1)))!=Ve||Un&&Yt(new Un)!=_e||xa&&Yt(xa.resolve())!=Pt||dn&&Yt(new dn)!=Ue||jn&&Yt(new jn)!=ze)&&(Yt=function(e){var i=rr(e),o=i==Te?e.constructor:r,c=o?Bi(o):"";if(c)switch(c){case jp:return Ve;case Mp:return _e;case qp:return Pt;case zp:return Ue;case kp:return ze}return i});function iy(e,i,o){for(var c=-1,l=o.length;++c<l;){var p=o[c],b=p.size;switch(p.type){case"drop":e+=b;break;case"dropRight":i-=b;break;case"take":i=Qt(i,e+b);break;case"takeRight":e=Mt(e,i-b);break}}return{start:e,end:i}}function ny(e){var i=e.match(Qe);return i?i[1].split(Nt):[]}function bh(e,i,o){i=Ii(i,e);for(var c=-1,l=i.length,p=!1;++c<l;){var b=Jr(i[c]);if(!(p=e!=null&&o(e,b)))break;e=e[b]}return p||++c!=l?p:(l=e==null?0:e.length,!!l&&wo(l)&&oi(b,l)&&(be(e)||Hi(e)))}function sy(e){var i=e.length,o=new e.constructor(i);return i&&typeof e[0]=="string"&&qe.call(e,"index")&&(o.index=e.index,o.input=e.input),o}function wh(e){return typeof e.constructor=="function"&&!Wn(e)?gn(Ks(e)):{}}function oy(e,i,o){var c=e.constructor;switch(i){case Le:return Ba(e);case M:case $:return new c(+e);case Ve:return Bg(e,o);case ft:case Me:case Tt:case Ut:case Kt:case Wt:case qt:case Zt:case ur:return rh(e,o);case _e:return new c;case $e:case Ze:return new c(e);case at:return Hg(e);case Ue:return new c;case et:return Vg(e)}}function ay(e,i){var o=i.length;if(!o)return e;var c=o-1;return i[c]=(o>1?"& ":"")+i[c],i=i.join(o>2?", ":" "),e.replace(vt,`{
/* [wrapped with `+i+`] */
`)}function cy(e){return be(e)||Hi(e)||!!(xu&&e&&e[xu])}function oi(e,i){var o=typeof e;return i=i??Q,!!i&&(o=="number"||o!="symbol"&&Zo.test(e))&&e>-1&&e%1==0&&e<i}function ir(e,i,o){if(!ht(o))return!1;var c=typeof i;return(c=="number"?fr(o)&&oi(i,o.length):c=="string"&&i in o)?Mr(o[i],e):!1}function Ya(e,i){if(be(e))return!1;var o=typeof e;return o=="number"||o=="symbol"||o=="boolean"||e==null||_r(e)?!0:At.test(e)||!st.test(e)||i!=null&&e in Je(i)}function uy(e){var i=typeof e;return i=="string"||i=="number"||i=="symbol"||i=="boolean"?e!=="__proto__":e===null}function Xa(e){var i=lo(e),o=d[i];if(typeof o!="function"||!(i in Ae.prototype))return!1;if(e===o)return!0;var c=Ga(o);return!!c&&e===c[0]}function hy(e){return!!_u&&_u in e}var ly=zs?ai:gc;function Wn(e){var i=e&&e.constructor,o=typeof i=="function"&&i.prototype||fn;return e===o}function _h(e){return e===e&&!ht(e)}function Eh(e,i){return function(o){return o==null?!1:o[e]===i&&(i!==r||e in Je(o))}}function fy(e){var i=vo(e,function(c){return o.size===T&&o.clear(),c}),o=i.cache;return i}function dy(e,i){var o=e[1],c=i[1],l=o|c,p=l<(X|he|N),b=c==N&&o==w||c==N&&o==L&&e[7].length<=i[8]||c==(N|L)&&i[7].length<=i[8]&&o==w;if(!(p||b))return e;c&X&&(e[2]=i[2],l|=o&X?0:y);var x=i[3];if(x){var R=e[3];e[3]=R?nh(R,x,i[4]):x,e[4]=R?bi(e[3],C):i[4]}return x=i[5],x&&(R=e[5],e[5]=R?sh(R,x,i[6]):x,e[6]=R?bi(e[5],C):i[6]),x=i[7],x&&(e[7]=x),c&N&&(e[8]=e[8]==null?i[8]:Qt(e[8],i[8])),e[9]==null&&(e[9]=i[9]),e[0]=i[0],e[1]=l,e}function py(e){var i=[];if(e!=null)for(var o in Je(e))i.push(o);return i}function gy(e){return Bs.call(e)}function Ih(e,i,o){return i=Mt(i===r?e.length-1:i,0),function(){for(var c=arguments,l=-1,p=Mt(c.length-i,0),b=j(p);++l<p;)b[l]=c[i+l];l=-1;for(var x=j(i+1);++l<i;)x[l]=c[l];return x[i]=o(b),zt(e,this,x)}}function Sh(e,i){return i.length<2?e:zi(e,Rr(i,0,-1))}function yy(e,i){for(var o=e.length,c=Qt(i.length,o),l=lr(e);c--;){var p=i[c];e[c]=oi(p,o)?l[p]:r}return e}function Za(e,i){if(!(i==="constructor"&&typeof e[i]=="function")&&i!="__proto__")return e[i]}var xh=Ph(Gu),Gn=Rp||function(e,i){return Ce.setTimeout(e,i)},ec=Ph(Mg);function Oh(e,i,o){var c=i+"";return ec(e,ay(c,my(ny(c),o)))}function Ph(e){var i=0,o=0;return function(){var c=Dp(),l=D-(c-o);if(o=c,l>0){if(++i>=Pe)return arguments[0]}else i=0;return e.apply(r,arguments)}}function po(e,i){var o=-1,c=e.length,l=c-1;for(i=i===r?c:i;++o<i;){var p=Fa(o,l),b=e[p];e[p]=e[o],e[o]=b}return e.length=i,e}var Th=fy(function(e){var i=[];return e.charCodeAt(0)===46&&i.push(""),e.replace(Ct,function(o,c,l,p){i.push(l?p.replace(Wo,"$1"):c||o)}),i});function Jr(e){if(typeof e=="string"||_r(e))return e;var i=e+"";return i=="0"&&1/e==-fe?"-0":i}function Bi(e){if(e!=null){try{return ks.call(e)}catch{}try{return e+""}catch{}}return""}function my(e,i){return Pr(Br,function(o){var c="_."+o[0];i&o[1]&&!Us(e,c)&&e.push(c)}),e.sort()}function Ah(e){if(e instanceof Ae)return e.clone();var i=new Ar(e.__wrapped__,e.__chain__);return i.__actions__=lr(e.__actions__),i.__index__=e.__index__,i.__values__=e.__values__,i}function vy(e,i,o){(o?ir(e,i,o):i===r)?i=1:i=Mt(we(i),0);var c=e==null?0:e.length;if(!c||i<1)return[];for(var l=0,p=0,b=j(Js(c/i));l<c;)b[p++]=Rr(e,l,l+=i);return b}function by(e){for(var i=-1,o=e==null?0:e.length,c=0,l=[];++i<o;){var p=e[i];p&&(l[c++]=p)}return l}function wy(){var e=arguments.length;if(!e)return[];for(var i=j(e-1),o=arguments[0],c=e;c--;)i[c-1]=arguments[c];return vi(be(o)?lr(o):[o],Gt(i,1))}var _y=xe(function(e,i){return It(e)?kn(e,Gt(i,1,It,!0)):[]}),Ey=xe(function(e,i){var o=Nr(i);return It(o)&&(o=r),It(e)?kn(e,Gt(i,1,It,!0),le(o,2)):[]}),Iy=xe(function(e,i){var o=Nr(i);return It(o)&&(o=r),It(e)?kn(e,Gt(i,1,It,!0),r,o):[]});function Sy(e,i,o){var c=e==null?0:e.length;return c?(i=o||i===r?1:we(i),Rr(e,i<0?0:i,c)):[]}function xy(e,i,o){var c=e==null?0:e.length;return c?(i=o||i===r?1:we(i),i=c-i,Rr(e,0,i<0?0:i)):[]}function Oy(e,i){return e&&e.length?so(e,le(i,3),!0,!0):[]}function Py(e,i){return e&&e.length?so(e,le(i,3),!0):[]}function Ty(e,i,o,c){var l=e==null?0:e.length;return l?(o&&typeof o!="number"&&ir(e,i,o)&&(o=0,c=l),wg(e,i,o,c)):[]}function Ch(e,i,o){var c=e==null?0:e.length;if(!c)return-1;var l=o==null?0:we(o);return l<0&&(l=Mt(c+l,0)),js(e,le(i,3),l)}function Rh(e,i,o){var c=e==null?0:e.length;if(!c)return-1;var l=c-1;return o!==r&&(l=we(o),l=o<0?Mt(c+l,0):Qt(l,c-1)),js(e,le(i,3),l,!0)}function Nh(e){var i=e==null?0:e.length;return i?Gt(e,1):[]}function Ay(e){var i=e==null?0:e.length;return i?Gt(e,fe):[]}function Cy(e,i){var o=e==null?0:e.length;return o?(i=i===r?1:we(i),Gt(e,i)):[]}function Ry(e){for(var i=-1,o=e==null?0:e.length,c={};++i<o;){var l=e[i];c[l[0]]=l[1]}return c}function $h(e){return e&&e.length?e[0]:r}function Ny(e,i,o){var c=e==null?0:e.length;if(!c)return-1;var l=o==null?0:we(o);return l<0&&(l=Mt(c+l,0)),cn(e,i,l)}function $y(e){var i=e==null?0:e.length;return i?Rr(e,0,-1):[]}var Ly=xe(function(e){var i=ot(e,za);return i.length&&i[0]===e[0]?Ra(i):[]}),Dy=xe(function(e){var i=Nr(e),o=ot(e,za);return i===Nr(o)?i=r:o.pop(),o.length&&o[0]===e[0]?Ra(o,le(i,2)):[]}),Fy=xe(function(e){var i=Nr(e),o=ot(e,za);return i=typeof i=="function"?i:r,i&&o.pop(),o.length&&o[0]===e[0]?Ra(o,r,i):[]});function Uy(e,i){return e==null?"":$p.call(e,i)}function Nr(e){var i=e==null?0:e.length;return i?e[i-1]:r}function jy(e,i,o){var c=e==null?0:e.length;if(!c)return-1;var l=c;return o!==r&&(l=we(o),l=l<0?Mt(c+l,0):Qt(l,c-1)),i===i?mp(e,i,l):js(e,du,l,!0)}function My(e,i){return e&&e.length?Hu(e,we(i)):r}var qy=xe(Lh);function Lh(e,i){return e&&e.length&&i&&i.length?Da(e,i):e}function zy(e,i,o){return e&&e.length&&i&&i.length?Da(e,i,le(o,2)):e}function ky(e,i,o){return e&&e.length&&i&&i.length?Da(e,i,r,o):e}var By=si(function(e,i){var o=e==null?0:e.length,c=Pa(e,i);return Wu(e,ot(i,function(l){return oi(l,o)?+l:l}).sort(ih)),c});function Hy(e,i){var o=[];if(!(e&&e.length))return o;var c=-1,l=[],p=e.length;for(i=le(i,3);++c<p;){var b=e[c];i(b,c,e)&&(o.push(b),l.push(c))}return Wu(e,l),o}function tc(e){return e==null?e:Up.call(e)}function Vy(e,i,o){var c=e==null?0:e.length;return c?(o&&typeof o!="number"&&ir(e,i,o)?(i=0,o=c):(i=i==null?0:we(i),o=o===r?c:we(o)),Rr(e,i,o)):[]}function Ky(e,i){return no(e,i)}function Wy(e,i,o){return ja(e,i,le(o,2))}function Gy(e,i){var o=e==null?0:e.length;if(o){var c=no(e,i);if(c<o&&Mr(e[c],i))return c}return-1}function Jy(e,i){return no(e,i,!0)}function Qy(e,i,o){return ja(e,i,le(o,2),!0)}function Yy(e,i){var o=e==null?0:e.length;if(o){var c=no(e,i,!0)-1;if(Mr(e[c],i))return c}return-1}function Xy(e){return e&&e.length?Ju(e):[]}function Zy(e,i){return e&&e.length?Ju(e,le(i,2)):[]}function e0(e){var i=e==null?0:e.length;return i?Rr(e,1,i):[]}function t0(e,i,o){return e&&e.length?(i=o||i===r?1:we(i),Rr(e,0,i<0?0:i)):[]}function r0(e,i,o){var c=e==null?0:e.length;return c?(i=o||i===r?1:we(i),i=c-i,Rr(e,i<0?0:i,c)):[]}function i0(e,i){return e&&e.length?so(e,le(i,3),!1,!0):[]}function n0(e,i){return e&&e.length?so(e,le(i,3)):[]}var s0=xe(function(e){return Ei(Gt(e,1,It,!0))}),o0=xe(function(e){var i=Nr(e);return It(i)&&(i=r),Ei(Gt(e,1,It,!0),le(i,2))}),a0=xe(function(e){var i=Nr(e);return i=typeof i=="function"?i:r,Ei(Gt(e,1,It,!0),r,i)});function c0(e){return e&&e.length?Ei(e):[]}function u0(e,i){return e&&e.length?Ei(e,le(i,2)):[]}function h0(e,i){return i=typeof i=="function"?i:r,e&&e.length?Ei(e,r,i):[]}function rc(e){if(!(e&&e.length))return[];var i=0;return e=mi(e,function(o){if(It(o))return i=Mt(o.length,i),!0}),ba(i,function(o){return ot(e,ya(o))})}function Dh(e,i){if(!(e&&e.length))return[];var o=rc(e);return i==null?o:ot(o,function(c){return zt(i,r,c)})}var l0=xe(function(e,i){return It(e)?kn(e,i):[]}),f0=xe(function(e){return qa(mi(e,It))}),d0=xe(function(e){var i=Nr(e);return It(i)&&(i=r),qa(mi(e,It),le(i,2))}),p0=xe(function(e){var i=Nr(e);return i=typeof i=="function"?i:r,qa(mi(e,It),r,i)}),g0=xe(rc);function y0(e,i){return Zu(e||[],i||[],zn)}function m0(e,i){return Zu(e||[],i||[],Vn)}var v0=xe(function(e){var i=e.length,o=i>1?e[i-1]:r;return o=typeof o=="function"?(e.pop(),o):r,Dh(e,o)});function Fh(e){var i=d(e);return i.__chain__=!0,i}function b0(e,i){return i(e),e}function go(e,i){return i(e)}var w0=si(function(e){var i=e.length,o=i?e[0]:0,c=this.__wrapped__,l=function(p){return Pa(p,e)};return i>1||this.__actions__.length||!(c instanceof Ae)||!oi(o)?this.thru(l):(c=c.slice(o,+o+(i?1:0)),c.__actions__.push({func:go,args:[l],thisArg:r}),new Ar(c,this.__chain__).thru(function(p){return i&&!p.length&&p.push(r),p}))});function _0(){return Fh(this)}function E0(){return new Ar(this.value(),this.__chain__)}function I0(){this.__values__===r&&(this.__values__=Qh(this.value()));var e=this.__index__>=this.__values__.length,i=e?r:this.__values__[this.__index__++];return{done:e,value:i}}function S0(){return this}function x0(e){for(var i,o=this;o instanceof Zs;){var c=Ah(o);c.__index__=0,c.__values__=r,i?l.__wrapped__=c:i=c;var l=c;o=o.__wrapped__}return l.__wrapped__=e,i}function O0(){var e=this.__wrapped__;if(e instanceof Ae){var i=e;return this.__actions__.length&&(i=new Ae(this)),i=i.reverse(),i.__actions__.push({func:go,args:[tc],thisArg:r}),new Ar(i,this.__chain__)}return this.thru(tc)}function P0(){return Xu(this.__wrapped__,this.__actions__)}var T0=oo(function(e,i,o){qe.call(e,o)?++e[o]:ii(e,o,1)});function A0(e,i,o){var c=be(e)?lu:bg;return o&&ir(e,i,o)&&(i=r),c(e,le(i,3))}function C0(e,i){var o=be(e)?mi:Du;return o(e,le(i,3))}var R0=uh(Ch),N0=uh(Rh);function $0(e,i){return Gt(yo(e,i),1)}function L0(e,i){return Gt(yo(e,i),fe)}function D0(e,i,o){return o=o===r?1:we(o),Gt(yo(e,i),o)}function Uh(e,i){var o=be(e)?Pr:_i;return o(e,le(i,3))}function jh(e,i){var o=be(e)?ep:Lu;return o(e,le(i,3))}var F0=oo(function(e,i,o){qe.call(e,o)?e[o].push(i):ii(e,o,[i])});function U0(e,i,o,c){e=fr(e)?e:wn(e),o=o&&!c?we(o):0;var l=e.length;return o<0&&(o=Mt(l+o,0)),_o(e)?o<=l&&e.indexOf(i,o)>-1:!!l&&cn(e,i,o)>-1}var j0=xe(function(e,i,o){var c=-1,l=typeof i=="function",p=fr(e)?j(e.length):[];return _i(e,function(b){p[++c]=l?zt(i,b,o):Bn(b,i,o)}),p}),M0=oo(function(e,i,o){ii(e,o,i)});function yo(e,i){var o=be(e)?ot:zu;return o(e,le(i,3))}function q0(e,i,o,c){return e==null?[]:(be(i)||(i=i==null?[]:[i]),o=c?r:o,be(o)||(o=o==null?[]:[o]),Vu(e,i,o))}var z0=oo(function(e,i,o){e[o?0:1].push(i)},function(){return[[],[]]});function k0(e,i,o){var c=be(e)?pa:gu,l=arguments.length<3;return c(e,le(i,4),o,l,_i)}function B0(e,i,o){var c=be(e)?tp:gu,l=arguments.length<3;return c(e,le(i,4),o,l,Lu)}function H0(e,i){var o=be(e)?mi:Du;return o(e,bo(le(i,3)))}function V0(e){var i=be(e)?Cu:Ug;return i(e)}function K0(e,i,o){(o?ir(e,i,o):i===r)?i=1:i=we(i);var c=be(e)?pg:jg;return c(e,i)}function W0(e){var i=be(e)?gg:qg;return i(e)}function G0(e){if(e==null)return 0;if(fr(e))return _o(e)?hn(e):e.length;var i=Yt(e);return i==_e||i==Ue?e.size:$a(e).length}function J0(e,i,o){var c=be(e)?ga:zg;return o&&ir(e,i,o)&&(i=r),c(e,le(i,3))}var Q0=xe(function(e,i){if(e==null)return[];var o=i.length;return o>1&&ir(e,i[0],i[1])?i=[]:o>2&&ir(i[0],i[1],i[2])&&(i=[i[0]]),Vu(e,Gt(i,1),[])}),mo=Cp||function(){return Ce.Date.now()};function Y0(e,i){if(typeof i!="function")throw new Tr(f);return e=we(e),function(){if(--e<1)return i.apply(this,arguments)}}function Mh(e,i,o){return i=o?r:i,i=e&&i==null?e.length:i,ni(e,N,r,r,r,r,i)}function qh(e,i){var o;if(typeof i!="function")throw new Tr(f);return e=we(e),function(){return--e>0&&(o=i.apply(this,arguments)),e<=1&&(i=r),o}}var ic=xe(function(e,i,o){var c=X;if(o.length){var l=bi(o,vn(ic));c|=I}return ni(e,c,i,o,l)}),zh=xe(function(e,i,o){var c=X|he;if(o.length){var l=bi(o,vn(zh));c|=I}return ni(i,c,e,o,l)});function kh(e,i,o){i=o?r:i;var c=ni(e,w,r,r,r,r,r,i);return c.placeholder=kh.placeholder,c}function Bh(e,i,o){i=o?r:i;var c=ni(e,S,r,r,r,r,r,i);return c.placeholder=Bh.placeholder,c}function Hh(e,i,o){var c,l,p,b,x,R,B=0,H=!1,G=!1,te=!0;if(typeof e!="function")throw new Tr(f);i=$r(i)||0,ht(o)&&(H=!!o.leading,G="maxWait"in o,p=G?Mt($r(o.maxWait)||0,i):p,te="trailing"in o?!!o.trailing:te);function ce(St){var qr=c,ui=l;return c=l=r,B=St,b=e.apply(ui,qr),b}function de(St){return B=St,x=Gn(Oe,i),H?ce(St):b}function Ee(St){var qr=St-R,ui=St-B,ul=i-qr;return G?Qt(ul,p-ui):ul}function pe(St){var qr=St-R,ui=St-B;return R===r||qr>=i||qr<0||G&&ui>=p}function Oe(){var St=mo();if(pe(St))return Re(St);x=Gn(Oe,Ee(St))}function Re(St){return x=r,te&&c?ce(St):(c=l=r,b)}function Er(){x!==r&&eh(x),B=0,c=R=l=x=r}function nr(){return x===r?b:Re(mo())}function Ir(){var St=mo(),qr=pe(St);if(c=arguments,l=this,R=St,qr){if(x===r)return de(R);if(G)return eh(x),x=Gn(Oe,i),ce(R)}return x===r&&(x=Gn(Oe,i)),b}return Ir.cancel=Er,Ir.flush=nr,Ir}var X0=xe(function(e,i){return $u(e,1,i)}),Z0=xe(function(e,i,o){return $u(e,$r(i)||0,o)});function em(e){return ni(e,ie)}function vo(e,i){if(typeof e!="function"||i!=null&&typeof i!="function")throw new Tr(f);var o=function(){var c=arguments,l=i?i.apply(this,c):c[0],p=o.cache;if(p.has(l))return p.get(l);var b=e.apply(this,c);return o.cache=p.set(l,b)||p,b};return o.cache=new(vo.Cache||ri),o}vo.Cache=ri;function bo(e){if(typeof e!="function")throw new Tr(f);return function(){var i=arguments;switch(i.length){case 0:return!e.call(this);case 1:return!e.call(this,i[0]);case 2:return!e.call(this,i[0],i[1]);case 3:return!e.call(this,i[0],i[1],i[2])}return!e.apply(this,i)}}function tm(e){return qh(2,e)}var rm=kg(function(e,i){i=i.length==1&&be(i[0])?ot(i[0],br(le())):ot(Gt(i,1),br(le()));var o=i.length;return xe(function(c){for(var l=-1,p=Qt(c.length,o);++l<p;)c[l]=i[l].call(this,c[l]);return zt(e,this,c)})}),nc=xe(function(e,i){var o=bi(i,vn(nc));return ni(e,I,r,i,o)}),Vh=xe(function(e,i){var o=bi(i,vn(Vh));return ni(e,v,r,i,o)}),im=si(function(e,i){return ni(e,L,r,r,r,i)});function nm(e,i){if(typeof e!="function")throw new Tr(f);return i=i===r?i:we(i),xe(e,i)}function sm(e,i){if(typeof e!="function")throw new Tr(f);return i=i==null?0:Mt(we(i),0),xe(function(o){var c=o[i],l=Si(o,0,i);return c&&vi(l,c),zt(e,this,l)})}function om(e,i,o){var c=!0,l=!0;if(typeof e!="function")throw new Tr(f);return ht(o)&&(c="leading"in o?!!o.leading:c,l="trailing"in o?!!o.trailing:l),Hh(e,i,{leading:c,maxWait:i,trailing:l})}function am(e){return Mh(e,1)}function cm(e,i){return nc(ka(i),e)}function um(){if(!arguments.length)return[];var e=arguments[0];return be(e)?e:[e]}function hm(e){return Cr(e,k)}function lm(e,i){return i=typeof i=="function"?i:r,Cr(e,k,i)}function fm(e){return Cr(e,F|k)}function dm(e,i){return i=typeof i=="function"?i:r,Cr(e,F|k,i)}function pm(e,i){return i==null||Nu(e,i,kt(i))}function Mr(e,i){return e===i||e!==e&&i!==i}var gm=ho(Ca),ym=ho(function(e,i){return e>=i}),Hi=ju(function(){return arguments}())?ju:function(e){return bt(e)&&qe.call(e,"callee")&&!Su.call(e,"callee")},be=j.isArray,mm=tr?br(tr):xg;function fr(e){return e!=null&&wo(e.length)&&!ai(e)}function It(e){return bt(e)&&fr(e)}function vm(e){return e===!0||e===!1||bt(e)&&rr(e)==M}var xi=Np||gc,bm=Fr?br(Fr):Og;function wm(e){return bt(e)&&e.nodeType===1&&!Jn(e)}function _m(e){if(e==null)return!0;if(fr(e)&&(be(e)||typeof e=="string"||typeof e.splice=="function"||xi(e)||bn(e)||Hi(e)))return!e.length;var i=Yt(e);if(i==_e||i==Ue)return!e.size;if(Wn(e))return!$a(e).length;for(var o in e)if(qe.call(e,o))return!1;return!0}function Em(e,i){return Hn(e,i)}function Im(e,i,o){o=typeof o=="function"?o:r;var c=o?o(e,i):r;return c===r?Hn(e,i,r,o):!!c}function sc(e){if(!bt(e))return!1;var i=rr(e);return i==O||i==h||typeof e.message=="string"&&typeof e.name=="string"&&!Jn(e)}function Sm(e){return typeof e=="number"&&Ou(e)}function ai(e){if(!ht(e))return!1;var i=rr(e);return i==ae||i==ge||i==q||i==wt}function Kh(e){return typeof e=="number"&&e==we(e)}function wo(e){return typeof e=="number"&&e>-1&&e%1==0&&e<=Q}function ht(e){var i=typeof e;return e!=null&&(i=="object"||i=="function")}function bt(e){return e!=null&&typeof e=="object"}var Wh=Or?br(Or):Tg;function xm(e,i){return e===i||Na(e,i,Ja(i))}function Om(e,i,o){return o=typeof o=="function"?o:r,Na(e,i,Ja(i),o)}function Pm(e){return Gh(e)&&e!=+e}function Tm(e){if(ly(e))throw new me(u);return Mu(e)}function Am(e){return e===null}function Cm(e){return e==null}function Gh(e){return typeof e=="number"||bt(e)&&rr(e)==$e}function Jn(e){if(!bt(e)||rr(e)!=Te)return!1;var i=Ks(e);if(i===null)return!0;var o=qe.call(i,"constructor")&&i.constructor;return typeof o=="function"&&o instanceof o&&ks.call(o)==Op}var oc=Kr?br(Kr):Ag;function Rm(e){return Kh(e)&&e>=-Q&&e<=Q}var Jh=Ln?br(Ln):Cg;function _o(e){return typeof e=="string"||!be(e)&&bt(e)&&rr(e)==Ze}function _r(e){return typeof e=="symbol"||bt(e)&&rr(e)==et}var bn=Fi?br(Fi):Rg;function Nm(e){return e===r}function $m(e){return bt(e)&&Yt(e)==ze}function Lm(e){return bt(e)&&rr(e)==tt}var Dm=ho(La),Fm=ho(function(e,i){return e<=i});function Qh(e){if(!e)return[];if(fr(e))return _o(e)?Ur(e):lr(e);if(Fn&&e[Fn])return pp(e[Fn]());var i=Yt(e),o=i==_e?_a:i==Ue?Ms:wn;return o(e)}function ci(e){if(!e)return e===0?e:0;if(e=$r(e),e===fe||e===-fe){var i=e<0?-1:1;return i*Z}return e===e?e:0}function we(e){var i=ci(e),o=i%1;return i===i?o?i-o:i:0}function Yh(e){return e?qi(we(e),0,ee):0}function $r(e){if(typeof e=="number")return e;if(_r(e))return J;if(ht(e)){var i=typeof e.valueOf=="function"?e.valueOf():e;e=ht(i)?i+"":i}if(typeof e!="string")return e===0?e:+e;e=yu(e);var o=Qo.test(e);return o||Xo.test(e)?ve(e.slice(2),o?2:8):Jo.test(e)?J:+e}function Xh(e){return Gr(e,dr(e))}function Um(e){return e?qi(we(e),-Q,Q):e===0?e:0}function je(e){return e==null?"":wr(e)}var jm=yn(function(e,i){if(Wn(i)||fr(i)){Gr(i,kt(i),e);return}for(var o in i)qe.call(i,o)&&zn(e,o,i[o])}),Zh=yn(function(e,i){Gr(i,dr(i),e)}),Eo=yn(function(e,i,o,c){Gr(i,dr(i),e,c)}),Mm=yn(function(e,i,o,c){Gr(i,kt(i),e,c)}),qm=si(Pa);function zm(e,i){var o=gn(e);return i==null?o:Ru(o,i)}var km=xe(function(e,i){e=Je(e);var o=-1,c=i.length,l=c>2?i[2]:r;for(l&&ir(i[0],i[1],l)&&(c=1);++o<c;)for(var p=i[o],b=dr(p),x=-1,R=b.length;++x<R;){var B=b[x],H=e[B];(H===r||Mr(H,fn[B])&&!qe.call(e,B))&&(e[B]=p[B])}return e}),Bm=xe(function(e){return e.push(r,yh),zt(el,r,e)});function Hm(e,i){return fu(e,le(i,3),Wr)}function Vm(e,i){return fu(e,le(i,3),Aa)}function Km(e,i){return e==null?e:Ta(e,le(i,3),dr)}function Wm(e,i){return e==null?e:Fu(e,le(i,3),dr)}function Gm(e,i){return e&&Wr(e,le(i,3))}function Jm(e,i){return e&&Aa(e,le(i,3))}function Qm(e){return e==null?[]:ro(e,kt(e))}function Ym(e){return e==null?[]:ro(e,dr(e))}function ac(e,i,o){var c=e==null?r:zi(e,i);return c===r?o:c}function Xm(e,i){return e!=null&&bh(e,i,_g)}function cc(e,i){return e!=null&&bh(e,i,Eg)}var Zm=lh(function(e,i,o){i!=null&&typeof i.toString!="function"&&(i=Bs.call(i)),e[i]=o},hc(pr)),ev=lh(function(e,i,o){i!=null&&typeof i.toString!="function"&&(i=Bs.call(i)),qe.call(e,i)?e[i].push(o):e[i]=[o]},le),tv=xe(Bn);function kt(e){return fr(e)?Au(e):$a(e)}function dr(e){return fr(e)?Au(e,!0):Ng(e)}function rv(e,i){var o={};return i=le(i,3),Wr(e,function(c,l,p){ii(o,i(c,l,p),c)}),o}function iv(e,i){var o={};return i=le(i,3),Wr(e,function(c,l,p){ii(o,l,i(c,l,p))}),o}var nv=yn(function(e,i,o){io(e,i,o)}),el=yn(function(e,i,o,c){io(e,i,o,c)}),sv=si(function(e,i){var o={};if(e==null)return o;var c=!1;i=ot(i,function(p){return p=Ii(p,e),c||(c=p.length>1),p}),Gr(e,Wa(e),o),c&&(o=Cr(o,F|V|k,Zg));for(var l=i.length;l--;)Ma(o,i[l]);return o});function ov(e,i){return tl(e,bo(le(i)))}var av=si(function(e,i){return e==null?{}:Lg(e,i)});function tl(e,i){if(e==null)return{};var o=ot(Wa(e),function(c){return[c]});return i=le(i),Ku(e,o,function(c,l){return i(c,l[0])})}function cv(e,i,o){i=Ii(i,e);var c=-1,l=i.length;for(l||(l=1,e=r);++c<l;){var p=e==null?r:e[Jr(i[c])];p===r&&(c=l,p=o),e=ai(p)?p.call(e):p}return e}function uv(e,i,o){return e==null?e:Vn(e,i,o)}function hv(e,i,o,c){return c=typeof c=="function"?c:r,e==null?e:Vn(e,i,o,c)}var rl=ph(kt),il=ph(dr);function lv(e,i,o){var c=be(e),l=c||xi(e)||bn(e);if(i=le(i,4),o==null){var p=e&&e.constructor;l?o=c?new p:[]:ht(e)?o=ai(p)?gn(Ks(e)):{}:o={}}return(l?Pr:Wr)(e,function(b,x,R){return i(o,b,x,R)}),o}function fv(e,i){return e==null?!0:Ma(e,i)}function dv(e,i,o){return e==null?e:Yu(e,i,ka(o))}function pv(e,i,o,c){return c=typeof c=="function"?c:r,e==null?e:Yu(e,i,ka(o),c)}function wn(e){return e==null?[]:wa(e,kt(e))}function gv(e){return e==null?[]:wa(e,dr(e))}function yv(e,i,o){return o===r&&(o=i,i=r),o!==r&&(o=$r(o),o=o===o?o:0),i!==r&&(i=$r(i),i=i===i?i:0),qi($r(e),i,o)}function mv(e,i,o){return i=ci(i),o===r?(o=i,i=0):o=ci(o),e=$r(e),Ig(e,i,o)}function vv(e,i,o){if(o&&typeof o!="boolean"&&ir(e,i,o)&&(i=o=r),o===r&&(typeof i=="boolean"?(o=i,i=r):typeof e=="boolean"&&(o=e,e=r)),e===r&&i===r?(e=0,i=1):(e=ci(e),i===r?(i=e,e=0):i=ci(i)),e>i){var c=e;e=i,i=c}if(o||e%1||i%1){var l=Pu();return Qt(e+l*(i-e+We("1e-"+((l+"").length-1))),i)}return Fa(e,i)}var bv=mn(function(e,i,o){return i=i.toLowerCase(),e+(o?nl(i):i)});function nl(e){return uc(je(e).toLowerCase())}function sl(e){return e=je(e),e&&e.replace(Zr,up).replace(la,"")}function wv(e,i,o){e=je(e),i=wr(i);var c=e.length;o=o===r?c:qi(we(o),0,c);var l=o;return o-=i.length,o>=0&&e.slice(o,l)==i}function _v(e){return e=je(e),e&&nt.test(e)?e.replace(Ri,hp):e}function Ev(e){return e=je(e),e&&Rt.test(e)?e.replace(yt,"\\$&"):e}var Iv=mn(function(e,i,o){return e+(o?"-":"")+i.toLowerCase()}),Sv=mn(function(e,i,o){return e+(o?" ":"")+i.toLowerCase()}),xv=ch("toLowerCase");function Ov(e,i,o){e=je(e),i=we(i);var c=i?hn(e):0;if(!i||c>=i)return e;var l=(i-c)/2;return uo(Qs(l),o)+e+uo(Js(l),o)}function Pv(e,i,o){e=je(e),i=we(i);var c=i?hn(e):0;return i&&c<i?e+uo(i-c,o):e}function Tv(e,i,o){e=je(e),i=we(i);var c=i?hn(e):0;return i&&c<i?uo(i-c,o)+e:e}function Av(e,i,o){return o||i==null?i=0:i&&(i=+i),Fp(je(e).replace(mt,""),i||0)}function Cv(e,i,o){return(o?ir(e,i,o):i===r)?i=1:i=we(i),Ua(je(e),i)}function Rv(){var e=arguments,i=je(e[0]);return e.length<3?i:i.replace(e[1],e[2])}var Nv=mn(function(e,i,o){return e+(o?"_":"")+i.toLowerCase()});function $v(e,i,o){return o&&typeof o!="number"&&ir(e,i,o)&&(i=o=r),o=o===r?ee:o>>>0,o?(e=je(e),e&&(typeof i=="string"||i!=null&&!oc(i))&&(i=wr(i),!i&&un(e))?Si(Ur(e),0,o):e.split(i,o)):[]}var Lv=mn(function(e,i,o){return e+(o?" ":"")+uc(i)});function Dv(e,i,o){return e=je(e),o=o==null?0:qi(we(o),0,e.length),i=wr(i),e.slice(o,o+i.length)==i}function Fv(e,i,o){var c=d.templateSettings;o&&ir(e,i,o)&&(i=r),e=je(e),i=Eo({},i,c,gh);var l=Eo({},i.imports,c.imports,gh),p=kt(l),b=wa(l,p),x,R,B=0,H=i.interpolate||en,G="__p += '",te=Ea((i.escape||en).source+"|"+H.source+"|"+(H===ut?Go:en).source+"|"+(i.evaluate||en).source+"|$","g"),ce="//# sourceURL="+(qe.call(i,"sourceURL")?(i.sourceURL+"").replace(/\s/g," "):"lodash.templateSources["+ ++fa+"]")+`
`;e.replace(te,function(pe,Oe,Re,Er,nr,Ir){return Re||(Re=Er),G+=e.slice(B,Ir).replace(ea,lp),Oe&&(x=!0,G+=`' +
__e(`+Oe+`) +
'`),nr&&(R=!0,G+=`';
`+nr+`;
__p += '`),Re&&(G+=`' +
((__t = (`+Re+`)) == null ? '' : __t) +
'`),B=Ir+pe.length,pe}),G+=`';
`;var de=qe.call(i,"variable")&&i.variable;if(!de)G=`with (obj) {
`+G+`
}
`;else if(Ko.test(de))throw new me(g);G=(R?G.replace(Hr,""):G).replace(er,"$1").replace(Xr,"$1;"),G="function("+(de||"obj")+`) {
`+(de?"":`obj || (obj = {});
`)+"var __t, __p = ''"+(x?", __e = _.escape":"")+(R?`, __j = Array.prototype.join;
function print() { __p += __j.call(arguments, '') }
`:`;
`)+G+`return __p
}`;var Ee=al(function(){return Fe(p,ce+"return "+G).apply(r,b)});if(Ee.source=G,sc(Ee))throw Ee;return Ee}function Uv(e){return je(e).toLowerCase()}function jv(e){return je(e).toUpperCase()}function Mv(e,i,o){if(e=je(e),e&&(o||i===r))return yu(e);if(!e||!(i=wr(i)))return e;var c=Ur(e),l=Ur(i),p=mu(c,l),b=vu(c,l)+1;return Si(c,p,b).join("")}function qv(e,i,o){if(e=je(e),e&&(o||i===r))return e.slice(0,wu(e)+1);if(!e||!(i=wr(i)))return e;var c=Ur(e),l=vu(c,Ur(i))+1;return Si(c,0,l).join("")}function zv(e,i,o){if(e=je(e),e&&(o||i===r))return e.replace(mt,"");if(!e||!(i=wr(i)))return e;var c=Ur(e),l=mu(c,Ur(i));return Si(c,l).join("")}function kv(e,i){var o=ne,c=Ie;if(ht(i)){var l="separator"in i?i.separator:l;o="length"in i?we(i.length):o,c="omission"in i?wr(i.omission):c}e=je(e);var p=e.length;if(un(e)){var b=Ur(e);p=b.length}if(o>=p)return e;var x=o-hn(c);if(x<1)return c;var R=b?Si(b,0,x).join(""):e.slice(0,x);if(l===r)return R+c;if(b&&(x+=R.length-x),oc(l)){if(e.slice(x).search(l)){var B,H=R;for(l.global||(l=Ea(l.source,je(xr.exec(l))+"g")),l.lastIndex=0;B=l.exec(H);)var G=B.index;R=R.slice(0,G===r?x:G)}}else if(e.indexOf(wr(l),x)!=x){var te=R.lastIndexOf(l);te>-1&&(R=R.slice(0,te))}return R+c}function Bv(e){return e=je(e),e&&dt.test(e)?e.replace(gi,vp):e}var Hv=mn(function(e,i,o){return e+(o?" ":"")+i.toUpperCase()}),uc=ch("toUpperCase");function ol(e,i,o){return e=je(e),i=o?r:i,i===r?dp(e)?_p(e):np(e):e.match(i)||[]}var al=xe(function(e,i){try{return zt(e,r,i)}catch(o){return sc(o)?o:new me(o)}}),Vv=si(function(e,i){return Pr(i,function(o){o=Jr(o),ii(e,o,ic(e[o],e))}),e});function Kv(e){var i=e==null?0:e.length,o=le();return e=i?ot(e,function(c){if(typeof c[1]!="function")throw new Tr(f);return[o(c[0]),c[1]]}):[],xe(function(c){for(var l=-1;++l<i;){var p=e[l];if(zt(p[0],this,c))return zt(p[1],this,c)}})}function Wv(e){return vg(Cr(e,F))}function hc(e){return function(){return e}}function Gv(e,i){return e==null||e!==e?i:e}var Jv=hh(),Qv=hh(!0);function pr(e){return e}function lc(e){return qu(typeof e=="function"?e:Cr(e,F))}function Yv(e){return ku(Cr(e,F))}function Xv(e,i){return Bu(e,Cr(i,F))}var Zv=xe(function(e,i){return function(o){return Bn(o,e,i)}}),e1=xe(function(e,i){return function(o){return Bn(e,o,i)}});function fc(e,i,o){var c=kt(i),l=ro(i,c);o==null&&!(ht(i)&&(l.length||!c.length))&&(o=i,i=e,e=this,l=ro(i,kt(i)));var p=!(ht(o)&&"chain"in o)||!!o.chain,b=ai(e);return Pr(l,function(x){var R=i[x];e[x]=R,b&&(e.prototype[x]=function(){var B=this.__chain__;if(p||B){var H=e(this.__wrapped__),G=H.__actions__=lr(this.__actions__);return G.push({func:R,args:arguments,thisArg:e}),H.__chain__=B,H}return R.apply(e,vi([this.value()],arguments))})}),e}function t1(){return Ce._===this&&(Ce._=Pp),this}function dc(){}function r1(e){return e=we(e),xe(function(i){return Hu(i,e)})}var i1=Ha(ot),n1=Ha(lu),s1=Ha(ga);function cl(e){return Ya(e)?ya(Jr(e)):Dg(e)}function o1(e){return function(i){return e==null?r:zi(e,i)}}var a1=fh(),c1=fh(!0);function pc(){return[]}function gc(){return!1}function u1(){return{}}function h1(){return""}function l1(){return!0}function f1(e,i){if(e=we(e),e<1||e>Q)return[];var o=ee,c=Qt(e,ee);i=le(i),e-=ee;for(var l=ba(c,i);++o<e;)i(o);return l}function d1(e){return be(e)?ot(e,Jr):_r(e)?[e]:lr(Th(je(e)))}function p1(e){var i=++xp;return je(e)+i}var g1=co(function(e,i){return e+i},0),y1=Va("ceil"),m1=co(function(e,i){return e/i},1),v1=Va("floor");function b1(e){return e&&e.length?to(e,pr,Ca):r}function w1(e,i){return e&&e.length?to(e,le(i,2),Ca):r}function _1(e){return pu(e,pr)}function E1(e,i){return pu(e,le(i,2))}function I1(e){return e&&e.length?to(e,pr,La):r}function S1(e,i){return e&&e.length?to(e,le(i,2),La):r}var x1=co(function(e,i){return e*i},1),O1=Va("round"),P1=co(function(e,i){return e-i},0);function T1(e){return e&&e.length?va(e,pr):0}function A1(e,i){return e&&e.length?va(e,le(i,2)):0}return d.after=Y0,d.ary=Mh,d.assign=jm,d.assignIn=Zh,d.assignInWith=Eo,d.assignWith=Mm,d.at=qm,d.before=qh,d.bind=ic,d.bindAll=Vv,d.bindKey=zh,d.castArray=um,d.chain=Fh,d.chunk=vy,d.compact=by,d.concat=wy,d.cond=Kv,d.conforms=Wv,d.constant=hc,d.countBy=T0,d.create=zm,d.curry=kh,d.curryRight=Bh,d.debounce=Hh,d.defaults=km,d.defaultsDeep=Bm,d.defer=X0,d.delay=Z0,d.difference=_y,d.differenceBy=Ey,d.differenceWith=Iy,d.drop=Sy,d.dropRight=xy,d.dropRightWhile=Oy,d.dropWhile=Py,d.fill=Ty,d.filter=C0,d.flatMap=$0,d.flatMapDeep=L0,d.flatMapDepth=D0,d.flatten=Nh,d.flattenDeep=Ay,d.flattenDepth=Cy,d.flip=em,d.flow=Jv,d.flowRight=Qv,d.fromPairs=Ry,d.functions=Qm,d.functionsIn=Ym,d.groupBy=F0,d.initial=$y,d.intersection=Ly,d.intersectionBy=Dy,d.intersectionWith=Fy,d.invert=Zm,d.invertBy=ev,d.invokeMap=j0,d.iteratee=lc,d.keyBy=M0,d.keys=kt,d.keysIn=dr,d.map=yo,d.mapKeys=rv,d.mapValues=iv,d.matches=Yv,d.matchesProperty=Xv,d.memoize=vo,d.merge=nv,d.mergeWith=el,d.method=Zv,d.methodOf=e1,d.mixin=fc,d.negate=bo,d.nthArg=r1,d.omit=sv,d.omitBy=ov,d.once=tm,d.orderBy=q0,d.over=i1,d.overArgs=rm,d.overEvery=n1,d.overSome=s1,d.partial=nc,d.partialRight=Vh,d.partition=z0,d.pick=av,d.pickBy=tl,d.property=cl,d.propertyOf=o1,d.pull=qy,d.pullAll=Lh,d.pullAllBy=zy,d.pullAllWith=ky,d.pullAt=By,d.range=a1,d.rangeRight=c1,d.rearg=im,d.reject=H0,d.remove=Hy,d.rest=nm,d.reverse=tc,d.sampleSize=K0,d.set=uv,d.setWith=hv,d.shuffle=W0,d.slice=Vy,d.sortBy=Q0,d.sortedUniq=Xy,d.sortedUniqBy=Zy,d.split=$v,d.spread=sm,d.tail=e0,d.take=t0,d.takeRight=r0,d.takeRightWhile=i0,d.takeWhile=n0,d.tap=b0,d.throttle=om,d.thru=go,d.toArray=Qh,d.toPairs=rl,d.toPairsIn=il,d.toPath=d1,d.toPlainObject=Xh,d.transform=lv,d.unary=am,d.union=s0,d.unionBy=o0,d.unionWith=a0,d.uniq=c0,d.uniqBy=u0,d.uniqWith=h0,d.unset=fv,d.unzip=rc,d.unzipWith=Dh,d.update=dv,d.updateWith=pv,d.values=wn,d.valuesIn=gv,d.without=l0,d.words=ol,d.wrap=cm,d.xor=f0,d.xorBy=d0,d.xorWith=p0,d.zip=g0,d.zipObject=y0,d.zipObjectDeep=m0,d.zipWith=v0,d.entries=rl,d.entriesIn=il,d.extend=Zh,d.extendWith=Eo,fc(d,d),d.add=g1,d.attempt=al,d.camelCase=bv,d.capitalize=nl,d.ceil=y1,d.clamp=yv,d.clone=hm,d.cloneDeep=fm,d.cloneDeepWith=dm,d.cloneWith=lm,d.conformsTo=pm,d.deburr=sl,d.defaultTo=Gv,d.divide=m1,d.endsWith=wv,d.eq=Mr,d.escape=_v,d.escapeRegExp=Ev,d.every=A0,d.find=R0,d.findIndex=Ch,d.findKey=Hm,d.findLast=N0,d.findLastIndex=Rh,d.findLastKey=Vm,d.floor=v1,d.forEach=Uh,d.forEachRight=jh,d.forIn=Km,d.forInRight=Wm,d.forOwn=Gm,d.forOwnRight=Jm,d.get=ac,d.gt=gm,d.gte=ym,d.has=Xm,d.hasIn=cc,d.head=$h,d.identity=pr,d.includes=U0,d.indexOf=Ny,d.inRange=mv,d.invoke=tv,d.isArguments=Hi,d.isArray=be,d.isArrayBuffer=mm,d.isArrayLike=fr,d.isArrayLikeObject=It,d.isBoolean=vm,d.isBuffer=xi,d.isDate=bm,d.isElement=wm,d.isEmpty=_m,d.isEqual=Em,d.isEqualWith=Im,d.isError=sc,d.isFinite=Sm,d.isFunction=ai,d.isInteger=Kh,d.isLength=wo,d.isMap=Wh,d.isMatch=xm,d.isMatchWith=Om,d.isNaN=Pm,d.isNative=Tm,d.isNil=Cm,d.isNull=Am,d.isNumber=Gh,d.isObject=ht,d.isObjectLike=bt,d.isPlainObject=Jn,d.isRegExp=oc,d.isSafeInteger=Rm,d.isSet=Jh,d.isString=_o,d.isSymbol=_r,d.isTypedArray=bn,d.isUndefined=Nm,d.isWeakMap=$m,d.isWeakSet=Lm,d.join=Uy,d.kebabCase=Iv,d.last=Nr,d.lastIndexOf=jy,d.lowerCase=Sv,d.lowerFirst=xv,d.lt=Dm,d.lte=Fm,d.max=b1,d.maxBy=w1,d.mean=_1,d.meanBy=E1,d.min=I1,d.minBy=S1,d.stubArray=pc,d.stubFalse=gc,d.stubObject=u1,d.stubString=h1,d.stubTrue=l1,d.multiply=x1,d.nth=My,d.noConflict=t1,d.noop=dc,d.now=mo,d.pad=Ov,d.padEnd=Pv,d.padStart=Tv,d.parseInt=Av,d.random=vv,d.reduce=k0,d.reduceRight=B0,d.repeat=Cv,d.replace=Rv,d.result=cv,d.round=O1,d.runInContext=A,d.sample=V0,d.size=G0,d.snakeCase=Nv,d.some=J0,d.sortedIndex=Ky,d.sortedIndexBy=Wy,d.sortedIndexOf=Gy,d.sortedLastIndex=Jy,d.sortedLastIndexBy=Qy,d.sortedLastIndexOf=Yy,d.startCase=Lv,d.startsWith=Dv,d.subtract=P1,d.sum=T1,d.sumBy=A1,d.template=Fv,d.times=f1,d.toFinite=ci,d.toInteger=we,d.toLength=Yh,d.toLower=Uv,d.toNumber=$r,d.toSafeInteger=Um,d.toString=je,d.toUpper=jv,d.trim=Mv,d.trimEnd=qv,d.trimStart=zv,d.truncate=kv,d.unescape=Bv,d.uniqueId=p1,d.upperCase=Hv,d.upperFirst=uc,d.each=Uh,d.eachRight=jh,d.first=$h,fc(d,function(){var e={};return Wr(d,function(i,o){qe.call(d.prototype,o)||(e[o]=i)}),e}(),{chain:!1}),d.VERSION=s,Pr(["bind","bindKey","curry","curryRight","partial","partialRight"],function(e){d[e].placeholder=d}),Pr(["drop","take"],function(e,i){Ae.prototype[e]=function(o){o=o===r?1:Mt(we(o),0);var c=this.__filtered__&&!i?new Ae(this):this.clone();return c.__filtered__?c.__takeCount__=Qt(o,c.__takeCount__):c.__views__.push({size:Qt(o,ee),type:e+(c.__dir__<0?"Right":"")}),c},Ae.prototype[e+"Right"]=function(o){return this.reverse()[e](o).reverse()}}),Pr(["filter","map","takeWhile"],function(e,i){var o=i+1,c=o==E||o==ye;Ae.prototype[e]=function(l){var p=this.clone();return p.__iteratees__.push({iteratee:le(l,3),type:o}),p.__filtered__=p.__filtered__||c,p}}),Pr(["head","last"],function(e,i){var o="take"+(i?"Right":"");Ae.prototype[e]=function(){return this[o](1).value()[0]}}),Pr(["initial","tail"],function(e,i){var o="drop"+(i?"":"Right");Ae.prototype[e]=function(){return this.__filtered__?new Ae(this):this[o](1)}}),Ae.prototype.compact=function(){return this.filter(pr)},Ae.prototype.find=function(e){return this.filter(e).head()},Ae.prototype.findLast=function(e){return this.reverse().find(e)},Ae.prototype.invokeMap=xe(function(e,i){return typeof e=="function"?new Ae(this):this.map(function(o){return Bn(o,e,i)})}),Ae.prototype.reject=function(e){return this.filter(bo(le(e)))},Ae.prototype.slice=function(e,i){e=we(e);var o=this;return o.__filtered__&&(e>0||i<0)?new Ae(o):(e<0?o=o.takeRight(-e):e&&(o=o.drop(e)),i!==r&&(i=we(i),o=i<0?o.dropRight(-i):o.take(i-e)),o)},Ae.prototype.takeRightWhile=function(e){return this.reverse().takeWhile(e).reverse()},Ae.prototype.toArray=function(){return this.take(ee)},Wr(Ae.prototype,function(e,i){var o=/^(?:filter|find|map|reject)|While$/.test(i),c=/^(?:head|last)$/.test(i),l=d[c?"take"+(i=="last"?"Right":""):i],p=c||/^find/.test(i);l&&(d.prototype[i]=function(){var b=this.__wrapped__,x=c?[1]:arguments,R=b instanceof Ae,B=x[0],H=R||be(b),G=function(Oe){var Re=l.apply(d,vi([Oe],x));return c&&te?Re[0]:Re};H&&o&&typeof B=="function"&&B.length!=1&&(R=H=!1);var te=this.__chain__,ce=!!this.__actions__.length,de=p&&!te,Ee=R&&!ce;if(!p&&H){b=Ee?b:new Ae(this);var pe=e.apply(b,x);return pe.__actions__.push({func:go,args:[G],thisArg:r}),new Ar(pe,te)}return de&&Ee?e.apply(this,x):(pe=this.thru(G),de?c?pe.value()[0]:pe.value():pe)})}),Pr(["pop","push","shift","sort","splice","unshift"],function(e){var i=qs[e],o=/^(?:push|sort|unshift)$/.test(e)?"tap":"thru",c=/^(?:pop|shift)$/.test(e);d.prototype[e]=function(){var l=arguments;if(c&&!this.__chain__){var p=this.value();return i.apply(be(p)?p:[],l)}return this[o](function(b){return i.apply(be(b)?b:[],l)})}}),Wr(Ae.prototype,function(e,i){var o=d[i];if(o){var c=o.name+"";qe.call(pn,c)||(pn[c]=[]),pn[c].push({name:i,func:o})}}),pn[ao(r,he).name]=[{name:"wrapper",func:r}],Ae.prototype.clone=Bp,Ae.prototype.reverse=Hp,Ae.prototype.value=Vp,d.prototype.at=w0,d.prototype.chain=_0,d.prototype.commit=E0,d.prototype.next=I0,d.prototype.plant=x0,d.prototype.reverse=O0,d.prototype.toJSON=d.prototype.valueOf=d.prototype.value=P0,d.prototype.first=d.prototype.head,Fn&&(d.prototype[Fn]=S0),d},ln=Ep();Et?((Et.exports=ln)._=ln,Ge._=ln):Ce._=ln}).call(ns)})(kc,kc.exports);var mx=Object.defineProperty,vx=Object.defineProperties,bx=Object.getOwnPropertyDescriptors,Nf=Object.getOwnPropertySymbols,wx=Object.prototype.hasOwnProperty,_x=Object.prototype.propertyIsEnumerable,$f=(n,t,r)=>t in n?mx(n,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):n[t]=r,xo=(n,t)=>{for(var r in t||(t={}))wx.call(t,r)&&$f(n,r,t[r]);if(Nf)for(var r of Nf(t))_x.call(t,r)&&$f(n,r,t[r]);return n},Ex=(n,t)=>vx(n,bx(t));function Cn(n,t,r){var s;const a=nx(n);return((s=t.rpcMap)==null?void 0:s[a.reference])||`${yx}?chainId=${a.namespace}:${a.reference}&projectId=${r}`}function Zi(n){return n.includes(":")?n.split(":")[1]:n}function Yd(n){return n.map(t=>`${t.split(":")[0]}:${t.split(":")[1]}`)}function Ix(n,t){const r=Object.keys(t.namespaces).filter(a=>a.includes(n));if(!r.length)return[];const s=[];return r.forEach(a=>{const u=t.namespaces[a].accounts;s.push(...u)}),s}function Sx(n={},t={}){const r=Lf(n),s=Lf(t);return kc.exports.merge(r,s)}function Lf(n){var t,r,s,a;const u={};if(!ox(n))return u;for(const[f,g]of Object.entries(n)){const _=cu(f)?[f]:g.chains,T=g.methods||[],C=g.events||[],F=g.rpcMap||{},V=os(f);u[V]=Ex(xo(xo({},u[V]),g),{chains:Ac(_,(t=u[V])==null?void 0:t.chains),methods:Ac(T,(r=u[V])==null?void 0:r.methods),events:Ac(C,(s=u[V])==null?void 0:s.events),rpcMap:xo(xo({},F),(a=u[V])==null?void 0:a.rpcMap)})}return u}function xx(n){return n.includes(":")?n.split(":")[2]:n}function Ox(n){const t={};for(const[r,s]of Object.entries(n)){const a=s.methods||[],u=s.events||[],f=s.accounts||[],g=cu(r)?[r]:s.chains?s.chains:Yd(s.accounts);t[r]={chains:g,methods:a,events:u,accounts:f}}return t}function Cc(n){return typeof n=="number"?n:n.includes("0x")?parseInt(n,16):n.includes(":")?Number(n.split(":")[1]):Number(n)}const Xd={},xt=n=>Xd[n],Rc=(n,t)=>{Xd[n]=t};class Px{constructor(t){this.name="polkadot",this.namespace=t.namespace,this.events=xt("events"),this.client=xt("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(t){this.namespace=Object.assign(this.namespace,t)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const t=this.namespace.chains[0];if(!t)throw new Error("ChainId not found");return t.split(":")[1]}request(t){return this.namespace.methods.includes(t.request.method)?this.client.request(t):this.getHttpProvider().request(t.request)}setDefaultChain(t,r){this.httpProviders[t]||this.setHttpProvider(t,r),this.chainId=t,this.events.emit(Ci.DEFAULT_CHAIN_CHANGED,`${this.name}:${t}`)}getAccounts(){const t=this.namespace.accounts;return t?t.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2])||[]:[]}createHttpProviders(){const t={};return this.namespace.chains.forEach(r=>{var s;const a=Zi(r);t[a]=this.createHttpProvider(a,(s=this.namespace.rpcMap)==null?void 0:s[r])}),t}getHttpProvider(){const t=`${this.name}:${this.chainId}`,r=this.httpProviders[t];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${t} not found`);return r}setHttpProvider(t,r){const s=this.createHttpProvider(t,r);s&&(this.httpProviders[t]=s)}createHttpProvider(t,r){const s=r||Cn(t,this.namespace,this.client.core.projectId);if(!s)throw new Error(`No RPC url provided for chainId: ${t}`);return new Ai(new Xi(s,xt("disableProviderPing")))}}class Tx{constructor(t){this.name="eip155",this.namespace=t.namespace,this.events=xt("events"),this.client=xt("client"),this.httpProviders=this.createHttpProviders(),this.chainId=parseInt(this.getDefaultChain())}async request(t){switch(t.request.method){case"eth_requestAccounts":return this.getAccounts();case"eth_accounts":return this.getAccounts();case"wallet_switchEthereumChain":return await this.handleSwitchChain(t);case"eth_chainId":return parseInt(this.getDefaultChain())}return this.namespace.methods.includes(t.request.method)?await this.client.request(t):this.getHttpProvider().request(t.request)}updateNamespace(t){this.namespace=Object.assign(this.namespace,t)}setDefaultChain(t,r){this.httpProviders[t]||this.setHttpProvider(parseInt(t),r),this.chainId=parseInt(t),this.events.emit(Ci.DEFAULT_CHAIN_CHANGED,`${this.name}:${t}`)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId.toString();if(this.namespace.defaultChain)return this.namespace.defaultChain;const t=this.namespace.chains[0];if(!t)throw new Error("ChainId not found");return t.split(":")[1]}createHttpProvider(t,r){const s=r||Cn(`${this.name}:${t}`,this.namespace,this.client.core.projectId);if(!s)throw new Error(`No RPC url provided for chainId: ${t}`);return new Ai(new Xi(s,xt("disableProviderPing")))}setHttpProvider(t,r){const s=this.createHttpProvider(t,r);s&&(this.httpProviders[t]=s)}createHttpProviders(){const t={};return this.namespace.chains.forEach(r=>{var s;const a=parseInt(Zi(r));t[a]=this.createHttpProvider(a,(s=this.namespace.rpcMap)==null?void 0:s[r])}),t}getAccounts(){const t=this.namespace.accounts;return t?[...new Set(t.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2]))]:[]}getHttpProvider(){const t=this.chainId,r=this.httpProviders[t];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${t} not found`);return r}async handleSwitchChain(t){var r,s;let a=t.request.params?(r=t.request.params[0])==null?void 0:r.chainId:"0x0";a=a.startsWith("0x")?a:`0x${a}`;const u=parseInt(a,16);if(this.isChainApproved(u))this.setDefaultChain(`${u}`);else if(this.namespace.methods.includes("wallet_switchEthereumChain"))await this.client.request({topic:t.topic,request:{method:t.request.method,params:[{chainId:a}]},chainId:(s=this.namespace.chains)==null?void 0:s[0]}),this.setDefaultChain(`${u}`);else throw new Error(`Failed to switch to chain 'eip155:${u}'. The chain is not approved or the wallet does not support 'wallet_switchEthereumChain' method.`);return null}isChainApproved(t){return this.namespace.chains.includes(`${this.name}:${t}`)}}class Ax{constructor(t){this.name="solana",this.namespace=t.namespace,this.events=xt("events"),this.client=xt("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(t){this.namespace=Object.assign(this.namespace,t)}requestAccounts(){return this.getAccounts()}request(t){return this.namespace.methods.includes(t.request.method)?this.client.request(t):this.getHttpProvider().request(t.request)}setDefaultChain(t,r){this.httpProviders[t]||this.setHttpProvider(t,r),this.chainId=t,this.events.emit(Ci.DEFAULT_CHAIN_CHANGED,`${this.name}:${t}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const t=this.namespace.chains[0];if(!t)throw new Error("ChainId not found");return t.split(":")[1]}getAccounts(){const t=this.namespace.accounts;return t?[...new Set(t.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2]))]:[]}createHttpProviders(){const t={};return this.namespace.chains.forEach(r=>{var s;const a=Zi(r);t[a]=this.createHttpProvider(a,(s=this.namespace.rpcMap)==null?void 0:s[r])}),t}getHttpProvider(){const t=`${this.name}:${this.chainId}`,r=this.httpProviders[t];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${t} not found`);return r}setHttpProvider(t,r){const s=this.createHttpProvider(t,r);s&&(this.httpProviders[t]=s)}createHttpProvider(t,r){const s=r||Cn(t,this.namespace,this.client.core.projectId);if(!s)throw new Error(`No RPC url provided for chainId: ${t}`);return new Ai(new Xi(s,xt("disableProviderPing")))}}class Cx{constructor(t){this.name="cosmos",this.namespace=t.namespace,this.events=xt("events"),this.client=xt("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(t){this.namespace=Object.assign(this.namespace,t)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const t=this.namespace.chains[0];if(!t)throw new Error("ChainId not found");return t.split(":")[1]}request(t){return this.namespace.methods.includes(t.request.method)?this.client.request(t):this.getHttpProvider().request(t.request)}setDefaultChain(t,r){this.httpProviders[t]||this.setHttpProvider(t,r),this.chainId=t,this.events.emit(Ci.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){const t=this.namespace.accounts;return t?[...new Set(t.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2]))]:[]}createHttpProviders(){const t={};return this.namespace.chains.forEach(r=>{var s;const a=Zi(r);t[a]=this.createHttpProvider(a,(s=this.namespace.rpcMap)==null?void 0:s[r])}),t}getHttpProvider(){const t=`${this.name}:${this.chainId}`,r=this.httpProviders[t];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${t} not found`);return r}setHttpProvider(t,r){const s=this.createHttpProvider(t,r);s&&(this.httpProviders[t]=s)}createHttpProvider(t,r){const s=r||Cn(t,this.namespace,this.client.core.projectId);if(!s)throw new Error(`No RPC url provided for chainId: ${t}`);return new Ai(new Xi(s,xt("disableProviderPing")))}}class Rx{constructor(t){this.name="cip34",this.namespace=t.namespace,this.events=xt("events"),this.client=xt("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(t){this.namespace=Object.assign(this.namespace,t)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const t=this.namespace.chains[0];if(!t)throw new Error("ChainId not found");return t.split(":")[1]}request(t){return this.namespace.methods.includes(t.request.method)?this.client.request(t):this.getHttpProvider().request(t.request)}setDefaultChain(t,r){this.httpProviders[t]||this.setHttpProvider(t,r),this.chainId=t,this.events.emit(Ci.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){const t=this.namespace.accounts;return t?[...new Set(t.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2]))]:[]}createHttpProviders(){const t={};return this.namespace.chains.forEach(r=>{const s=this.getCardanoRPCUrl(r),a=Zi(r);t[a]=this.createHttpProvider(a,s)}),t}getHttpProvider(){const t=`${this.name}:${this.chainId}`,r=this.httpProviders[t];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${t} not found`);return r}getCardanoRPCUrl(t){const r=this.namespace.rpcMap;if(r)return r[t]}setHttpProvider(t,r){const s=this.createHttpProvider(t,r);s&&(this.httpProviders[t]=s)}createHttpProvider(t,r){const s=r||this.getCardanoRPCUrl(t);if(!s)throw new Error(`No RPC url provided for chainId: ${t}`);return new Ai(new Xi(s,xt("disableProviderPing")))}}class Nx{constructor(t){this.name="elrond",this.namespace=t.namespace,this.events=xt("events"),this.client=xt("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(t){this.namespace=Object.assign(this.namespace,t)}requestAccounts(){return this.getAccounts()}request(t){return this.namespace.methods.includes(t.request.method)?this.client.request(t):this.getHttpProvider().request(t.request)}setDefaultChain(t,r){this.httpProviders[t]||this.setHttpProvider(t,r),this.chainId=t,this.events.emit(Ci.DEFAULT_CHAIN_CHANGED,`${this.name}:${t}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const t=this.namespace.chains[0];if(!t)throw new Error("ChainId not found");return t.split(":")[1]}getAccounts(){const t=this.namespace.accounts;return t?[...new Set(t.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2]))]:[]}createHttpProviders(){const t={};return this.namespace.chains.forEach(r=>{var s;const a=Zi(r);t[a]=this.createHttpProvider(a,(s=this.namespace.rpcMap)==null?void 0:s[r])}),t}getHttpProvider(){const t=`${this.name}:${this.chainId}`,r=this.httpProviders[t];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${t} not found`);return r}setHttpProvider(t,r){const s=this.createHttpProvider(t,r);s&&(this.httpProviders[t]=s)}createHttpProvider(t,r){const s=r||Cn(t,this.namespace,this.client.core.projectId);if(!s)throw new Error(`No RPC url provided for chainId: ${t}`);return new Ai(new Xi(s,xt("disableProviderPing")))}}class $x{constructor(t){this.name="multiversx",this.namespace=t.namespace,this.events=xt("events"),this.client=xt("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(t){this.namespace=Object.assign(this.namespace,t)}requestAccounts(){return this.getAccounts()}request(t){return this.namespace.methods.includes(t.request.method)?this.client.request(t):this.getHttpProvider().request(t.request)}setDefaultChain(t,r){this.httpProviders[t]||this.setHttpProvider(t,r),this.chainId=t,this.events.emit(Ci.DEFAULT_CHAIN_CHANGED,`${this.name}:${t}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const t=this.namespace.chains[0];if(!t)throw new Error("ChainId not found");return t.split(":")[1]}getAccounts(){const t=this.namespace.accounts;return t?[...new Set(t.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2]))]:[]}createHttpProviders(){const t={};return this.namespace.chains.forEach(r=>{var s;const a=Zi(r);t[a]=this.createHttpProvider(a,(s=this.namespace.rpcMap)==null?void 0:s[r])}),t}getHttpProvider(){const t=`${this.name}:${this.chainId}`,r=this.httpProviders[t];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${t} not found`);return r}setHttpProvider(t,r){const s=this.createHttpProvider(t,r);s&&(this.httpProviders[t]=s)}createHttpProvider(t,r){const s=r||Cn(t,this.namespace,this.client.core.projectId);if(!s)throw new Error(`No RPC url provided for chainId: ${t}`);return new Ai(new Xi(s,xt("disableProviderPing")))}}var Lx=Object.defineProperty,Dx=Object.defineProperties,Fx=Object.getOwnPropertyDescriptors,Df=Object.getOwnPropertySymbols,Ux=Object.prototype.hasOwnProperty,jx=Object.prototype.propertyIsEnumerable,Ff=(n,t,r)=>t in n?Lx(n,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):n[t]=r,Oo=(n,t)=>{for(var r in t||(t={}))Ux.call(t,r)&&Ff(n,r,t[r]);if(Df)for(var r of Df(t))jx.call(t,r)&&Ff(n,r,t[r]);return n},Nc=(n,t)=>Dx(n,Fx(t));class uu{constructor(t){this.events=new Vt,this.rpcProviders={},this.shouldAbortPairingAttempt=!1,this.maxPairingAttempts=10,this.disableProviderPing=!1,this.providerOpts=t,this.logger=typeof(t==null?void 0:t.logger)<"u"&&typeof(t==null?void 0:t.logger)!="string"?t.logger:Ne.pino(Ne.getDefaultLoggerOptions({level:(t==null?void 0:t.logger)||Cf})),this.disableProviderPing=(t==null?void 0:t.disableProviderPing)||!1}static async init(t){const r=new uu(t);return await r.initialize(),r}async request(t,r){const[s,a]=this.validateChain(r);if(!this.session)throw new Error("Please call connect() before request()");return await this.getProvider(s).request({request:Oo({},t),chainId:`${s}:${a}`,topic:this.session.topic})}sendAsync(t,r,s){this.request(t,s).then(a=>r(null,a)).catch(a=>r(a,void 0))}async enable(){if(!this.client)throw new Error("Sign Client not initialized");return this.session||await this.connect({namespaces:this.namespaces,optionalNamespaces:this.optionalNamespaces,sessionProperties:this.sessionProperties}),await this.requestAccounts()}async disconnect(){var t;if(!this.session)throw new Error("Please call connect() before enable()");await this.client.disconnect({topic:(t=this.session)==null?void 0:t.topic,reason:Sf("USER_DISCONNECTED")}),await this.cleanup()}async connect(t){if(!this.client)throw new Error("Sign Client not initialized");if(this.setNamespaces(t),await this.cleanupPendingPairings(),!t.skipPairing)return await this.pair(t.pairingTopic)}on(t,r){this.events.on(t,r)}once(t,r){this.events.once(t,r)}removeListener(t,r){this.events.removeListener(t,r)}off(t,r){this.events.off(t,r)}get isWalletConnect(){return!0}async pair(t){this.shouldAbortPairingAttempt=!1;let r=0;do{if(this.shouldAbortPairingAttempt)throw new Error("Pairing aborted");if(r>=this.maxPairingAttempts)throw new Error("Max auto pairing attempts reached");const{uri:s,approval:a}=await this.client.connect({pairingTopic:t,requiredNamespaces:this.namespaces,optionalNamespaces:this.optionalNamespaces,sessionProperties:this.sessionProperties});s&&(this.uri=s,this.events.emit("display_uri",s)),await a().then(u=>{this.session=u,this.namespaces||(this.namespaces=Ox(u.namespaces),this.persist("namespaces",this.namespaces))}).catch(u=>{if(u.message!==Jd)throw u;r++})}while(!this.session);return this.onConnect(),this.session}setDefaultChain(t,r){try{if(!this.session)return;const[s,a]=this.validateChain(t);this.getProvider(s).setDefaultChain(a,r)}catch(s){if(!/Please call connect/.test(s.message))throw s}}async cleanupPendingPairings(t={}){this.logger.info("Cleaning up inactive pairings...");const r=this.client.pairing.getAll();if(xf(r)){for(const s of r)t.deletePairings?this.client.core.expirer.set(s.topic,0):await this.client.core.relayer.subscriber.unsubscribe(s.topic);this.logger.info(`Inactive pairings cleared: ${r.length}`)}}abortPairingAttempt(){this.shouldAbortPairingAttempt=!0}async checkStorage(){if(this.namespaces=await this.getFromStore("namespaces"),this.optionalNamespaces=await this.getFromStore("optionalNamespaces")||{},this.client.session.length){const t=this.client.session.keys.length-1;this.session=this.client.session.get(this.client.session.keys[t]),this.createProviders()}}async initialize(){this.logger.trace("Initialized"),await this.createClient(),await this.checkStorage(),this.registerEventListeners()}async createClient(){this.client=this.providerOpts.client||await HS.init({logger:this.providerOpts.logger||Cf,relayUrl:this.providerOpts.relayUrl||dx,projectId:this.providerOpts.projectId,metadata:this.providerOpts.metadata,storageOptions:this.providerOpts.storageOptions,storage:this.providerOpts.storage,name:this.providerOpts.name}),this.logger.trace("SignClient Initialized")}createProviders(){if(!this.client)throw new Error("Sign Client not initialized");if(!this.session)throw new Error("Session not initialized. Please call connect() before enable()");const t=[...new Set(Object.keys(this.session.namespaces).map(r=>os(r)))];Rc("client",this.client),Rc("events",this.events),Rc("disableProviderPing",this.disableProviderPing),t.forEach(r=>{if(!this.session)return;const s=Ix(r,this.session),a=Yd(s),u=Sx(this.namespaces,this.optionalNamespaces),f=Nc(Oo({},u[r]),{accounts:s,chains:a});switch(r){case"eip155":this.rpcProviders[r]=new Tx({namespace:f});break;case"solana":this.rpcProviders[r]=new Ax({namespace:f});break;case"cosmos":this.rpcProviders[r]=new Cx({namespace:f});break;case"polkadot":this.rpcProviders[r]=new Px({namespace:f});break;case"cip34":this.rpcProviders[r]=new Rx({namespace:f});break;case"elrond":this.rpcProviders[r]=new Nx({namespace:f});break;case"multiversx":this.rpcProviders[r]=new $x({namespace:f});break}})}registerEventListeners(){if(typeof this.client>"u")throw new Error("Sign Client is not initialized");this.client.on("session_ping",t=>{this.events.emit("session_ping",t)}),this.client.on("session_event",t=>{const{params:r}=t,{event:s}=r;if(s.name==="accountsChanged"){const a=s.data;a&&xf(a)&&this.events.emit("accountsChanged",a.map(xx))}else if(s.name==="chainChanged"){const a=r.chainId,u=r.event.data,f=os(a),g=Cc(a)!==Cc(u)?`${f}:${Cc(u)}`:a;this.onChainChanged(g)}else this.events.emit(s.name,s.data);this.events.emit("session_event",t)}),this.client.on("session_update",({topic:t,params:r})=>{var s;const{namespaces:a}=r,u=(s=this.client)==null?void 0:s.session.get(t);this.session=Nc(Oo({},u),{namespaces:a}),this.onSessionUpdate(),this.events.emit("session_update",{topic:t,params:r})}),this.client.on("session_delete",async t=>{await this.cleanup(),this.events.emit("session_delete",t),this.events.emit("disconnect",Nc(Oo({},Sf("USER_DISCONNECTED")),{data:t.topic}))}),this.on(Ci.DEFAULT_CHAIN_CHANGED,t=>{this.onChainChanged(t,!0)})}getProvider(t){if(!this.rpcProviders[t])throw new Error(`Provider not found: ${t}`);return this.rpcProviders[t]}onSessionUpdate(){Object.keys(this.rpcProviders).forEach(t=>{var r;this.getProvider(t).updateNamespace((r=this.session)==null?void 0:r.namespaces[t])})}setNamespaces(t){const{namespaces:r,optionalNamespaces:s,sessionProperties:a}=t;r&&Object.keys(r).length&&(this.namespaces=r),s&&Object.keys(s).length&&(this.optionalNamespaces=s),this.sessionProperties=a,this.persist("namespaces",r),this.persist("optionalNamespaces",s)}validateChain(t){const[r,s]=(t==null?void 0:t.split(":"))||["",""];if(!this.namespaces||!Object.keys(this.namespaces).length)return[r,s];if(r&&!Object.keys(this.namespaces||{}).map(f=>os(f)).includes(r))throw new Error(`Namespace '${r}' is not configured. Please call connect() first with namespace config.`);if(r&&s)return[r,s];const a=os(Object.keys(this.namespaces)[0]),u=this.rpcProviders[a].getDefaultChain();return[a,u]}async requestAccounts(){const[t]=this.validateChain();return await this.getProvider(t).requestAccounts()}onChainChanged(t,r=!1){var s;if(!this.namespaces)return;const[a,u]=this.validateChain(t);r||this.getProvider(a).setDefaultChain(u),((s=this.namespaces[a])!=null?s:this.namespaces[`${a}:${u}`]).defaultChain=u,this.persist("namespaces",this.namespaces),this.events.emit("chainChanged",u)}onConnect(){this.createProviders(),this.events.emit("connect",{session:this.session})}async cleanup(){this.session=void 0,this.namespaces=void 0,this.optionalNamespaces=void 0,this.sessionProperties=void 0,this.persist("namespaces",void 0),this.persist("optionalNamespaces",void 0),this.persist("sessionProperties",void 0),await this.cleanupPendingPairings({deletePairings:!0})}persist(t,r){this.client.core.storage.setItem(`${Rf}/${t}`,r)}async getFromStore(t){return await this.client.core.storage.getItem(`${Rf}/${t}`)}}const Mx=uu,qx="wc",zx="ethereum_provider",kx=`${qx}@2:${zx}:`,Bx="https://rpc.walletconnect.com/v1/",Bc=["eth_sendTransaction","personal_sign"],Hx=["eth_accounts","eth_requestAccounts","eth_sendRawTransaction","eth_sign","eth_signTransaction","eth_signTypedData","eth_signTypedData_v3","eth_signTypedData_v4","eth_sendTransaction","personal_sign","wallet_switchEthereumChain","wallet_addEthereumChain","wallet_getPermissions","wallet_requestPermissions","wallet_registerOnboarding","wallet_watchAsset","wallet_scanQRCode"],Hc=["chainChanged","accountsChanged"],Vx=["chainChanged","accountsChanged","message","disconnect","connect"];var Kx=Object.defineProperty,Wx=Object.defineProperties,Gx=Object.getOwnPropertyDescriptors,Uf=Object.getOwnPropertySymbols,Jx=Object.prototype.hasOwnProperty,Qx=Object.prototype.propertyIsEnumerable,jf=(n,t,r)=>t in n?Kx(n,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):n[t]=r,as=(n,t)=>{for(var r in t||(t={}))Jx.call(t,r)&&jf(n,r,t[r]);if(Uf)for(var r of Uf(t))Qx.call(t,r)&&jf(n,r,t[r]);return n},Mf=(n,t)=>Wx(n,Gx(t));function Uo(n){return Number(n[0].split(":")[1])}function $c(n){return`0x${n.toString(16)}`}function Yx(n){const{chains:t,optionalChains:r,methods:s,optionalMethods:a,events:u,optionalEvents:f,rpcMap:g}=n;if(!Lc(t))throw new Error("Invalid chains");const _={chains:t,methods:s||Bc,events:u||Hc,rpcMap:as({},t.length?{[Uo(t)]:g[Uo(t)]}:{})},T=u==null?void 0:u.filter(k=>!Hc.includes(k)),C=s==null?void 0:s.filter(k=>!Bc.includes(k));if(!r&&!f&&!a&&!(T!=null&&T.length)&&!(C!=null&&C.length))return{required:t.length?_:void 0};const F=(T==null?void 0:T.length)&&(C==null?void 0:C.length)||!r,V={chains:[...new Set(F?_.chains.concat(r||[]):r)],methods:[...new Set(_.methods.concat(a!=null&&a.length?a:Hx))],events:[...new Set(_.events.concat(f!=null&&f.length?f:Vx))],rpcMap:g};return{required:t.length?_:void 0,optional:r.length?V:void 0}}class hu{constructor(){this.events=new Vt.EventEmitter,this.namespace="eip155",this.accounts=[],this.chainId=1,this.STORAGE_KEY=kx,this.on=(t,r)=>(this.events.on(t,r),this),this.once=(t,r)=>(this.events.once(t,r),this),this.removeListener=(t,r)=>(this.events.removeListener(t,r),this),this.off=(t,r)=>(this.events.off(t,r),this),this.parseAccount=t=>this.isCompatibleChainId(t)?this.parseAccountId(t).address:t,this.signer={},this.rpc={}}static async init(t){const r=new hu;return await r.initialize(t),r}async request(t){return await this.signer.request(t,this.formatChainId(this.chainId))}sendAsync(t,r){this.signer.sendAsync(t,r,this.formatChainId(this.chainId))}get connected(){return this.signer.client?this.signer.client.core.relayer.connected:!1}get connecting(){return this.signer.client?this.signer.client.core.relayer.connecting:!1}async enable(){return this.session||await this.connect(),await this.request({method:"eth_requestAccounts"})}async connect(t){if(!this.signer.client)throw new Error("Provider not initialized. Call init() first");this.loadConnectOpts(t);const{required:r,optional:s}=Yx(this.rpc);try{const a=await new Promise(async(f,g)=>{var _;this.rpc.showQrModal&&((_=this.modal)==null||_.subscribeModal(T=>{!T.open&&!this.signer.session&&(this.signer.abortPairingAttempt(),g(new Error("Connection request reset. Please try again.")))})),await this.signer.connect(Mf(as({namespaces:as({},r&&{[this.namespace]:r})},s&&{optionalNamespaces:{[this.namespace]:s}}),{pairingTopic:t==null?void 0:t.pairingTopic})).then(T=>{f(T)}).catch(T=>{g(new Error(T.message))})});if(!a)return;const u=H1(a.namespaces,[this.namespace]);this.setChainIds(this.rpc.chains.length?this.rpc.chains:u),this.setAccounts(u),this.events.emit("connect",{chainId:$c(this.chainId)})}catch(a){throw this.signer.logger.error(a),a}finally{this.modal&&this.modal.closeModal()}}async disconnect(){this.session&&await this.signer.disconnect(),this.reset()}get isWalletConnect(){return!0}get session(){return this.signer.session}registerEventListeners(){this.signer.on("session_event",t=>{const{params:r}=t,{event:s}=r;s.name==="accountsChanged"?(this.accounts=this.parseAccounts(s.data),this.events.emit("accountsChanged",this.accounts)):s.name==="chainChanged"?this.setChainId(this.formatChainId(s.data)):this.events.emit(s.name,s.data),this.events.emit("session_event",t)}),this.signer.on("chainChanged",t=>{const r=parseInt(t);this.chainId=r,this.events.emit("chainChanged",$c(this.chainId)),this.persist()}),this.signer.on("session_update",t=>{this.events.emit("session_update",t)}),this.signer.on("session_delete",t=>{this.reset(),this.events.emit("session_delete",t),this.events.emit("disconnect",Mf(as({},K1("USER_DISCONNECTED")),{data:t.topic,name:"USER_DISCONNECTED"}))}),this.signer.on("display_uri",t=>{var r,s;this.rpc.showQrModal&&((r=this.modal)==null||r.closeModal(),(s=this.modal)==null||s.openModal({uri:t})),this.events.emit("display_uri",t)})}switchEthereumChain(t){this.request({method:"wallet_switchEthereumChain",params:[{chainId:t.toString(16)}]})}isCompatibleChainId(t){return typeof t=="string"?t.startsWith(`${this.namespace}:`):!1}formatChainId(t){return`${this.namespace}:${t}`}parseChainId(t){return Number(t.split(":")[1])}setChainIds(t){const r=t.filter(s=>this.isCompatibleChainId(s)).map(s=>this.parseChainId(s));r.length&&(this.chainId=r[0],this.events.emit("chainChanged",$c(this.chainId)),this.persist())}setChainId(t){if(this.isCompatibleChainId(t)){const r=this.parseChainId(t);this.chainId=r,this.switchEthereumChain(r)}}parseAccountId(t){const[r,s,a]=t.split(":");return{chainId:`${r}:${s}`,address:a}}setAccounts(t){this.accounts=t.filter(r=>this.parseChainId(this.parseAccountId(r).chainId)===this.chainId).map(r=>this.parseAccountId(r).address),this.events.emit("accountsChanged",this.accounts)}getRpcConfig(t){var r,s;const a=(r=t==null?void 0:t.chains)!=null?r:[],u=(s=t==null?void 0:t.optionalChains)!=null?s:[],f=a.concat(u);if(!f.length)throw new Error("No chains specified in either `chains` or `optionalChains`");const g=a.length?(t==null?void 0:t.methods)||Bc:[],_=a.length?(t==null?void 0:t.events)||Hc:[],T=(t==null?void 0:t.optionalMethods)||[],C=(t==null?void 0:t.optionalEvents)||[],F=(t==null?void 0:t.rpcMap)||this.buildRpcMap(f,t.projectId),V=(t==null?void 0:t.qrModalOptions)||void 0;return{chains:a==null?void 0:a.map(k=>this.formatChainId(k)),optionalChains:u.map(k=>this.formatChainId(k)),methods:g,events:_,optionalMethods:T,optionalEvents:C,rpcMap:F,showQrModal:!!(t!=null&&t.showQrModal),qrModalOptions:V,projectId:t.projectId,metadata:t.metadata}}buildRpcMap(t,r){const s={};return t.forEach(a=>{s[a]=this.getRpcUrl(a,r)}),s}async initialize(t){if(this.rpc=this.getRpcConfig(t),this.chainId=this.rpc.chains.length?Uo(this.rpc.chains):Uo(this.rpc.optionalChains),this.signer=await Mx.init({projectId:this.rpc.projectId,metadata:this.rpc.metadata,disableProviderPing:t.disableProviderPing,relayUrl:t.relayUrl,storageOptions:t.storageOptions}),this.registerEventListeners(),await this.loadPersistedSession(),this.rpc.showQrModal){let r;try{const{WalletConnectModal:s}=await V1(()=>import("./index-e5b27063.js").then(a=>a.i),["assets/index-e5b27063.js","assets/index-cf062a2d.js","assets/index-47c9afec.css"]);r=s}catch{throw new Error("To use QR modal, please install @walletconnect/modal package")}if(r)try{this.modal=new r(as({walletConnectVersion:2,projectId:this.rpc.projectId,standaloneChains:this.rpc.chains},this.rpc.qrModalOptions))}catch(s){throw this.signer.logger.error(s),new Error("Could not generate WalletConnectModal Instance")}}}loadConnectOpts(t){if(!t)return;const{chains:r,optionalChains:s,rpcMap:a}=t;r&&Lc(r)&&(this.rpc.chains=r.map(u=>this.formatChainId(u)),r.forEach(u=>{this.rpc.rpcMap[u]=(a==null?void 0:a[u])||this.getRpcUrl(u)})),s&&Lc(s)&&(this.rpc.optionalChains=[],this.rpc.optionalChains=s==null?void 0:s.map(u=>this.formatChainId(u)),s.forEach(u=>{this.rpc.rpcMap[u]=(a==null?void 0:a[u])||this.getRpcUrl(u)}))}getRpcUrl(t,r){var s;return((s=this.rpc.rpcMap)==null?void 0:s[t])||`${Bx}?chainId=eip155:${t}&projectId=${r||this.rpc.projectId}`}async loadPersistedSession(){if(!this.session)return;const t=await this.signer.client.core.storage.getItem(`${this.STORAGE_KEY}/chainId`),r=this.session.namespaces[`${this.namespace}:${t}`]?this.session.namespaces[`${this.namespace}:${t}`]:this.session.namespaces[this.namespace];this.setChainIds(t?[this.formatChainId(t)]:r==null?void 0:r.accounts),this.setAccounts(r==null?void 0:r.accounts)}reset(){this.chainId=1,this.accounts=[]}persist(){this.session&&this.signer.client.core.storage.setItem(`${this.STORAGE_KEY}/chainId`,this.chainId)}parseAccounts(t){return typeof t=="string"||t instanceof String?[this.parseAccount(t)]:t.map(r=>this.parseAccount(r))}}const hO=hu;export{hO as EthereumProvider,Vx as OPTIONAL_EVENTS,Hx as OPTIONAL_METHODS,Hc as REQUIRED_EVENTS,Bc as REQUIRED_METHODS,hu as default};
